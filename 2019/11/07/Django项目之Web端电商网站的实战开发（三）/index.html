<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  
  <title>Django项目之Web端电商网站的实战开发（三） | TG&#39;S BLOG</title>
  
  
  <meta name="description" content="该篇文章是博主一字一码编写的，实属不易，请尊重原创，谢谢大家！">
  

  

  <meta name="HandheldFriendly" content="True">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <!-- meta -->
  

  <!-- link -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css">
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.css">
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.10.1/css/all.min.css">
  

  
  <link rel="shortcut icon" type="image/x-icon" href="https://cdn.jsdelivr.net/gh/Hellotaogang/cdn@4.3/images/favicon.ico">
  

  
    <link rel="stylesheet" href="/style.css">
  

  <script>
    function setLoadingBarProgress(num) {
      document.getElementById('loading-bar').style.width=num+"%";
    }
  </script>

  
  
</head>

<body>
  
  
  <div class="cover-wrapper">
    <cover class='cover post half'>
      
        
  <img class='logo' src='https://cdn.jsdelivr.net/gh/Hellotaogang/cdn@4.5.6/images/logo_2.png'/>


  <div class="m_search">
    <form name="searchform" class="form u-search-form">
      <input type="text" class="input u-search-input" placeholder="" />
      <i class="icon fas fa-search fa-fw"></i>
    </form>
  </div>

<div class='menu navgation'>
  <ul class='h-list'>
    
      
        <li>
          <a class="nav home" href="/"
            
            
            id="home">
            <i class='fas fa-home fa-fw'></i>&nbsp;主页
          </a>
        </li>
      
        <li>
          <a class="nav home" href="/categories/"
            
            
            id="categories">
            <i class='fas fa-folder-open fa-fw'></i>&nbsp;分类
          </a>
        </li>
      
        <li>
          <a class="nav home" href="/tags/"
            
              rel="nofollow"
            
            
            id="tags">
            <i class='fas fa-tags fa-fw'></i>&nbsp;标签
          </a>
        </li>
      
        <li>
          <a class="nav home" href="/love/"
            
              rel="nofollow"
            
            
            id="love">
            <i class='fas fa-heart fa-fw'></i>&nbsp;记录
          </a>
        </li>
      
        <li>
          <a class="nav home" href="/about/"
            
              rel="nofollow"
            
            
            id="about">
            <i class='fas fa-info-circle fa-fw'></i>&nbsp;关于
          </a>
        </li>
      
    
  </ul>
</div>

      
    </cover>
    <header class="l_header pure">
  <div id="loading-bar-wrapper">
    <div id="loading-bar" class="pure"></div>
  </div>

	<div class='wrapper'>
		<div class="nav-main container container--flex">
      <a class="logo flat-box" href='/' >
        
          TG'S BLOG
        
      </a>
			<div class='menu navgation'>
				<ul class='h-list'>
          
  					
  						<li>
								<a class="nav flat-box" href="/"
                  
                  
                  id="home">
									<i class='fas fa-home fa-fw'></i>&nbsp;主页
								</a>
							</li>
      			
  						<li>
								<a class="nav flat-box" href="/categories/"
                  
                    rel="nofollow"
                  
                  
                  id="categories">
									<i class='fas fa-folder-open fa-fw'></i>&nbsp;分类
								</a>
							</li>
      			
  						<li>
								<a class="nav flat-box" href="/tags/"
                  
                    rel="nofollow"
                  
                  
                  id="tags">
									<i class='fas fa-tags fa-fw'></i>&nbsp;标签
								</a>
							</li>
      			
  						<li>
								<a class="nav flat-box" href="/archives/"
                  
                    rel="nofollow"
                  
                  
                  id="archives">
									<i class='fas fa-archive fa-fw'></i>&nbsp;归档
								</a>
							</li>
      			
  						<li>
								<a class="nav flat-box" href="/love/"
                  
                    rel="nofollow"
                  
                  
                  id="love">
									<i class='fas fa-heart fa-fw'></i>&nbsp;记录
								</a>
							</li>
      			
  						<li>
								<a class="nav flat-box" href="/about/"
                  
                    rel="nofollow"
                  
                  
                  id="about">
									<i class='fas fa-info-circle fa-fw'></i>&nbsp;关于
								</a>
							</li>
      			
      		
				</ul>
			</div>

			
				<div class="m_search">
					<form name="searchform" class="form u-search-form">
						<input type="text" class="input u-search-input" placeholder="搜索" />
						<i class="icon fas fa-search fa-fw"></i>
					</form>
				</div>
			
			<ul class='switcher h-list'>
				
					<li class='s-search'><a class="fas fa-search fa-fw" href='javascript:void(0)'></a></li>
				
				<li class='s-menu'><a class="fas fa-bars fa-fw" href='javascript:void(0)'></a></li>
			</ul>
		</div>

		<div class='nav-sub container container--flex'>
			<a class="logo flat-box"></a>
			<ul class='switcher h-list'>
				<li class='s-comment'><a class="flat-btn fas fa-comments fa-fw" href='javascript:void(0)'></a></li>
        
          <li class='s-toc'><a class="flat-btn fas fa-list fa-fw" href='javascript:void(0)'></a></li>
        
			</ul>
		</div>
	</div>
</header>
	<aside class="menu-phone">
    <header>
		<nav class="menu navgation">
      <ul>
        
          
            <li>
							<a class="nav flat-box" href="/"
                
                
                id="home">
								<i class='fas fa-clock fa-fw'></i>&nbsp;近期文章
							</a>
            </li>
          
            <li>
							<a class="nav flat-box" href="/blog/archives/"
                
                  rel="nofollow"
                
                
                id="blogarchives">
								<i class='fas fa-archive fa-fw'></i>&nbsp;文章归档
							</a>
            </li>
          
            <li>
							<a class="nav flat-box" href="/projects/"
                
                
                id="projects">
								<i class='fas fa-code-branch fa-fw'></i>&nbsp;开源项目
							</a>
            </li>
          
            <li>
							<a class="nav flat-box" href="/friends/"
                
                  rel="nofollow"
                
                
                id="friends">
								<i class='fas fa-link fa-fw'></i>&nbsp;我的友链
							</a>
            </li>
          
            <li>
							<a class="nav flat-box" href="https://xaoxuu.com/wiki/material-x/"
                
                  rel="nofollow"
                
                
                id="https:xaoxuu.comwikimaterial-x">
								<i class='fas fa-book fa-fw'></i>&nbsp;主题文档
							</a>
            </li>
          
            <li>
							<a class="nav flat-box" href="/about/"
                
                  rel="nofollow"
                
                
                id="about">
								<i class='fas fa-info-circle fa-fw'></i>&nbsp;关于小站
							</a>
            </li>
          
       
      </ul>
		</nav>
    </header>
	</aside>
<script>setLoadingBarProgress(40);</script>

  </div>


  <div class="l_body">
    <div class='body-wrapper'>
      <div class='l_main'>
  

  <article id="post" class="post white-box article-type-post" itemscope itemprop="blogPost">
    


  <section class='meta'>
    
    
      <a title='Django项目之Web端电商网站的实战开发（三）' href='/2019/11/07/Django项目之Web端电商网站的实战开发（三）/'><img class='thumbnail' src='https://cdn.jsdelivr.net/gh/Hellotaogang/cdn@4.6.2/images/django.png'></a>
    
    <div class="meta" id="header-meta">
      
        
  
    <h1 class="title">
      <a href="/2019/11/07/Django项目之Web端电商网站的实战开发（三）/">
        Django项目之Web端电商网站的实战开发（三）
      </a>
    </h1>
  


      
      <div class='new-meta-box'>
        
          
        
          
            
  <div class='new-meta-item author'>
    
      <a href="/" rel="nofollow">
        
          <img src="https://cdn.jsdelivr.net/gh/Hellotaogang/cdn@4.4.3/images/avatar_4.png">
        
        <p>cdtaogang</p>
      </a>
    
  </div>


          
        
          
            <div class="new-meta-item date">
  <a class='notlink'>
    <i class="fas fa-calendar-alt" aria-hidden="true"></i>
    <p>2019-11-07</p>
  </a>
</div>

          
        
          
            
  
  <div class='new-meta-item category'>
    <a href='/categories/Django开发/' rel="nofollow">
      <i class="fas fa-folder-open" aria-hidden="true"></i>
      <p>Django开发</p>
    </a>
  </div>


          
        
          
            
  
    <div class="new-meta-item browse busuanzi">
      <a class='notlink'>
        <i class="fas fa-eye" aria-hidden="true"></i>
        <p>
          <span id="busuanzi_value_page_pv">
            <i class="fas fa-spinner fa-spin fa-fw" aria-hidden="true"></i>
          </span>
        </p>
      </a>
    </div>
  


          
        
          
            

          
        
      </div>
      
        <hr>
      
    </div>
  </section>


    <section class="article typo">
      <div class="article-entry" itemprop="articleBody">
        <p>该篇文章是博主一字一码编写的，实属不易，请尊重原创，谢谢大家！<br><font style="color:red">温馨提示：需要项目源码的朋友，请添加博主微信进行获取！</font></p>
<div style="color:#fb651b"><i class="fas fa-list fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;本文目录</div>
<li class="toc-item toc-level-1"><a style=" text-decoration:none;" href="#一丶模板文件继承"><span style="color:#4ea1db">一丶模板文件继承</span></a></li>
<li class="toc-item toc-level-1"><a style=" text-decoration:none;" href="#二丶用户中心页面显示"><span style="color:#4ea1db">二丶用户中心页面显示</span></a></li>
<li class="toc-item toc-level-1"><a style=" text-decoration:none;" href="#三丶登录验证以及登录后跳转的地址"><span style="color:#4ea1db">三丶登录验证以及登录后跳转的地址</span></a></li>
<li class="toc-item toc-level-1"><a style=" text-decoration:none;" href="#四丶封装login_required方法"><span style="color:#4ea1db">四丶封装login_required方法</span></a></li>
<li class="toc-item toc-level-1"><a style=" text-decoration:none;" href="#五丶登录后显示用户名以及退出登录"><span style="color:#4ea1db">五丶登录后显示用户名以及退出登录</span></a></li>
<li class="toc-item toc-level-1"><a style=" text-decoration:none;" href="#六丶用户中心-地址"><span style="color:#4ea1db">六丶用户中心-地址</span></a></li>
<li class="toc-item toc-level-1"><a style=" text-decoration:none;" href="#七丶用户中心-信息"><span style="color:#4ea1db">七丶用户中心-信息</span></a></li>
<li class="toc-item toc-level-1"><a style=" text-decoration:none;" href="#八丶分布式文件系统FastDFS"><span style="color:#4ea1db">八丶分布式文件系统FastDFS</span></a></li>
<li class="toc-item toc-level-1"><a style=" text-decoration:none;" href="#九丶Nginx配置FastDFS使用的安装和配置"><span style="color:#4ea1db">九丶Nginx配置FastDFS使用的安装和配置</span></a></li>
<li class="toc-item toc-level-1"><a style=" text-decoration:none;" href="#十丶Python与FastDFS进行交互"><span style="color:#4ea1db">十丶Python与FastDFS进行交互</span></a></li>
<a id="more"></a>

<h1 id="一丶模板文件继承"><a href="#一丶模板文件继承" class="headerlink" title="一丶模板文件继承"></a>一丶模板文件继承</h1><p>1.分析网页中共有的模块，定义父模板</p>
<ul>
<li><strong>step1</strong> 在templates目录下常见base.html文件，用于主页（index.html），登录页（login.html）以及注册页（register.html）模板的继承</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line">&#123;# 首页 注册 登录 #&#125;</span><br><span class="line"><span class="meta">&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">xmlns</span>=<span class="string">"http://www.w3.org/1999/xhtml"</span> <span class="attr">xml:lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line">&#123;% load staticfiles %&#125;</span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Type"</span> <span class="attr">content</span>=<span class="string">"text/html;charset=UTF-8"</span>&gt;</span></span><br><span class="line">    &#123;# 网页标题内容块 #&#125;</span><br><span class="line">	<span class="tag">&lt;<span class="name">title</span>&gt;</span>&#123;% block title %&#125;&#123;% endblock title %&#125;<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">type</span>=<span class="string">"text/css"</span> <span class="attr">href</span>=<span class="string">"&#123;% static 'css/reset.css' %&#125;"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">type</span>=<span class="string">"text/css"</span> <span class="attr">href</span>=<span class="string">"&#123;% static 'css/main.css' %&#125;"</span>&gt;</span></span><br><span class="line">	&#123;# 网页顶部引入文件块 #&#125;</span><br><span class="line">    &#123;% block topfiles %&#125;&#123;% endblock topfiles %&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">&#123;# 网页顶部欢迎信息块 #&#125;</span><br><span class="line">&#123;% block header_con %&#125;</span><br><span class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"header_con"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"header"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"welcome fl"</span>&gt;</span>欢迎来到天天生鲜!<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"fr"</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"login_info fl"</span>&gt;</span></span><br><span class="line">					欢迎您：<span class="tag">&lt;<span class="name">em</span>&gt;</span>张 山<span class="tag">&lt;/<span class="name">em</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"login_btn fl"</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"login.html"</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">span</span>&gt;</span>|<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"register.html"</span>&gt;</span>注册<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"user_link fl"</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">span</span>&gt;</span>|<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"../static/user_center_info.html"</span>&gt;</span>用户中心<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">span</span>&gt;</span>|<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"../static/cart.html"</span>&gt;</span>我的购物车<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">span</span>&gt;</span>|<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"../static/user_center_order.html"</span>&gt;</span>我的订单<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">&#123;% endblock header_con %&#125;</span><br><span class="line"> </span><br><span class="line">&#123;# 网页顶部搜索框块 #&#125;</span><br><span class="line">&#123;% block search_bar %&#125;</span><br><span class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"search_bar clearfix"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"index.html"</span> <span class="attr">class</span>=<span class="string">"logo fl"</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"&#123;% static 'images/logo.png' %&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"search_con fl"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"input_text fl"</span> <span class="attr">name</span>=<span class="string">""</span> <span class="attr">placeholder</span>=<span class="string">"搜索商品"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"input_btn fr"</span> <span class="attr">name</span>=<span class="string">""</span> <span class="attr">value</span>=<span class="string">"搜索"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"guest_cart fr"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span> <span class="attr">class</span>=<span class="string">"cart_name fl"</span>&gt;</span>我的购物车<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"goods_count fl"</span> <span class="attr">id</span>=<span class="string">"show_count"</span>&gt;</span>1<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">&#123;% endblock search_bar %&#125;</span><br><span class="line"> </span><br><span class="line">&#123;# 网站主体内容块 #&#125;</span><br><span class="line">&#123;% block body %&#125;&#123;% endblock body %&#125;</span><br><span class="line"> </span><br><span class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"footer"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"foot_link"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>关于我们<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">span</span>&gt;</span>|<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>联系我们<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">span</span>&gt;</span>|<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>招聘人才<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">span</span>&gt;</span>|<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>友情链接<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">p</span>&gt;</span>CopyRight © 2016 北京天天生鲜信息技术有限公司 All Rights Reserved<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">p</span>&gt;</span>电话：010-****888    京ICP备*******8号<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    &#123;# 网页底部html元素块 #&#125;</span><br><span class="line">    &#123;% block bottom %&#125;&#123;% endblock bottom %&#125;</span><br><span class="line">    &#123;# 网页底部引入文件块 #&#125;</span><br><span class="line">	&#123;% block bottomfiles %&#125;&#123;% endblock bottomfiles %&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><strong>step2</strong> 在templates目录下常见base_detail_list.html文件，这个模板文件继承需base.html，用于详情页（detail.html），列表页（list.html）模板的继承</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">&#123;# 详情页 列表页 #&#125;</span><br><span class="line">&#123;% extends 'base.html' %&#125;</span><br><span class="line">&#123;# 网站主体内容块 #&#125;</span><br><span class="line">&#123;% block body %&#125;</span><br><span class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"navbar_con"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"navbar clearfix"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"subnav_con fl"</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">h1</span>&gt;</span>全部商品分类<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"subnav"</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span> <span class="attr">class</span>=<span class="string">"fruit"</span>&gt;</span>新鲜水果<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span> <span class="attr">class</span>=<span class="string">"seafood"</span>&gt;</span>海鲜水产<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span> <span class="attr">class</span>=<span class="string">"meet"</span>&gt;</span>猪牛羊肉<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span> <span class="attr">class</span>=<span class="string">"egg"</span>&gt;</span>禽类蛋品<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span> <span class="attr">class</span>=<span class="string">"vegetables"</span>&gt;</span>新鲜蔬菜<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span> <span class="attr">class</span>=<span class="string">"ice"</span>&gt;</span>速冻食品<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"navlist fl"</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span>首页<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"interval"</span>&gt;</span>|<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span>手机生鲜<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"interval"</span>&gt;</span>|<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span>抽奖<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    &#123;# 详情页，列表页主体内容块 #&#125;</span><br><span class="line">    &#123;% block main_content %&#125;&#123;% endblock main_content %&#125;</span><br><span class="line">&#123;% endblock body %&#125;</span><br><span class="line">step3 在templates目录下常见base_no_cart.html文件，这个模板文件继承需base.html，用于购物车页（cart.html），提交订单页（place_order.html）模板的继承</span><br><span class="line">&#123;# 购物车 提交订单 #&#125;</span><br><span class="line">&#123;% extends 'base.html' %&#125;</span><br><span class="line">&#123;% load staticfiles %&#125;</span><br><span class="line">&#123;# 网页顶部搜索框块 #&#125;</span><br><span class="line">&#123;% block search_bar %&#125;</span><br><span class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"search_bar clearfix"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"index.html"</span> <span class="attr">class</span>=<span class="string">"logo fl"</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"&#123;% static 'images/logo.png' %&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"sub_page_name fl"</span>&gt;</span>|&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&#123;% block page_title %&#125;&#123;% endblock page_title %&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"search_con fr"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"input_text fl"</span> <span class="attr">name</span>=<span class="string">""</span> <span class="attr">placeholder</span>=<span class="string">"搜索商品"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"input_btn fr"</span> <span class="attr">name</span>=<span class="string">""</span> <span class="attr">value</span>=<span class="string">"搜索"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">&#123;% endblock search_bar %&#125;</span><br><span class="line">step4 在templates目录下常见base_user_center.html文件，这个模板文件继承需base_no_cart.html，用于用户中心三个页面（user_center_info.html）（user_center_order.html）（user_center_site.html）模板的继承</span><br><span class="line">&#123;# 用户中心3页面 #&#125;</span><br><span class="line">&#123;% extends 'base_no_cart.html' %&#125;</span><br><span class="line">&#123;% block title %&#125;天天生鲜-用户中心&#123;% endblock title %&#125;</span><br><span class="line">&#123;% block page_title %&#125;用户中心&#123;% endblock page_title %&#125;</span><br><span class="line">&#123;% block body %&#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"main_con clearfix"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"left_menu_con clearfix"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">h3</span>&gt;</span>用户中心<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"user_center_info.html"</span> <span class="attr">class</span>=<span class="string">"active"</span>&gt;</span>· 个人信息<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"user_center_order.html"</span>&gt;</span>· 全部订单<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"user_center_site.html"</span>&gt;</span>· 收货地址<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        &#123;# 用户中心右侧内容块 #&#125;</span><br><span class="line">        &#123;% block right_content %&#125;&#123;% endblock right_content %&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">&#123;% endblock body %&#125;</span><br></pre></td></tr></table></figure>

<p>2.注册页登录页主页继承于父模板</p>
<ul>
<li><strong>step1</strong> 编写注册页面（register.html）继承于base.html</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190327144408578.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li><strong>step2</strong> 编写登录页面（login.html）继承于base.html</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190327145129952.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li><strong>step3</strong> 编写主页（index.html）继承于bases.html</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190327150736139.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li><strong>step4</strong> 测试页面显示是否正确</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190327151451155.gif" alt></fancybox></p>
<p>3.用户中心三个页面继承于父模板</p>
<ul>
<li><strong>step1</strong> 编写（user_center_info.html）继承于base_user_center.html</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190327152817401.png" alt></fancybox></p>
<ul>
<li><strong>step2</strong>  编写（user_center_order.html）继承于base_user_center.html</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190327152906538.png" alt></fancybox></p>
<ul>
<li><strong>step3</strong>  编写（user_center_site.html）继承于base_user_center.html</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190327152952318.png" alt></fancybox></p>
<p>4.购物车页提交订单页继承于父模板</p>
<ul>
<li><strong>step1</strong> 编写购物车页（cart.html）继承于base_no_cart.html</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190327160540915.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li><strong>step2</strong> 编写提交订单页（place_order.html） 继承于base_no_cart.html</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190327160656330.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<p>5.商品详情页商品列表页继承于父模板</p>
<ul>
<li><strong>step1</strong>  编写详情页（detail.html）继承于base_detail_list.html</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190327162042783.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li><strong>step2</strong>  编写列表页（list.html）继承于base_detail_list.html</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190327163338894.png" alt></fancybox></p>
<h1 id="二丶用户中心页面显示"><a href="#二丶用户中心页面显示" class="headerlink" title="二丶用户中心页面显示"></a>二丶用户中心页面显示</h1><p>1.定义类视图</p>
<ul>
<li><strong>step1</strong> 定义UserInfoView类并定义get方法，用于显示用户信息页面</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># /user</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserInfoView</span><span class="params">(View)</span>:</span></span><br><span class="line">    <span class="string">"""用户中心-信息"""</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self, request)</span>:</span></span><br><span class="line">        <span class="string">"""显示页面"""</span></span><br><span class="line">        <span class="keyword">return</span> render(request, <span class="string">"user_center_info.html"</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>step2</strong> 定义UserOrderView类并定义get方法，用于显示用户订单页面</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserOrderView</span><span class="params">(View)</span>:</span></span><br><span class="line">    <span class="string">"""用户中心-订单"""</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self, request)</span>:</span></span><br><span class="line">        <span class="string">"""显示页面"""</span></span><br><span class="line">        <span class="keyword">return</span> render(request, <span class="string">"user_center_order.html"</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>step3</strong> 定义UserAddressView类并定义get方法，用于显示用户地址页面</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># /user/address</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserAddressView</span><span class="params">(View)</span>:</span></span><br><span class="line">    <span class="string">"""用户中心-地址"""</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self, request)</span>:</span></span><br><span class="line">        <span class="string">"""显示页面"""</span></span><br><span class="line">        <span class="keyword">return</span> render(request, <span class="string">"user_center_site.html"</span>)</span><br></pre></td></tr></table></figure>

<p>2.在df_user/urls中配置路由</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">url(<span class="string">r"^$"</span>, UserInfoView.as_view(), name=<span class="string">"user"</span>),  <span class="comment"># 用户中心-信息</span></span><br><span class="line">url(<span class="string">r"^order$"</span>, UserOrderView.as_view(), name=<span class="string">"order"</span>),  <span class="comment"># 用户中心-订单</span></span><br><span class="line">url(<span class="string">r"^address$"</span>, UserAddressView.as_view(), name=<span class="string">"address"</span>), <span class="comment"># 用户中心-地址</span></span><br></pre></td></tr></table></figure>

<p>3.输入路由地址进行页面显示</p>
<ul>
<li><strong>step1</strong> 用户信息页面</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190327235557523.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li><strong>step2</strong> 用户订单页面</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190327235506355.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li><strong>step3</strong> 用户地址页面</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190327235406836.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<p>4.修改用户中心链接地址以及激活active选择器</p>
<ul>
<li><strong>step1</strong> 在用户中心页面点击个人信息，全部订单以及收货地址时，跳转到正确链接地址</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/20190328000051427.png" alt></p>
<ul>
<li><strong>step2</strong> 在base_user_center.html父模板中使用反向解析定义链接地址</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&#123;% url 'user:user' %&#125;"</span> <span class="attr">class</span>=<span class="string">"active"</span>&gt;</span>· 个人信息<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&#123;% url 'user:order' %&#125;"</span>&gt;</span>· 全部订单<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&#123;% url 'user:address' %&#125;"</span>&gt;</span>· 收货地址<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><strong>step3</strong> 在用户中心三个类视图中在返回模板文件时，传递三个页面不同的参数，根据参数来判断active激活哪个页面</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> render(request, <span class="string">"user_center_info.html"</span>, &#123;<span class="string">"page"</span>:<span class="string">"user"</span>&#125;)</span><br><span class="line"><span class="keyword">return</span> render(request, <span class="string">"user_center_info.html"</span>, &#123;<span class="string">"page"</span>:<span class="string">"order"</span>&#125;)</span><br><span class="line"><span class="keyword">return</span> render(request, <span class="string">"user_center_info.html"</span>, &#123;<span class="string">"page"</span>:<span class="string">"address"</span>&#125;)</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>step4</strong> 紧接着在base_user_center.html父模板对后端返回的数据进行判断处理</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&#123;% url 'user:user' %&#125;"</span> &#123;% <span class="attr">if</span> <span class="attr">page</span> == <span class="string">'user'</span> %&#125;<span class="attr">class</span>=<span class="string">"active"</span>&#123;% <span class="attr">endif</span> %&#125;&gt;</span>· 个人信息<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&#123;% url 'user:order' %&#125;"</span>&#123;% <span class="attr">if</span> <span class="attr">page</span> == <span class="string">'order'</span> %&#125;<span class="attr">class</span>=<span class="string">"active"</span>&#123;% <span class="attr">endif</span> %&#125;&gt;</span>· 全部订单<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&#123;% url 'user:address' %&#125;"</span>&#123;% <span class="attr">if</span> <span class="attr">page</span> == <span class="string">'address'</span> %&#125;<span class="attr">class</span>=<span class="string">"active"</span>&#123;% <span class="attr">endif</span> %&#125;&gt;</span>· 收货地址<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><strong>step5</strong> 测试效果</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190328002227753.gif" alt></fancybox></p>
<h1 id="三丶登录验证以及登录后跳转的地址"><a href="#三丶登录验证以及登录后跳转的地址" class="headerlink" title="三丶登录验证以及登录后跳转的地址"></a>三丶登录验证以及登录后跳转的地址</h1><p>1.登录验证</p>
<ul>
<li><strong>step1</strong> 导入django模块中的login_required方法，验证用户是否是登录状态，也就是获取session的值，如果用户是登录状态，那么则可以访问需要登录成功后所访问的页面，如果用户未登录，直接访问需要登录后才能看到的页面，则login_required方法默认跳转到<a href="http://127.0.0.1:8000/accounts/login/?next=/user/页面" target="_blank" rel="noopener">http://127.0.0.1:8000/accounts/login/?next=/user/页面</a></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.contrib.auth.decorators <span class="keyword">import</span> login_required</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>step2</strong> 在df_user/urls中对用户中心信息页添加login_required登录验证方法</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url(<span class="string">r"^$"</span>, login_required(UserInfoView.as_view()), name=<span class="string">"user"</span>),  <span class="comment"># 用户中心-信息</span></span><br></pre></td></tr></table></figure>

<ul>
<li><strong>step3</strong> 未登录状态直接访问<a href="http://127.0.0.1:8000/user/" target="_blank" rel="noopener">http://127.0.0.1:8000/user/</a>（用户中心信息页面）<br>说明：这里之所以换了个浏览器是因为之前的谷歌浏览器有登录成功保存的session，博主不想清除浏览缓存</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190328101949557.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li><strong>step4</strong> 在官网文档中调用login_required方法，设置验证不成功跳转的地址，则需要在项目settings配置文件中配置LOGIN_URL，设置为登录地址</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190328103417858.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<p>2.登录成功后跳转的地址</p>
<ul>
<li><strong>step1</strong> 根据login_required方法验证未登录状态跳转的登录地址<a href="http://127.0.0.1:8000/user/login?next=/user/" target="_blank" rel="noopener">http://127.0.0.1:8000/user/login?next=/user/</a>，在LoginView类视图post方法中，获取请求地址next参数的值，如果当用户访问的是<a href="http://127.0.0.1:8000/user/login" target="_blank" rel="noopener">http://127.0.0.1:8000/user/login</a>登录页面，则next请求地址参数中的next参数无法获取，所以设置默认值为反向解析主页地址</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">next_url = request.GET.get(<span class="string">"next"</span>, reverse(<span class="string">"goods:index"</span>))</span><br><span class="line">response = redirect(next_url)</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>step2</strong> 验证当用户在未登录状态访问需要登录后才能访问的页面，跳转到<a href="http://127.0.0.1:8000/user/login?next=/user/" target="_blank" rel="noopener">http://127.0.0.1:8000/user/login?next=/user/</a>，进入登录页面，登录成功后是否跳转到未登录时访问的页面<a href="http://127.0.0.1:8000/user/" target="_blank" rel="noopener">http://127.0.0.1:8000/user/</a></li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190328115920523.gif" alt></fancybox></p>
<ul>
<li><strong>step3</strong> 验证当用户直接访问登录页面是否进入主页<a href="http://127.0.0.1:8000" target="_blank" rel="noopener">http://127.0.0.1:8000</a></li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190328115953204.gif" alt></fancybox></p>
<ul>
<li><strong>step4</strong> 同理将用户中心-订单（<a href="http://127.0.0.1:8000/user/order" target="_blank" rel="noopener">http://127.0.0.1:8000/user/order</a>）和用户中心地址（<a href="http://127.0.0.1:8000/user/address" target="_blank" rel="noopener">http://127.0.0.1:8000/user/address</a>）加上login_required方法，同样情况在未登录状态跳转的登录地址<a href="http://127.0.0.1:8000/user/login?next=/user/order" target="_blank" rel="noopener">http://127.0.0.1:8000/user/login?next=/user/order</a>和<a href="http://127.0.0.1:8000/user/login?next=/user/address" target="_blank" rel="noopener">http://127.0.0.1:8000/user/login?next=/user/address</a></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">url(<span class="string">r"^order$"</span>, login_required(UserOrderView.as_view()), name=<span class="string">"order"</span>),  <span class="comment"># 用户中心-订单</span></span><br><span class="line">url(<span class="string">r"^address$"</span>, login_required(UserAddressView.as_view()), name=<span class="string">"address"</span>), <span class="comment"># 用户中心-地址</span></span><br></pre></td></tr></table></figure>

<h1 id="四丶封装login-required方法"><a href="#四丶封装login-required方法" class="headerlink" title="四丶封装login_required方法"></a>四丶封装login_required方法</h1><p>1.定义工具类</p>
<ul>
<li><strong>step1</strong> 在项目目录下创建utils包，在utils包下创建mixin.py文件</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/20190328130430581.png" alt></p>
<ul>
<li><strong>step2</strong> 在mixin.py文件中创建LoginRequiredMixin类，封装login_required方法</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.contrib.auth.decorators <span class="keyword">import</span> login_required  <span class="comment"># 验证是否登录</span></span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LoginRequiredMixin</span><span class="params">(object)</span>:</span></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">as_view</span><span class="params">(cls, **initkwargs)</span>:</span></span><br><span class="line">        view = super(LoginRequiredMixin, cls).as_view(**initkwargs)</span><br><span class="line">        <span class="keyword">return</span> login_required(view)</span><br></pre></td></tr></table></figure>

<p>2.在用户中心类视图中继承LoginRequiredMixin类并在urls中去掉login_required方法</p>
<ul>
<li><strong>step1</strong> 继承LoginRequiredMixin类</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/20190328131225946.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></p>
<ul>
<li><strong>step2</strong> 去掉login_required方法</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">url(<span class="string">r"^$"</span>, UserInfoView.as_view(), name=<span class="string">"user"</span>),  <span class="comment"># 用户中心-信息</span></span><br><span class="line">url(<span class="string">r"^order$"</span>, UserOrderView.as_view(), name=<span class="string">"order"</span>),  <span class="comment"># 用户中心-订单</span></span><br><span class="line">url(<span class="string">r"^address$"</span>, UserAddressView.as_view(), name=<span class="string">"address"</span>),  <span class="comment"># 用户中心-地址</span></span><br></pre></td></tr></table></figure>

<ul>
<li><strong>step3</strong> 验证成功</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/20190328134110705.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></p>
<h1 id="五丶登录后显示用户名以及退出登录"><a href="#五丶登录后显示用户名以及退出登录" class="headerlink" title="五丶登录后显示用户名以及退出登录"></a>五丶登录后显示用户名以及退出登录</h1><p>1.登录后显示用户名不显示登录注册功能选项</p>
<ul>
<li><strong>step1</strong> <font style="color:red">Django框架默认会给前端模板文件传递request.user对象，如果用户是登录状态访问页面会返回User类的对象user，如果未登录则返回AnonymousUser实力对象，当给前端模板文件返回的是user对象（已登录）则这个实力对象去调is_authenticated方法则会返回True，（未登录）AnonymousUser实力对象去调用is_authenticated方法则会返回False</font>，在base.html模板文件中根据user对象进行判断，如果没有使用重复模板的继承复用，则需要在有class=‘header_con’模块的模板文件中一一进行判断，在此体现出重复内容模板继承的重要性</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;% if user.is_authenticated %&#125;</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"login_btn fl"</span>&gt;</span></span><br><span class="line">	欢迎您：<span class="tag">&lt;<span class="name">em</span> <span class="attr">style</span>=<span class="string">"color: #f89752"</span>&gt;</span>&#123;&#123; user.username &#125;&#125;<span class="tag">&lt;/<span class="name">em</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">&#123;% else %&#125;</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"login_btn fl"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/user/login"</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">span</span>&gt;</span>|<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/user/register"</span>&gt;</span>注册<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"> &#123;% endif %&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>step2</strong> 直接刷新已登录后的主页进行验证</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190328140141462.png" alt></fancybox></p>
<p>2.退出登录</p>
<ul>
<li><strong>step1</strong> 在base.html模板文件中添加退出按钮</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"login_btn fl"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">span</span>&gt;</span>|<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&#123;% url 'user:logout' %&#125;"</span>&gt;</span>退出<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><strong>step2</strong> 在views中定义Logout类视图完成退出功能</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># /user/logout</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LogoutView</span><span class="params">(View)</span>:</span></span><br><span class="line">    <span class="string">"""退出"""</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self, request)</span>:</span></span><br><span class="line">        logout(request)</span><br><span class="line">        <span class="comment"># 退出后跳转到主页</span></span><br><span class="line">        <span class="keyword">return</span> redirect(reverse(<span class="string">"goods:index"</span>))</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>step3</strong> 在urls中定义退出路由</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url(<span class="string">r"^logout$"</span>, LogoutView.as_view(), name=<span class="string">"logout"</span>),  <span class="comment"># 注销</span></span><br></pre></td></tr></table></figure>

<p>3.验证登录登出功能</p>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190328143509609.gif" alt></fancybox></p>
<h1 id="六丶用户中心-地址"><a href="#六丶用户中心-地址" class="headerlink" title="六丶用户中心-地址"></a>六丶用户中心-地址</h1><p>1.在UserAddressView类中定义post方法添加地址</p>
<ul>
<li><strong>step1</strong> 接收用户填写的数据</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">receiver = request.POST.get(<span class="string">"receiver"</span>)  <span class="comment"># 收件人</span></span><br><span class="line">addr = request.POST.get(<span class="string">"addr"</span>)  <span class="comment"># 地址</span></span><br><span class="line">zip_code = request.POST.get(<span class="string">"zip_code"</span>)  <span class="comment"># 邮编</span></span><br><span class="line">phone = request.POST.get(<span class="string">"phone"</span>)  <span class="comment"># 手机号</span></span><br></pre></td></tr></table></figure>

<ul>
<li><strong>step2</strong>  验证数据完整性，邮编可以不填</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> all([receiver, addr, phone]):</span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">"user_center_site.html"</span>, &#123;<span class="string">"error_msg"</span>:<span class="string">"数据不完整"</span>&#125;)</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>step3</strong> 验证手机号格式</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> re.match(<span class="string">r'^1[3|4|5|7|8|9][0-9]&#123;9&#125;$'</span>, phone):</span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">"user_center_site.html"</span>, &#123;<span class="string">"error_msg"</span>: <span class="string">"手机号格式不正确"</span>&#125;)</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>step4</strong> 加收货地址，当用户已存在默认收货地址，添加的地址不作为默认收货地址，否则作为默认收货地址， 因为此界面输入登录后的界面，所以django保存了user对象</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">user = request.user</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    address = Address.objects.get(user=user, is_default=<span class="literal">True</span>)</span><br><span class="line"><span class="keyword">except</span> Address.DoesNotExist:</span><br><span class="line">    <span class="comment"># 出现异常表示该用户还没有设置默认地址</span></span><br><span class="line">    address = <span class="literal">None</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> address:</span><br><span class="line">    is_default = <span class="literal">False</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    is_default = <span class="literal">True</span></span><br></pre></td></tr></table></figure>

<ul>
<li><strong>step5</strong> 保存收货地址，跳转到地址页</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Address.objects.create(user=user, receiver=receiver, addr=addr, zip_code=zip_code, phone=phone, is_default=is_default)</span><br><span class="line"><span class="keyword">return</span> redirect(reverse(<span class="string">"user:address"</span>))</span><br></pre></td></tr></table></figure>

<p>2.在UserAddressView类get方法中获取地址类Address对象</p>
<ul>
<li><strong>step1</strong> 通过登录后的user对象在Address类中获取该用户的地址对象，根据该对象中的is_default字段，设置值为True（也就是该用户存在默认地址）进行数据库df_address表查询，如果出现异常表示该用户并没有收货地，则设置address对象为None，最后将address对象返回给前端模板</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self, request)</span>:</span></span><br><span class="line">    <span class="string">"""显示页面"""</span></span><br><span class="line">    <span class="comment"># 获取用户的的收货地址</span></span><br><span class="line">    user = request.user</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        address = Address.objects.get(user=user, is_default=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">except</span> Address.DoesNotExist:</span><br><span class="line">        <span class="comment"># 出现异常表示该用户还没有设置默认地址</span></span><br><span class="line">        address = <span class="literal">None</span></span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">"user_center_site.html"</span>, &#123;<span class="string">"page"</span>:<span class="string">"address"</span>,<span class="string">"address"</span>:address&#125;)</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>step2</strong> 在用户地址前端模板文件中进行判断，当后端返回的address对象不为空时则从该对象中获取用户填写的收件地址，收件人以及收件人电话，否则返回None</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"site_con"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">dl</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">dt</span>&gt;</span>当前地址：<span class="tag">&lt;/<span class="name">dt</span>&gt;</span></span><br><span class="line">        &#123;% if address %&#125;</span><br><span class="line">        <span class="tag">&lt;<span class="name">dd</span>&gt;</span>&#123;&#123; address.addr &#125;&#125; （&#123;&#123; address.receiver &#125;&#125; 收） &#123;&#123; address.phone &#125;&#125;<span class="tag">&lt;/<span class="name">dd</span>&gt;</span></span><br><span class="line">        &#123;% else %&#125;</span><br><span class="line">        <span class="tag">&lt;<span class="name">dd</span> <span class="attr">style</span>=<span class="string">"color: red"</span>&gt;</span>无默认地址<span class="tag">&lt;/<span class="name">dd</span>&gt;</span></span><br><span class="line">        &#123;% endif %&#125;</span><br><span class="line">	<span class="tag">&lt;/<span class="name">dl</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>3.测试</p>
<ul>
<li><strong>step1</strong> 添加收货地址</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190328181225233.gif" alt></fancybox></p>
<ul>
<li><strong>step2</strong> 查看数据库</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190328181345966.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<p>4.定义地址模型类管理器</p>
<ul>
<li><strong>step1</strong>  在df_use模块models.py文件中创建AddressManager模型类，在类中定义一个方法用于操作模型类对应的数据表，将视图中的UserAddressView类里获取登录后用户的地址对象代码拷贝到此方法中，进行封装</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AddressManager</span><span class="params">(models.Manager)</span>:</span></span><br><span class="line">    <span class="string">"""地址模型类管理器"""</span></span><br><span class="line">    <span class="comment"># 用于操作模型类对应的数据表</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_default_address</span><span class="params">(self, user)</span>:</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            address = self.get(user=user, is_default=<span class="literal">True</span>)</span><br><span class="line">        <span class="keyword">except</span> self.model.DoesNotExist:</span><br><span class="line">            <span class="comment"># 出现异常表示该用户还没有设置默认地址</span></span><br><span class="line">            address = <span class="literal">None</span></span><br><span class="line"> </span><br><span class="line">        <span class="keyword">return</span> address</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>step2</strong> 在df_use模块models.py文件中地址类（Address）中创建AddressManager的实例对象objects</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">objects = AddressManager()</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>step3</strong> 回到UserAddressView类视图中，注释掉try包含的代码，直接通过调用Address.objects.get_default_address方法来获取address对象</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">address = Address.objects.get_default_address(user)</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>step4</strong> 测试添加地址</li>
</ul>
<p><strong>说明：</strong><font style="color:red">收货地址栏可以添加一个复选框，在这个复选框中显示出该用户所有的收货地址，当选择某一个收货地址时，则设置改收货地址的is_default值为1</font></p>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190328194232415.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<h1 id="七丶用户中心-信息"><a href="#七丶用户中心-信息" class="headerlink" title="七丶用户中心-信息"></a>七丶用户中心-信息</h1><p>1.显示基本信息</p>
<ul>
<li><strong>step1</strong> 在UserInfoView类视图get方法中获取用户基本信息</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self, request)</span>:</span></span><br><span class="line">    <span class="string">"""显示页面"""</span></span><br><span class="line">    <span class="comment"># 获取用户地址信息</span></span><br><span class="line">    user = request.user</span><br><span class="line">    address = Address.objects.get_default_address(user)</span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">"user_center_info.html"</span>, &#123;<span class="string">"page"</span>:<span class="string">"user"</span>, <span class="string">"address"</span>:address&#125;)</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>step2</strong> 在模板文件user_center_info.html中获取后端返回的用户地址信息对象，根据该对象来对页面信息进行处理</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"user_info_list"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">span</span>&gt;</span>用户名：<span class="tag">&lt;/<span class="name">span</span>&gt;</span>&#123;&#123; user.username &#125;&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    &#123;% if address %&#125;</span><br><span class="line">	<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">span</span>&gt;</span>联系方式：<span class="tag">&lt;/<span class="name">span</span>&gt;</span>&#123;&#123; address.phone &#125;&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">span</span>&gt;</span>联系地址：<span class="tag">&lt;/<span class="name">span</span>&gt;</span>&#123;&#123; address.addr &#125;&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    &#123;% else %&#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">span</span>&gt;</span>联系方式：<span class="tag">&lt;/<span class="name">span</span>&gt;</span>无<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">span</span>&gt;</span>联系地址：<span class="tag">&lt;/<span class="name">span</span>&gt;</span>无<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    &#123;% endif %&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><strong>step3</strong> 刷新<a href="http://127.0.0.1:8000/user/" target="_blank" rel="noopener">http://127.0.0.1:8000/user/</a>页面</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190328204329811.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<p>2.获取用户历史浏览记录</p>
<ul>
<li><strong>step1</strong> 分析历史浏览记录存储设计</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">1.什么时候添加历史浏览记录</span><br><span class="line">  当用户点击进入某个商品详情页时，需要添加历史浏览记录</span><br><span class="line">2.什么时候获取历史浏览记录</span><br><span class="line">  在用户信息页面显示</span><br><span class="line">3.历史浏览记录往哪里存储</span><br><span class="line">  存储在内存级的redis数据库中提高读写效率</span><br><span class="line">4.以哪种数据格式进行存储</span><br><span class="line">  以list数据格式进行存储</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>step2</strong> 通过django_redis包封装好的get_redis_connection方法获取redis中的StrictRedis类的实例对象 ，这个方法接收参数为default与settings配置文件中django缓存数据库设置名default一致</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conn = get_redis_connection(<span class="string">"default"</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>step3</strong> 设置redis数据库的key</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">history_key = <span class="string">"history_%d"</span> % user.id</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>step4</strong> 获取用户最新浏览的5个商品的id</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sku_ids = conn.lrange(history_key, <span class="number">0</span> ,<span class="number">4</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>step5</strong> 遍历查询到的用户sku_ids,根据遍历出的的id查询出对应的商品信息，之所以定义一个空列表是为了让存入列表中的商品信息，是以先进后出的方式进行排列，因为浏览记录第一个即是用户最后一个浏览的商品详情</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">goods_list = []</span><br><span class="line"><span class="keyword">for</span> sku_id <span class="keyword">in</span> sku_ids:</span><br><span class="line">    goods = GoodsSKU.objects.get(id=sku_id)</span><br><span class="line">    goods_list.append(goods)</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>step6</strong> 构造返回前端模板响应数据</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">content = &#123;<span class="string">"page"</span>:<span class="string">"user"</span>,</span><br><span class="line">           <span class="string">"address"</span>:address,</span><br><span class="line">           <span class="string">"goods_list"</span>:goods_list</span><br><span class="line">           &#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">return</span> render(request, <span class="string">"user_center_info.html"</span>, content )</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>step7</strong> 在user_center_info模板文件中，获取后端返回的数据，并进行判断处理</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% for goods in goods_list %&#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"detail.html"</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"&#123;&#123; goods.image.url &#125;&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h4</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"detail.html"</span>&gt;</span>&#123;&#123; goods.name &#125;&#125;<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"operate"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"prize"</span>&gt;</span>￥&#123;&#123; goods.price &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"unit"</span>&gt;</span>&#123;&#123; goods.price &#125;&#125;/&#123;&#123; goods.unite &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span> <span class="attr">class</span>=<span class="string">"add_goods"</span> <span class="attr">title</span>=<span class="string">"加入购物车"</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    &#123;% empty %&#125;</span><br><span class="line">    无历史浏览记录</span><br><span class="line">&#123;% endfor %&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>step8</strong> 直接刷新<a href="http://127.0.0.1:8000/user/" target="_blank" rel="noopener">http://127.0.0.1:8000/user/</a>用户中心信息页，因为商品详情还没有做，所以数据库中并没有存储历史浏览的商品信息，所以显示无历史浏览记</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/20190329142352402.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></p>
<h1 id="八丶分布式文件系统FastDFS"><a href="#八丶分布式文件系统FastDFS" class="headerlink" title="八丶分布式文件系统FastDFS"></a><font style="color:red">八丶分布式文件系统FastDFS</font></h1><p>1.FastDFS是一个开源的轻量级<a href="https://baike.baidu.com/item/%E5%88%86%E5%B8%83%E5%BC%8F%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/1250388" target="_blank" rel="noopener">分布式文件系统</a>，它对文件进行管理，功能包括：文件存储、文件同步、文件访问（文件上传、文件下载）等，解决了大容量存储和负载均衡的问题</p>
<p>2.该项目之所以使用FastDFS进行图片存储，而不使用django管理员网页进行上传，是因为使用FastDFS对海量存储以及存储扩容方便，同时也解决了同文件重复的问题</p>
<p>3.FastDFS架构图</p>
<p><img src="https://img-blog.csdnimg.cn/20190330165654332.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></p>
<p>服务端两个角色：</p>
<p>Tracker:管理集群，tracker 也可以实现集群。每个 tracker 节点地位平等。收集 Storage 集群的状态。 </p>
<p>Storage:实际保存文件 Storage 分为多个组，每个组之间保存的文件是不同的。每 个组内部可以有多个成员，组成员内部保存的内容是一样的，组成员的地位是一致的，没有 主从的概念。 </p>
<p>4.文件上传流程</p>
<p><img src="https://img-blog.csdnimg.cn/20190330170017981.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></p>
<p>说明：客户端上传文件后存储服务器将文件 ID 返回给客户端，此文件 ID 用于以后访问该文 件的索引信息。文件索引信息包括:组名，虚拟磁盘路径，数据两级目录，文件名</p>
<p>组名:文件上传后所在的 storage 组名称，在文件上传成功后有 storage 服务器返回， 需要客户端自行保存。 </p>
<p>虚拟磁盘路径:storage 配置的虚拟路径，与磁盘选项 store_path*对应。如果配置了 store_path0 则是 M00，如果配置了 store_path1 则是 M01，以此类推。 </p>
<p>数据两级目录:storage 服务器在每个虚拟磁盘路径下创建的两级目录，用于存储数据 文件。 </p>
<p>文件名:与文件上传时不同。是由存储服务器根据特定信息生成，文件名包含:源存储 服务器 IP 地址、文件创建时间戳、文件大小、随机数和文件拓展名等信息</p>
<p>5.文件下载流程</p>
<p><img src="https://img-blog.csdnimg.cn/20190330170237491.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></p>
<p>6.开发环境搭建简易FastDFS架构</p>
<p><img src="https://img-blog.csdnimg.cn/20190330170443216.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></p>
<p><font style="color:red">7.FastDFS安装</font></p>
<p><strong>说明</strong>：FastDFS需要在Linux系统进行安装，网上查了资料并没有推出可以在Windows环境下安装的FastDFS版本，安装FastDFS之前需安装fastdfs依赖包libfastcommon-master.zip</p>
<ul>
<li><strong>step1</strong> 解压缩libfastcommon-master.zip包，进入到libfastcommon-master的目录中，执行 ./make.sh进行编译</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/20190330171824317.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></p>
<ul>
<li><strong>step2</strong> 执行 sudo ./make.sh install进行安装</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/20190330171856664.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></p>
<ul>
<li><strong>step3</strong> 解压缩fastdfs-master.zip，进入到 fastdfs-master目录中，执行 ./make.sh进行编译</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/20190330172107505.png" alt></p>
<ul>
<li><strong>step4</strong> 执行 sudo ./make.sh install进行安装</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/20190330172142269.png" alt></p>
<p>8.配置跟踪服务器tracker</p>
<ul>
<li><strong>step1</strong> 安装完fdfs后在fdfd目录下会产生一个fdfs的配置文件样例 tracker.conf.sample，将该配置文件拷贝并重命名到当前路径下名为tracker.conf</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo cp /etc/fdfs/tracker.conf.sample /etc/fdfs/tracker.conf</span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/20190330172953486.png" alt></p>
<ul>
<li><strong>step2</strong> 在/home/taogang/目录中创建目录 fastdfs/tracker两个层级目录，记得修改（/home/用户名）</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/20190330173019405.png" alt></p>
<ul>
<li><strong>step3</strong> 编辑/etc/fdfs/tracker.conf配置文件,修改 base_path=/home/taogang/fastdfs/tracker</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/fdfs/tracker.conf</span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/20190330173103804.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></p>
<p>9.配置存储服务器storage </p>
<ul>
<li><strong>step1</strong> 将fdfs目录下的storage.conf.sample配置文件拷贝并重命名到当前路径下名为tracker.conf<br>sudo cp /etc/fdfs/storage.conf.sample /etc/fdfs/storage.conf</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/20190330174019688.png" alt></p>
<ul>
<li><strong>step2</strong> 在/home/taogang/fastdfs/ 目录中创建目录 storage</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/20190330174038474.png" alt></p>
<ul>
<li><strong>step3</strong> 编辑/etc/fdfs/storage.conf配置文件，修改如下配置</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/fdfs/storage.conf</span><br><span class="line">base_path=/home/taogang/fastdfs/storage</span><br><span class="line"> </span><br><span class="line">store_path0=/home/taogang/fastdfs/storage</span><br><span class="line"> </span><br><span class="line">tracker_server=你的ubuntu虚拟机的ip地址:22122</span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/20190330174216666.png" alt></p>
<p><img src="https://img-blog.csdnimg.cn/20190330174736928.png" alt></p>
<p><img src="https://img-blog.csdnimg.cn/2019033017474990.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></p>
<p><font style="color:red">10.启动tracker 和 storage</font></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo service fdfs_trackerd start</span><br><span class="line">sudo service fdfs_storaged start</span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/20190330180150925.png" alt></p>
<p><font style="color:red">11.测试是否安装成功</font></p>
<ul>
<li><strong>step1</strong> 将fdfs目录下的client.conf.sample配置文件拷贝并重命名到当前路径下名为client.conf</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo cp /etc/fdfs/client.conf.sample /etc/fdfs/client.conf</span><br></pre></td></tr></table></figure>

<p><strong>step2</strong> 编辑/etc/fdfs/client.conf配置文件，修改如下配置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/fdfs/client.conf</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">base_path=/home/taogang/fastdfs/tracker</span><br><span class="line">tracker_server=你的ubuntu虚拟机的ip地址:22122</span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/20190330180849102.png" alt></p>
<ul>
<li><strong>step3</strong> 上传文件测试，使用fdfs_upload_file /etc/fdfs/client.conf 要上传的文件 ，如果返回类似group1/M00/00/00/xxxxxxxxxxxxxxxxxxxx.sql（上传文件的后缀名）的文件id则说明文件上传成功</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/2019033018094170.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></p>
<h1 id="九丶Nginx配置FastDFS使用的安装和配置"><a href="#九丶Nginx配置FastDFS使用的安装和配置" class="headerlink" title="九丶Nginx配置FastDFS使用的安装和配置"></a><font style="color:red">九丶Nginx配置FastDFS使用的安装和配置</font></h1><p><font style="color:red"><strong>1.说明</strong></font>：使用FastDFS分布式系统架构在用户量比较大的时候，用户对内容的获取效率是非常低的，为了提高效率需要借助Nginx服务器来配置FastDFS进行使用，Nginx服务器在处理静态文件的效率是很高的，因为Nginx服务器内核是epoll，上传资源使用fdfs系统，获取资源则借助nginx服务器来获取；需安装nginx-1.8.1.tar.gz和fastdfs-nginx-module-master.zip这两个包，fastdfs-nginx-module-master.zip这个包的作用就是让nginx服务器和fdfs系统进行关联配置的作用</p>
<p><font style="color:red">2.安装nginx和fastdfs-nginx-module</font></p>
<ul>
<li><strong>step1</strong> 解压缩 nginx-1.8.1.tar.gz和fastdfs-nginx-module-master.zip这两个包，进入nginx-1.8.1目录中，执行sudo ./configure –prefix=/usr/local/nginx/ –add-module=（fastdfs-nginx-module-master）解压后的目录的绝对路径/src</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/20190330182854255.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></p>
<p>结果报错了，看提示是缺少PCRE库</p>
<p><img src="https://img-blog.csdnimg.cn/20190330182957407.png" alt></p>
<ul>
<li><strong>step2</strong> 安装pcre，依次执行下面三条命令</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install libpcre3 libpcre3-dev</span><br><span class="line">sudo apt-get install openssl libssl-dev</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>step3</strong> 安装pcre成功后再次执行configure命令，生成Makefile成功</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/20190330183613235.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></p>
<ul>
<li><strong>step4</strong> 编译</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/20190330183705485.png" alt></p>
<p><img src="https://img-blog.csdnimg.cn/2019033018372155.png" alt></p>
<ul>
<li><strong>step5</strong> 安装</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/20190330183755669.png" alt></p>
<ul>
<li><strong>step6</strong> 安装成功后测试nginx是否安装成功，执行./nginx -t ，结果报错了，根据报错提示，当前用户对该nginx文件下的文件没有读写操作，执行su root切换到root权限，再次执行提示成功</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/20190330184017294.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></p>
<ul>
<li><strong>step7</strong> 拷贝fastdfs-nginx-module-master解压后的目录中src下的mod_fastdfs.conf 到 /etc/fdfs/mod_fastdfs.conf命名为mod_fastdfs.conf</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/20190330184414219.png" alt></p>
<ul>
<li><strong>step8</strong> 编辑/etc/fdfs/mod_fastdfs.conf配置文件，进行以下修改</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/fdfs/mod_fastdfs.conf</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">connect_timeout=10  # 连接fdfs超时时间</span><br><span class="line">tracker_server=自己ubuntu虚拟机的ip地址:22122</span><br><span class="line">url_have_group_name=true  # 访问fdfs时带不带组的信息（group1）</span><br><span class="line">store_path0=/home/python/fastdfs/storage</span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/20190330185254660.png" alt></p>
<p><img src="https://img-blog.csdnimg.cn/20190330185306955.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></p>
<p><img src="https://img-blog.csdnimg.cn/20190330185324758.png" alt></p>
<ul>
<li><strong>step9</strong> 拷贝解压缩的fastdfs-master目录下conf目录中http.conf和mime.types配置文件到 /etc/fdfs目录下</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/20190330185519632.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></p>
<ul>
<li><strong>step10</strong> 编辑/usr/local/nginx/conf/目录下的nginx.conf配置文件，进行如下编写</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /usr/local/nginx/conf/nginx.conf</span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/20190330185841861.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></p>
<ul>
<li><strong>step11</strong> 开启nginx服务</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/20190330185812764.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></p>
<p><font style="color:red">3.测试Nginx服务器配合FastDFS系统进行文件上传与获取</font></p>
<ul>
<li><strong>step1</strong> 开启fdfs服务，上传桌面上的goods_detail.jpg图片，返回文件id，这个id需记住，为了下一步的测试</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/20190330190756675.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></p>
<ul>
<li><strong>step2</strong> 打开浏览器输入<a href="127.0.0.1:8888" target="_blank" rel="noopener">127.0.0.1:8888</a>(nginx配置的端口)/(上传成功返回的文件id)，成功显示出上传的图片</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/20190330190855314.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></p>
<h1 id="十丶Python与FastDFS进行交互"><a href="#十丶Python与FastDFS进行交互" class="headerlink" title="十丶Python与FastDFS进行交互"></a><font style="color:red">十丶Python与FastDFS进行交互</font></h1><ul>
<li><strong>step1</strong> 进入博主自己项目的虚拟环境（django_py2），使用pip安装fdfs_client-py包</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/20190330203805151.png" alt></p>
<ul>
<li><strong>step2</strong> 查看虚拟环境中是否存在fdfs_client-py模块</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/20190330203813295.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></p>
<ul>
<li><strong>step3</strong> 上传测试（上传成功）</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/20190330203918771.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></p>
<ul>
<li><strong>step4</strong> 最后话不多说，在浏览器中通过nginx服务器8888端口来访问上传的的test.py文件，输入上传文件成功返回的文件id，<a href="127.0.0.1:8888/group1/M00/00/00/wKgBClyfYxSAGPA_AAAAFZ3HQjA1801.py" target="_blank" rel="noopener">127.0.0.1:8888/group1/M00/00/00/wKgBClyfYxSAGPA_AAAAFZ3HQjA1801.py</a>，因为上传的文件为py脚本文件，所以提示下载窗口，即</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/20190330204730715.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></p>
<ul>
<li><font style="color:red"><strong>step5 归纳</strong></font>：python作为客户端与fdfs系统进行交互并上传文件成功，安装nginx服务器配合fdfs系统使用成功，最后通过访问配置nginx服务group[0-9]以及8888端口在浏览器中访问python客户端上产到fdfs系统上的文件，非常成功</li>
</ul>
<br>

<p>————————————————<br>版权声明：本文为CSDN博主「cdtaogang」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。<br>原文链接：<a href="https://blog.csdn.net/qq_41782425/article/details/88842059" target="_blank" rel="noopener">https://blog.csdn.net/qq_41782425/article/details/88842059</a></p>

      </div>
      
        <br>
        


  <section class='meta' id="footer-meta">
    <div class='new-meta-box'>
      
        
          <div class="new-meta-item date" itemprop="dateUpdated" datetime="2019-11-13T22:08:46+08:00">
  <a class='notlink'>
    <i class="fas fa-clock" aria-hidden="true"></i>
    <p>更新于 2019年11月13日</p>
  </a>
</div>

        
      
        
          
  
  <div class="new-meta-item meta-tags"><a class="tag" href="/tags/Python/" rel="nofollow"><i class="fas fa-tag" aria-hidden="true"></i><p>Python</p></a></div> <div class="new-meta-item meta-tags"><a class="tag" href="/tags/Django/" rel="nofollow"><i class="fas fa-tag" aria-hidden="true"></i><p>Django</p></a></div> <div class="new-meta-item meta-tags"><a class="tag" href="/tags/Django网站实战/" rel="nofollow"><i class="fas fa-tag" aria-hidden="true"></i><p>Django网站实战</p></a></div> <div class="new-meta-item meta-tags"><a class="tag" href="/tags/Python-Web开发/" rel="nofollow"><i class="fas fa-tag" aria-hidden="true"></i><p>Python Web开发</p></a></div>


        
      
        
          
  <div class="new-meta-item share -mob-share-list">
  <div class="-mob-share-list share-body">
    
      
        <a class="-mob-share-qq" title="QQ好友" rel="external nofollow noopener noreferrer"
          
          href="http://connect.qq.com/widget/shareqq/index.html?url=https://hellotaogang.github.io/2019/11/07/Django项目之Web端电商网站的实战开发（三）/&title=Django项目之Web端电商网站的实战开发（三） | TG'S BLOG&summary=该篇文章是博主一字一码编写的，实属不易，请尊重原创，谢谢大家！温馨提示：需要项目源码的朋友，请添加博主微信进行获取！
&nbsp;&nbsp;本文目录
一丶模板文件继承
二丶用户中心页面显示
三丶登录验证以及登录后跳转的地址
四丶封装login_required方法
五丶登录后显示用户名以及退出登录
六丶用户中心-地址
七丶用户中心-信息
八丶分布式文件系统FastDFS
九丶Nginx配置FastDFS使用的安装和配置
十丶Python与FastDFS进行交互"
          
          >
          
            <img src="https://cdn.jsdelivr.net/gh/xaoxuu/assets@19.1.9/logo/128/qq.png">
          
        </a>
      
    
      
        <a class="-mob-share-qzone" title="QQ空间" rel="external nofollow noopener noreferrer"
          
          href="https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=https://hellotaogang.github.io/2019/11/07/Django项目之Web端电商网站的实战开发（三）/&title=Django项目之Web端电商网站的实战开发（三） | TG'S BLOG&summary=该篇文章是博主一字一码编写的，实属不易，请尊重原创，谢谢大家！温馨提示：需要项目源码的朋友，请添加博主微信进行获取！
&nbsp;&nbsp;本文目录
一丶模板文件继承
二丶用户中心页面显示
三丶登录验证以及登录后跳转的地址
四丶封装login_required方法
五丶登录后显示用户名以及退出登录
六丶用户中心-地址
七丶用户中心-信息
八丶分布式文件系统FastDFS
九丶Nginx配置FastDFS使用的安装和配置
十丶Python与FastDFS进行交互"
          
          >
          
            <img src="https://cdn.jsdelivr.net/gh/xaoxuu/assets@19.1.9/logo/128/qzone.png">
          
        </a>
      
    
      
        <a class='qrcode' rel="external nofollow noopener noreferrer" href='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQ4AAAEOCAAAAABd2qZ5AAAD9klEQVR42u3aQW7jQAwEQP3/097rBoiVbnIUGEjptEgUaaa8QJscXld8vW6v/++5/9v8afl67n9yPXHhwIEDB45DW71f+j3Hu5/kv01WdeADwIEDBw4chzjutzEL1Pssu3/XfXDmT2g/Khw4cODA8fscySbfLTd/Zv7GJPhx4MCBA8cnc7ziqw3gWbm4+Thx4MCBA8dzHPmRUlLCzRp2bVE3e/uxXikOHDhw4Ojyrm4UfvK/H5nvwIEDBw4ccTjNAuk+MjdBm7cOX4sLBw4cOHDsOfYHPKvRgTL72lbg8CPEgQMHDhxrjrwl1x4yJe28WWDvVzisXHHgwIEDxy1H8sokxjb3b4649gXel/tx4MCBA8eaYzZY0IZfUTIFb9k3E38o9nDgwIEDxyGOTXOwbboljbxZnM92VHcxceDAgQNHELHtQmf3bMKy7ePVkY8DBw4cOM5XT1cbaW2s5kVau+3ZG6+NPQ4cOHDgeFO8JZtJ7jxV/u0HI9oi88spHA4cOHDgWHA8MbIwG4zbFHL56F6+Whw4cODAMePI/2x/yNTG6rW+2iYmDhw4cOA4xZGEUH6M1B7zJE/ejD4kz8SBAwcOHKc48kOg2eb3Iw5JbLdFYFHL4sCBAweOEUdx03Ovj9uIZ4ftfvg/ggMHDhw4So68ZMoLp/Z4adZYbIvGiAkHDhw4cKw58lGDfMStPY5qj4hmXwiKd+HAgQMHjgXHPmjzRSQtwllbcLb+R7534MCBA8ef59i08PIAbkO6PaDarxwHDhw4cJziyAfjZiXZrOWXQ+QBfH8nDhw4cOA4yzErlvZhOTtkOhXY39yJAwcOHDjWHG2LrR1lyIfeTjUZ281HhRwOHDhw4Ig5Zn+WFHhPNPKSAJ6B4sCBAweOsxyzNl9eUCXLaocnkoZmO36HAwcOHDj2HLNG2yaGW+7i0ChG+SGkceDAgQPHgmNfjOVw+zGIthGZh/o33ztw4MCBA8eIo7hpdBQ0O7ia8eW7KDqROHDgwIFjzdHWMm2Z147KJQVe3nyMVoIDBw4cOBYceZGWk82CM4/e9oirKERx4MCBA8chjry027T2ZoXcZpCuvh8HDhw4cBy6v20F7sunzaLreY1yOAMHDhw4cGw4XuWVFG+z0YRZ3CbNyvyLAg4cOHDg2HOcGnpoy7O2vTiL7fYgDQcOHDhwnOLYhGvbCmxjst1qG7T1J48DBw4cOGKOWVDlhdAs4dtGZPtkHDhw4MDxCRz5Qc6mjZgH8KyYfLsqHDhw4MDx6xzt5vPjpfyePG7rEQccOHDgwHGIo42rPJs2HO0zZ/GPAwcOHDjOcsxaae2hzgwi2XD+5PbwDAcOHDhwlBz/APune+7fF5KHAAAAAElFTkSuQmCC'>
        
          <img src="https://cdn.jsdelivr.net/gh/xaoxuu/assets@19.1.9/logo/128/wechat.png">
        
        </a>
      
    
      
        <a class="-mob-share-weibo" title="微博" rel="external nofollow noopener noreferrer"
          
          href="http://service.weibo.com/share/share.php?url=https://hellotaogang.github.io/2019/11/07/Django项目之Web端电商网站的实战开发（三）/&title=Django项目之Web端电商网站的实战开发（三） | TG'S BLOG&summary=该篇文章是博主一字一码编写的，实属不易，请尊重原创，谢谢大家！温馨提示：需要项目源码的朋友，请添加博主微信进行获取！
&nbsp;&nbsp;本文目录
一丶模板文件继承
二丶用户中心页面显示
三丶登录验证以及登录后跳转的地址
四丶封装login_required方法
五丶登录后显示用户名以及退出登录
六丶用户中心-地址
七丶用户中心-信息
八丶分布式文件系统FastDFS
九丶Nginx配置FastDFS使用的安装和配置
十丶Python与FastDFS进行交互"
          
          >
          
            <img src="https://cdn.jsdelivr.net/gh/xaoxuu/assets@19.1.9/logo/128/weibo.png">
          
        </a>
      
    
  </div>
</div>



        
      
    </div>
  </section>


      
      
          <div class="prev-next">
              
                  <section class="prev">
                      <span class="art-item-left">
                          <h6><i class="fas fa-chevron-left" aria-hidden="true"></i>&nbsp;上一页</h6>
                          <h4>
                              <a href="/2019/11/07/Django项目之Web端电商网站的实战开发（四）/" rel="prev" title="Django项目之Web端电商网站的实战开发（四）">
                                
                                    Django项目之Web端电商网站的实战开发（四）
                                
                              </a>
                          </h4>
                          
                              
                              <h6 class="tags">
                                  <a class="tag" href="/tags/Python/"><i class="fas fa-tag fa-fw" aria-hidden="true"></i> Python</a> <a class="tag" href="/tags/Django/"><i class="fas fa-tag fa-fw" aria-hidden="true"></i> Django</a> <a class="tag" href="/tags/Django网站实战/"><i class="fas fa-tag fa-fw" aria-hidden="true"></i> Django网站实战</a> <a class="tag" href="/tags/Python-Web开发/"><i class="fas fa-tag fa-fw" aria-hidden="true"></i> Python Web开发</a>
                              </h6>
                          
                      </span>
                  </section>
              
              
                  <section class="next">
                      <span class="art-item-right" aria-hidden="true">
                          <h6>下一页&nbsp;<i class="fas fa-chevron-right" aria-hidden="true"></i></h6>
                          <h4>
                              <a href="/2019/11/06/Django项目之Web端电商网站的实战开发（二）/" rel="prev" title="Django项目之Web端电商网站的实战开发（二）">
                                  
                                      Django项目之Web端电商网站的实战开发（二）
                                  
                              </a>
                          </h4>
                          
                              
                              <h6 class="tags">
                                  <a class="tag" href="/tags/Python/"><i class="fas fa-tag fa-fw" aria-hidden="true"></i> Python</a> <a class="tag" href="/tags/Django/"><i class="fas fa-tag fa-fw" aria-hidden="true"></i> Django</a> <a class="tag" href="/tags/Django网站实战/"><i class="fas fa-tag fa-fw" aria-hidden="true"></i> Django网站实战</a> <a class="tag" href="/tags/Python-Web开发/"><i class="fas fa-tag fa-fw" aria-hidden="true"></i> Python Web开发</a>
                              </h6>
                          
                      </span>
                  </section>
              
          </div>
      
    </section>
  </article>



  <!-- 显示推荐文章和评论 -->



  <article class="post white-box comments">
    <section class="article typo">
      <h4><i class="fas fa-comments fa-fw" aria-hidden="true"></i>&nbsp;评论</h4>
      
      
      
        <section id="comments">
          <div id="gitalk-container"></div>
        </section>
      
      
    </section>
  </article>






<!-- 根据页面mathjax变量决定是否加载MathJax数学公式js -->



  <script>
    window.subData = {
      title: 'Django项目之Web端电商网站的实战开发（三）',
      tools: true
    }
  </script>


</div>
<aside class='l_side'>
  
    
    
      
        
          
          
        
          
          
            
              
  <section class='widget toc-wrapper'>
    
<header class='pure'>
  <div><i class="fas fa-list fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;本文目录</div>
  
    <!-- <div class='wrapper'><a class="s-toc rightBtn" rel="external nofollow noopener noreferrer" href="javascript:void(0)"><i class="fas fa-thumbtack fa-fw"></i></a></div> -->
  
</header>

    <div class='content pure'>
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#一丶模板文件继承"><span class="toc-text">一丶模板文件继承</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#二丶用户中心页面显示"><span class="toc-text">二丶用户中心页面显示</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#三丶登录验证以及登录后跳转的地址"><span class="toc-text">三丶登录验证以及登录后跳转的地址</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#四丶封装login-required方法"><span class="toc-text">四丶封装login_required方法</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#五丶登录后显示用户名以及退出登录"><span class="toc-text">五丶登录后显示用户名以及退出登录</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#六丶用户中心-地址"><span class="toc-text">六丶用户中心-地址</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#七丶用户中心-信息"><span class="toc-text">七丶用户中心-信息</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#八丶分布式文件系统FastDFS"><span class="toc-text">八丶分布式文件系统FastDFS</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#九丶Nginx配置FastDFS使用的安装和配置"><span class="toc-text">九丶Nginx配置FastDFS使用的安装和配置</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#十丶Python与FastDFS进行交互"><span class="toc-text">十丶Python与FastDFS进行交互</span></a></li></ol>
    </div>
  </section>


            
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
      
    

  
</aside>

<footer id="footer" class="clearfix">
  
  
    <div class="social-wrapper">
      
        
          <a href="http://wpa.qq.com/msgrd?v=3&amp;uin=1126331350&amp;site=qq&amp;menu=yes"
            class="social fab fa-qq flat-btn flat-btn"
            target="_blank"
            rel="external nofollow noopener noreferrer">
          </a>
        
      
        
          <a href="https://cdn.jsdelivr.net/gh/Hellotaogang/cdn@4.4/about/wxhy.png"
            class="social fab fa-weixin flat-btn flat-btn"
            target="_blank"
            rel="external nofollow noopener noreferrer">
          </a>
        
      
        
          <a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=cdtaogang@163.com"
            class="social fas fa-envelope flat-btn"
            target="_blank"
            rel="external nofollow noopener noreferrer">
          </a>
        
      
        
          <a href="https://github.com/Hellotaogang"
            class="social fab fa-github flat-btn"
            target="_blank"
            rel="external nofollow noopener noreferrer">
          </a>
        
      
        
          <a href="https://blog.csdn.net/qq_41782425"
            class="social fab fa-cuttlefish flat-btn flat-btn"
            target="_blank"
            rel="external nofollow noopener noreferrer">
          </a>
        
      
    </div>
  
  <br>
  <div><p>Copyright <i class='far fa-copyright'></i> 2019-2020 <a style='color: #333333' href='https://www.cdtaogang.top/' target='_blank'>TG’BLOG</a>&nbsp;&nbsp;|&nbsp;&nbsp;<span id='timeDate'>载入天数…</span><span id='times'>载入时分秒…</span></p>
</div>
  <br>
  <div>
    <div class='github-badge'> <a style='color: #fff' href='https://hexo.io/'><span class='badge-subject'>框架</span><span class='badge-value bg-blue'>Hexo</span></a> </div> <div class='github-badge'> <a style='color: #fff' href='https://github.com/'><span class='badge-subject'>托管</span><span class='badge-value bg-brightgreen'>GitHub</span></a> </div> <div class='github-badge'> <a style='color: #fff' href='https://www.aliyun.com/'><span class='badge-subject'>域名</span><span class='badge-value bg-firebrick'>Aliyun</span></a> </div> <div class='github-badge'> <a style='color: #fff' href='https://www.jsdelivr.com/'><span class='badge-subject'>内容分发网络</span><span class='badge-value bg-orange'>jsDelivr</span></a> </div> <div class='github-badge'> <a style='color: #fff' href='https://996.icu/#/zh_CN'><span class='badge-subject'>链接</span><span class='badge-value bg-red'>996.ICU</span></a> </div> <div class='github-badge'> <a style='color: #fff' href='https://xaoxuu.com/wiki/material-x/'><span class='badge-subject'>主题</span><span class='badge-value bg-blue'>Material X</span></a> </div> <div class='github-badge'> <a style='color: #fff' href='https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh'><span class='badge-subject'>协议</span><span class='badge-value bg-pink'>BY-NC-SA 4.0</span></a> </div>
  </div>
<script>
    var now = new Date(); 
    function createtime() { 
        var grt= new Date("10/11/2019 21:38:00");//在此处修改你的建站时间
        now.setTime(now.getTime()+250); 
        days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days); 
        hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours); 
        if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum); 
        mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;} 
        seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum); 
        snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;} 
        document.getElementById("timeDate").innerHTML = "本站已安全运行 "+dnum+" 天 "; 
        document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒"; 
    } 
setInterval("createtime()",250);
</script>
</footer>
<script>setLoadingBarProgress(80);</script>



      <script>setLoadingBarProgress(60);</script>
    </div>
    <a class="s-top fas fa-arrow-up fa-fw" href='javascript:void(0)'></a>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>

  <script>
    var GOOGLE_CUSTOM_SEARCH_API_KEY = "";
    var GOOGLE_CUSTOM_SEARCH_ENGINE_ID = "";
    var ALGOLIA_API_KEY = "";
    var ALGOLIA_APP_ID = "";
    var ALGOLIA_INDEX_NAME = "";
    var AZURE_SERVICE_NAME = "";
    var AZURE_INDEX_NAME = "";
    var AZURE_QUERY_KEY = "";
    var BAIDU_API_ID = "";
    var SEARCH_SERVICE = "hexo" || "hexo";
    var ROOT = "/"||"/";
    if(!ROOT.endsWith('/'))ROOT += '/';
  </script>

<script src="//instant.page/1.2.2" type="module" integrity="sha384-2xV8M5griQmzyiY3CDqh1dn4z3llDVqZDqzjzcY+jCBCk/a5fXJmuZ/40JJAPeoU"></script>


  <script async src="https://cdn.jsdelivr.net/npm/scrollreveal@4.0.5/dist/scrollreveal.min.js"></script>
  <script type="text/javascript">
    $(function() {
      const $reveal = $('.reveal');
      if ($reveal.length === 0) return;
      const sr = ScrollReveal({ distance: 0 });
      sr.reveal('.reveal');
    });
  </script>


  <script src="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.js"></script>
  <script type="text/javascript">
    $(function() {
      Waves.attach('.flat-btn', ['waves-button']);
      Waves.attach('.float-btn', ['waves-button', 'waves-float']);
      Waves.attach('.float-btn-light', ['waves-button', 'waves-float', 'waves-light']);
      Waves.attach('.flat-box', ['waves-block']);
      Waves.attach('.float-box', ['waves-block', 'waves-float']);
      Waves.attach('.waves-image');
      Waves.init();
    });
  </script>


  <script async src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-busuanzi@2.3/js/busuanzi.pure.mini.js"></script>




  
  
  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-backstretch/2.0.4/jquery.backstretch.min.js"></script>
    <script type="text/javascript">
      $(function(){
        if ('.cover') {
          $('.cover').backstretch(
          ["https://cdn.jsdelivr.net/gh/Hellotaogang/cdn@4.5.7/images/background_4.jpg", "https://cdn.jsdelivr.net/gh/Hellotaogang/cdn@4.5.7/images/background_5.jpg", "https://cdn.jsdelivr.net/gh/Hellotaogang/cdn@4.5.7/images/background_6.jpg"],
          {
            duration: "6000",
            fade: "2500"
          });
        } else {
          $.backstretch(
          ["https://cdn.jsdelivr.net/gh/Hellotaogang/cdn@4.5.7/images/background_4.jpg", "https://cdn.jsdelivr.net/gh/Hellotaogang/cdn@4.5.7/images/background_5.jpg", "https://cdn.jsdelivr.net/gh/Hellotaogang/cdn@4.5.7/images/background_6.jpg"],
          {
            duration: "6000",
            fade: "2500"
          });
        }
      });
    </script>
  







  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
  <script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
  <script src="https://cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.min.js"></script>
  <script type="text/javascript">
    var gitalk = new Gitalk({
      clientID: "71020b6958cd6bbf65b7",
      clientSecret: "3cfeccd9125b8bac76f2bd8a7f6e30a601ae3a81",
      repo: "Hellotaogang.github.io",
      owner: "Hellotaogang",
      admin: "Hellotaogang",
      
        id: md5(location.pathname),      // Ensure uniqueness and length less than 50
      
      distractionFreeMode: false  // Facebook-like distraction free mode
    });
    gitalk.render('gitalk-container');
  </script>





  <script src="/js/app.js"></script>


  <script src="/js/search.js"></script>




<!-- 复制 -->
<script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script>
  let COPY_SUCCESS = "复制成功";
  let COPY_FAILURE = "复制失败";
  /*页面载入完成后，创建复制按钮*/
  !function (e, t, a) {
    /* code */
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '  <i class="fa fa-copy"></i><span>复制</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });

      clipboard.on('success', function(e) {
        //您可以加入成功提示
        console.info('Action:', e.action);
        console.info('Text:', e.text);
        console.info('Trigger:', e.trigger);
        success_prompt(COPY_SUCCESS);
        e.clearSelection();
      });
      clipboard.on('error', function(e) {
        //您可以加入失败提示
        console.error('Action:', e.action);
        console.error('Trigger:', e.trigger);
        fail_prompt(COPY_FAILURE);
      });
    }
    initCopyCode();

  }(window, document);

  /**
   * 弹出式提示框，默认1.5秒自动消失
   * @param message 提示信息
   * @param style 提示样式，有alert-success、alert-danger、alert-warning、alert-info
   * @param time 消失时间
   */
  var prompt = function (message, style, time)
  {
      style = (style === undefined) ? 'alert-success' : style;
      time = (time === undefined) ? 1500 : time*1000;
      $('<div>')
          .appendTo('body')
          .addClass('alert ' + style)
          .html(message)
          .show()
          .delay(time)
          .fadeOut();
  };

  // 成功提示
  var success_prompt = function(message, time)
  {
      prompt(message, 'alert-success', time);
  };

  // 失败提示
  var fail_prompt = function(message, time)
  {
      prompt(message, 'alert-danger', time);
  };

  // 提醒
  var warning_prompt = function(message, time)
  {
      prompt(message, 'alert-warning', time);
  };

  // 信息提示
  var info_prompt = function(message, time)
  {
      prompt(message, 'alert-info', time);
  };

</script>


<!-- fancybox -->
<script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>
<script>
  let LAZY_LOAD_IMAGE = "";
  $(".article-entry").find("fancybox").find("img").each(function () {
      var element = document.createElement("a");
      $(element).attr("data-fancybox", "gallery");
      $(element).attr("href", $(this).attr("src"));
      /* 图片采用懒加载处理时,
       * 一般图片标签内会有个属性名来存放图片的真实地址，比如 data-original,
       * 那么此处将原本的属性名src替换为对应属性名data-original,
       * 修改如下
       */
       if (LAZY_LOAD_IMAGE) {
         $(element).attr("href", $(this).attr("data-original"));
       }
      $(this).wrap(element);
  });
</script>





  <script>setLoadingBarProgress(100);</script>
  <!-- 页面点击小红心 -->
  <!-- <script type="text/javascript" src="/js/love.js"></script> -->
  <!--单击显示文字-->
  <!-- <script type="text/javascript" src="/js/click_show_text.js"></script> -->
  <!-- 鼠标点击烟花 -->
  <!-- <canvas class="fireworks" style="position: fixed;left: 0;top: 0;z-index: 1; pointer-events: none;" ></canvas> 
  <script type="text/javascript" src="//cdn.bootcss.com/animejs/2.2.0/anime.min.js"></script> 
  <script type="text/javascript" src="/js/fireworks.js"></script> -->
  <!--浏览器搞笑标题-->
  <script type="text/javascript" src="\js\FunnyTitle.js"></script>
  <!--动态线条背景-->
  <script type="text/javascript"
color="0,0,0" opacity='0.7' zIndex="-2" count="200" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js">
  </script>
  <!-- 样式一（鼠标点击更换样式） -->
<!-- <script src="https://g.joyinshare.com/hc/ribbon.min.js" type="text/javascript"></script> -->
<!-- 样式二（飘动的彩带） -->
<!-- <script src="https://g.joyinshare.com/hc/piao.js" type="text/javascript"></script> -->
  <!-- 数字雨 -->
  <!-- <canvas id="canvas" width="1440" height="900" ></canvas>
  <script type="text/javascript" src="/js/DigitalRain.js"></script> -->
</body>
</html>
