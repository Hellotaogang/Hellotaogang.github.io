<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  
  <title>Django项目于之在线教育平台网站的实战开发（三） | TG&#39;S BLOG</title>
  
  
  <meta name="description" content="该篇文章是博主一字一码编写的，实属不易，请尊重原创，谢谢大家！">
  

  

  <meta name="HandheldFriendly" content="True">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <!-- meta -->
  

  <!-- link -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css">
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.css">
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.10.1/css/all.min.css">
  

  
  <link rel="shortcut icon" type="image/x-icon" href="https://cdn.jsdelivr.net/gh/Hellotaogang/cdn@4.3/images/favicon.ico">
  

  
    <link rel="stylesheet" href="/style.css">
  

  <script>
    function setLoadingBarProgress(num) {
      document.getElementById('loading-bar').style.width=num+"%";
    }
  </script>

  
  
</head>

<body>
  
  
  <div class="cover-wrapper">
    <cover class='cover post half'>
      
        
  <img class='logo' src='https://cdn.jsdelivr.net/gh/Hellotaogang/cdn@4.5.6/images/logo_2.png'/>


  <div class="m_search">
    <form name="searchform" class="form u-search-form">
      <input type="text" class="input u-search-input" placeholder="" />
      <i class="icon fas fa-search fa-fw"></i>
    </form>
  </div>

<div class='menu navgation'>
  <ul class='h-list'>
    
      
        <li>
          <a class="nav home" href="/"
            
            
            id="home">
            <i class='fas fa-home fa-fw'></i>&nbsp;主页
          </a>
        </li>
      
        <li>
          <a class="nav home" href="/categories/"
            
            
            id="categories">
            <i class='fas fa-folder-open fa-fw'></i>&nbsp;分类
          </a>
        </li>
      
        <li>
          <a class="nav home" href="/tags/"
            
              rel="nofollow"
            
            
            id="tags">
            <i class='fas fa-tags fa-fw'></i>&nbsp;标签
          </a>
        </li>
      
        <li>
          <a class="nav home" href="/love/"
            
              rel="nofollow"
            
            
            id="love">
            <i class='fas fa-heart fa-fw'></i>&nbsp;记录
          </a>
        </li>
      
        <li>
          <a class="nav home" href="/about/"
            
              rel="nofollow"
            
            
            id="about">
            <i class='fas fa-info-circle fa-fw'></i>&nbsp;关于
          </a>
        </li>
      
    
  </ul>
</div>

      
    </cover>
    <header class="l_header pure">
  <div id="loading-bar-wrapper">
    <div id="loading-bar" class="pure"></div>
  </div>

	<div class='wrapper'>
		<div class="nav-main container container--flex">
      <a class="logo flat-box" href='/' >
        
          TG'S BLOG
        
      </a>
			<div class='menu navgation'>
				<ul class='h-list'>
          
  					
  						<li>
								<a class="nav flat-box" href="/"
                  
                  
                  id="home">
									<i class='fas fa-home fa-fw'></i>&nbsp;主页
								</a>
							</li>
      			
  						<li>
								<a class="nav flat-box" href="/categories/"
                  
                    rel="nofollow"
                  
                  
                  id="categories">
									<i class='fas fa-folder-open fa-fw'></i>&nbsp;分类
								</a>
							</li>
      			
  						<li>
								<a class="nav flat-box" href="/tags/"
                  
                    rel="nofollow"
                  
                  
                  id="tags">
									<i class='fas fa-tags fa-fw'></i>&nbsp;标签
								</a>
							</li>
      			
  						<li>
								<a class="nav flat-box" href="/archives/"
                  
                    rel="nofollow"
                  
                  
                  id="archives">
									<i class='fas fa-archive fa-fw'></i>&nbsp;归档
								</a>
							</li>
      			
  						<li>
								<a class="nav flat-box" href="/love/"
                  
                    rel="nofollow"
                  
                  
                  id="love">
									<i class='fas fa-heart fa-fw'></i>&nbsp;记录
								</a>
							</li>
      			
  						<li>
								<a class="nav flat-box" href="/about/"
                  
                    rel="nofollow"
                  
                  
                  id="about">
									<i class='fas fa-info-circle fa-fw'></i>&nbsp;关于
								</a>
							</li>
      			
      		
				</ul>
			</div>

			
				<div class="m_search">
					<form name="searchform" class="form u-search-form">
						<input type="text" class="input u-search-input" placeholder="搜索" />
						<i class="icon fas fa-search fa-fw"></i>
					</form>
				</div>
			
			<ul class='switcher h-list'>
				
					<li class='s-search'><a class="fas fa-search fa-fw" href='javascript:void(0)'></a></li>
				
				<li class='s-menu'><a class="fas fa-bars fa-fw" href='javascript:void(0)'></a></li>
			</ul>
		</div>

		<div class='nav-sub container container--flex'>
			<a class="logo flat-box"></a>
			<ul class='switcher h-list'>
				<li class='s-comment'><a class="flat-btn fas fa-comments fa-fw" href='javascript:void(0)'></a></li>
        
          <li class='s-toc'><a class="flat-btn fas fa-list fa-fw" href='javascript:void(0)'></a></li>
        
			</ul>
		</div>
	</div>
</header>
	<aside class="menu-phone">
    <header>
		<nav class="menu navgation">
      <ul>
        
          
            <li>
							<a class="nav flat-box" href="/"
                
                
                id="home">
								<i class='fas fa-clock fa-fw'></i>&nbsp;近期文章
							</a>
            </li>
          
            <li>
							<a class="nav flat-box" href="/blog/archives/"
                
                  rel="nofollow"
                
                
                id="blogarchives">
								<i class='fas fa-archive fa-fw'></i>&nbsp;文章归档
							</a>
            </li>
          
            <li>
							<a class="nav flat-box" href="/projects/"
                
                
                id="projects">
								<i class='fas fa-code-branch fa-fw'></i>&nbsp;开源项目
							</a>
            </li>
          
            <li>
							<a class="nav flat-box" href="/friends/"
                
                  rel="nofollow"
                
                
                id="friends">
								<i class='fas fa-link fa-fw'></i>&nbsp;我的友链
							</a>
            </li>
          
            <li>
							<a class="nav flat-box" href="https://xaoxuu.com/wiki/material-x/"
                
                  rel="nofollow"
                
                
                id="https:xaoxuu.comwikimaterial-x">
								<i class='fas fa-book fa-fw'></i>&nbsp;主题文档
							</a>
            </li>
          
            <li>
							<a class="nav flat-box" href="/about/"
                
                  rel="nofollow"
                
                
                id="about">
								<i class='fas fa-info-circle fa-fw'></i>&nbsp;关于小站
							</a>
            </li>
          
       
      </ul>
		</nav>
    </header>
	</aside>
<script>setLoadingBarProgress(40);</script>

  </div>


  <div class="l_body">
    <div class='body-wrapper'>
      <div class='l_main'>
  

  <article id="post" class="post white-box article-type-post" itemscope itemprop="blogPost">
    


  <section class='meta'>
    
    
      <a title='Django项目于之在线教育平台网站的实战开发（三）' href='/2019/11/14/Django项目于之在线教育平台网站的实战开发（三）/'><img class='thumbnail' src='https://cdn.jsdelivr.net/gh/Hellotaogang/cdn@4.6.5/images/django.png'></a>
    
    <div class="meta" id="header-meta">
      
        
  
    <h1 class="title">
      <a href="/2019/11/14/Django项目于之在线教育平台网站的实战开发（三）/">
        Django项目于之在线教育平台网站的实战开发（三）
      </a>
    </h1>
  


      
      <div class='new-meta-box'>
        
          
        
          
            
  <div class='new-meta-item author'>
    
      <a href="/" rel="nofollow">
        
          <img src="https://cdn.jsdelivr.net/gh/Hellotaogang/cdn@4.4.3/images/avatar_4.png">
        
        <p>cdtaogang</p>
      </a>
    
  </div>


          
        
          
            <div class="new-meta-item date">
  <a class='notlink'>
    <i class="fas fa-calendar-alt" aria-hidden="true"></i>
    <p>2019-11-14</p>
  </a>
</div>

          
        
          
            
  
  <div class='new-meta-item category'>
    <a href='/categories/Django开发/' rel="nofollow">
      <i class="fas fa-folder-open" aria-hidden="true"></i>
      <p>Django开发</p>
    </a>
  </div>


          
        
          
            
  
    <div class="new-meta-item browse busuanzi">
      <a class='notlink'>
        <i class="fas fa-eye" aria-hidden="true"></i>
        <p>
          <span id="busuanzi_value_page_pv">
            <i class="fas fa-spinner fa-spin fa-fw" aria-hidden="true"></i>
          </span>
        </p>
      </a>
    </div>
  


          
        
          
            

          
        
      </div>
      
        <hr>
      
    </div>
  </section>


    <section class="article typo">
      <div class="article-entry" itemprop="articleBody">
        <p>该篇文章是博主一字一码编写的，实属不易，请尊重原创，谢谢大家！<br><font style="color:red">温馨提示：需要项目源码的朋友，请添加博主微信进行获取！</font></p>
<div style="color:#fb651b"><i class="fas fa-list fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;本文目录</div>
<li class="toc-item toc-level-1"><a style=" text-decoration:none;" href="#一丶授课机构（列表页）"><span style="color:#4ea1db">一丶授课机构（列表页）</span></a></li>
<li class="toc-item toc-level-1"><a style=" text-decoration:none;" href="#二丶授课机构（用户咨询）"><span style="color:#4ea1db">二丶授课机构（用户咨询）</span></a></li>
<li class="toc-item toc-level-1"><a style=" text-decoration:none;" href="#三丶授课机构（详情页） "><span style="color:#4ea1db">三丶授课机构（详情页） </span></a></li>
<li class="toc-item toc-level-1"><a style=" text-decoration:none;" href="#四丶授课机构（用户收藏） "><span style="color:#4ea1db">四丶授课机构（用户收藏）</span></a></li>
<li class="toc-item toc-level-1"><a style=" text-decoration:none;" href="#五丶公开课（列表页）"><span style="color:#4ea1db">五丶公开课（列表页）</span></a></li>
<a id="more"></a>

<h1 id="一丶授课机构（列表页）"><a href="#一丶授课机构（列表页）" class="headerlink" title="一丶授课机构（列表页）"></a>一丶授课机构（列表页）</h1><p><strong>1.</strong>模板继承</p>
<ul>
<li>在授课机构列表页（org-list.html）与其他页面除了内容块不同，其他部分都是共用的，如页面头部与底部（这个不用多说django模板继承基础知识点）</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190507102752366.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190507102916139.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>在templates模板目录下创建base.html父模板文件，然后将static目录下的org-list.html模板文件拷贝到templates目录下，并且将org-list模板内容剪切到base模板中，在base父模板文件中首先需要修改资源文件的加载方式这不用多说，然后需要对多个页面不一致的地方在父模板中进行挖坑处理（之前<a href="https://blog.csdn.net/qq_41782425/article/details/88842059" target="_blank" rel="noopener">Django 电商项目</a>已经详细说明过，这里简单说明下）</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190507110105808.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>在org-list模板文件中只需要继承父模板，重写父模板中的授课机构独有的数据块即可</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/20190507110223822.png" alt></p>
<p><strong>2.</strong>显示授课机构列表页面</p>
<ul>
<li>在organization/views中定义类视图get方法，用于显示授课机构列表页</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OrgView</span><span class="params">(View)</span>:</span></span><br><span class="line">    <span class="string">"""课程机构列表页"""</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self, request)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> render(request, <span class="string">"org-list.html"</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li>在根级urls中定义路由</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url(<span class="string">r'^org_list/$'</span>, OrgView.as_view(), name=<span class="string">"org_list"</span>),  <span class="comment"># 课程机构列表页</span></span><br></pre></td></tr></table></figure>

<ul>
<li>在index模板文件中修改授课机构链接地址</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">li</span> &gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&#123;% url 'org_list' %&#125;"</span>&gt;</span>授课机构<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>运行项目，访问<a href="http://127.0.0.1:8000/org_list/" target="_blank" rel="noopener">http://127.0.0.1:8000/org_list/</a>页面则，显示授课机构列表页</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190507104416866.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<p><strong>3.</strong>添加页面数据</p>
<ul>
<li>在xadmin后台管理系统中，在机构管理中添加城市信息</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190507111552753.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>在xadmin后台管理系统中，在机构管理中添加授课机构信息，其中涉及到上传文件，所以需要定义保存文件路径</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190507112038148.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>上传资源文件配置，首先在项目根目录下创建medio目录，然后在settings中添加目录路径</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># 资源文件配置</span><br><span class="line">MEDIA_URL = &apos;/media/&apos;</span><br><span class="line">MEDIA_ROOT = os.path.join(BASE_DIR, &apos;media&apos;)</span><br></pre></td></tr></table></figure>

<ul>
<li>回到xadmin后台管理系统进行添加课程机构信息</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190507113423324.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>查看项目medio目录下已经成功创建生成上传的Logo图片文件，即在models中定义的image字段，在xadmin后台进行保存时，则会在settings配置的资源文件配置中指定的medio目录下创建当前的年/月的目录并将上传成功的图片文件放在该目录下（<font style="color:red">image = models.ImageField(upload_to=”org/%Y/%m”, verbose_name=u”logo”, max_length=100)</font>）</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/20190507113602375.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></p>
<ul>
<li>博主这边直接添加了以下几所大学</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/2019050712074544.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<p><strong>4.</strong>增加数据表机构类别字段</p>
<ul>
<li>之前在定义CourseOrg模型类时，未添加机构类别字段</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190507121348538.png" alt></fancybox></p>
<ul>
<li>即在CourseOrg模型类中增加此字段（该字端数据为固定数据）</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">category = models.CharField(default=<span class="string">"pxjg"</span>, verbose_name=<span class="string">u"机构类别"</span>, max_length=<span class="number">20</span>, choices=((<span class="string">"pxjg"</span>,<span class="string">"培训机构"</span>),(<span class="string">"gr"</span>,<span class="string">"个人"</span>),(<span class="string">"gx"</span>,<span class="string">"高校"</span>)))</span><br></pre></td></tr></table></figure>

<ul>
<li>紧接着生成对应数据表字段</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/2019050712171477.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>查看数据表结构</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/20190507121858206.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></p>
<p><strong>5.</strong>加载页面动态数据</p>
<ul>
<li>在类视图get方法中获取数据表数据，并传递给模板</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OrgView</span><span class="params">(View)</span>:</span></span><br><span class="line">    <span class="string">"""课程机构列表页"""</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self, request)</span>:</span></span><br><span class="line">        all_orgs = CourseOrg.objects.all()  <span class="comment"># 课程机构</span></span><br><span class="line">        org_nums = all_orgs.count()  <span class="comment"># 机构数量</span></span><br><span class="line">        all_citys = CityDict.objects.all()  <span class="comment"># 城市</span></span><br><span class="line">        <span class="keyword">return</span> render(request, <span class="string">"org-list.html"</span>, &#123;<span class="string">"all_orgs"</span>:all_orgs, <span class="string">"org_nums"</span>:org_nums, <span class="string">"all_citys"</span>:all_citys&#125;)</span><br></pre></td></tr></table></figure>

<ul>
<li>在org-list模板文件中进行打印目前数据库中获取的模板信息，具体如下，为了让大家明白模板中显示内容，博主专门进行注释</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 城市信息 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"cont"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"?ct="</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"active2"</span>&gt;</span>全部<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    &#123;% for city in all_citys %&#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"?city=1&amp;ct="</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">""</span>&gt;</span>&#123;&#123; city.name &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    &#123;% endfor %&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 机构数量 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"all"</span>&gt;</span>共<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"key"</span>&gt;</span>&#123;&#123; org_nums &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span>家<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 机构列表 --&gt;</span></span><br><span class="line">&#123;% for org in all_orgs %&#125;</span><br><span class="line"><span class="tag">&lt;<span class="name">dl</span> <span class="attr">class</span>=<span class="string">"des difdes"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dt</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"org-detail-homepage.html"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">img</span> <span class="attr">width</span>=<span class="string">"200"</span> <span class="attr">height</span>=<span class="string">"120"</span> <span class="attr">class</span>=<span class="string">"scrollLoading"</span> <span class="attr">data-url</span>=<span class="string">"&#123;&#123; MEDIA_URL &#125;&#125;&#123;&#123; org.image &#125;&#125;"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dt</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dd</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"clearfix"</span>&gt;</span></span><br><span class="line">             <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"org-detail-homepage.html"</span>&gt;</span></span><br><span class="line">                 <span class="tag">&lt;<span class="name">h1</span>&gt;</span>&#123;&#123; org.name &#125;&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">                 <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"pic fl"</span>&gt;</span></span><br><span class="line">                         <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"&#123;% static 'images/authentication.png' %&#125;"</span>/&gt;</span></span><br><span class="line"> </span><br><span class="line">                         <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"&#123;% static 'images/gold.png' %&#125;"</span>/&gt;</span></span><br><span class="line">                 <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">             <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"cont"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"first"</span>&gt;</span><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"pic9"</span>&gt;</span>课程数：<span class="tag">&lt;<span class="name">span</span>&gt;</span>1<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"c7"</span>&gt;</span>学习人数：<span class="tag">&lt;<span class="name">span</span>&gt;</span>1000<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"c8"</span> <span class="attr">style</span>=<span class="string">"padding-left:18px;"</span>&gt;</span>&#123;&#123; org.address &#125;&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"pic10"</span> <span class="attr">style</span>=<span class="string">"padding-left:18px;"</span>&gt;</span>经典课程：</span><br><span class="line">                    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/diary/19/"</span>&gt;</span>c语言基础入门<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/diary/16/"</span>&gt;</span>数据库基础<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dd</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"buy start_groupbuy jsShowPerfect2"</span> <span class="attr">data-id</span>=<span class="string">"22"</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span>联系<span class="tag">&lt;<span class="name">br</span>/&gt;</span>服务<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dl</span>&gt;</span></span><br><span class="line">&#123;%  endfor %&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>刷新页面成功显示模板中打印的动态数据</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190507135839444.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<p><strong>6.</strong>实现页面分页功能</p>
<ul>
<li>安装第三方分页库<a href="https://github.com/jamespacileo/django-pure-pagination" target="_blank" rel="noopener">django-pure-pagination</a>，这个库在是Django本身的Paginator上进行封装的，而之前博主写的<a href="https://blog.csdn.net/qq_41782425/article/details/89015816" target="_blank" rel="noopener">Django电商项目</a>中则使用的是Django本身提供的Paginator进行分页的</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190507140230967.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>添加到settings apps应用中</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">INSTALLED_APPS = (</span><br><span class="line">    ...</span><br><span class="line">    &apos;pure_pagination&apos;,</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<ul>
<li>在视图中进行分页数据处理，之后将分页处理后的数据对象赋值给all_orgs变量，传递给模板</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OrgView</span><span class="params">(View)</span>:</span></span><br><span class="line">    <span class="string">"""课程机构列表页"""</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self, request)</span>:</span></span><br><span class="line">        all_orgs = CourseOrg.objects.all()  <span class="comment"># 课程机构</span></span><br><span class="line">        org_nums = all_orgs.count()  <span class="comment"># 机构数量</span></span><br><span class="line">        all_citys = CityDict.objects.all()  <span class="comment"># 城市</span></span><br><span class="line">        <span class="comment"># 分页处理</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            page = request.GET.get(<span class="string">'page'</span>, <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">except</span> PageNotAnInteger:</span><br><span class="line">            page = <span class="number">1</span></span><br><span class="line">        p = Paginator(all_orgs, <span class="number">5</span>, request=request)</span><br><span class="line">        orgs = p.page(page)</span><br><span class="line">        <span class="keyword">return</span> render(request, <span class="string">"org-list.html"</span>, &#123;<span class="string">"all_orgs"</span>:orgs, <span class="string">"org_nums"</span>:org_nums, <span class="string">"all_citys"</span>:all_citys&#125;)</span><br></pre></td></tr></table></figure>

<ul>
<li>在模板文件中，需要修改机构列表数据遍历对象，因为视图传递过来的all_orgs变量的值为分页数据对象，需要调用object_list方法，获取数据</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% for org in all_orgs.object_list %&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>在模板中打印显示分页信息，看不懂的话可根据django-pure-pagination上的文档进行参考</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"pageturn"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"pagelist"</span>&gt;</span></span><br><span class="line">        &#123;% if all_orgs.has_previous %&#125;</span><br><span class="line">            <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"long"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"?&#123;&#123; all_orgs.previous_page_number.querystring &#125;&#125;"</span>&gt;</span>上一页<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        &#123;% endif %&#125;</span><br><span class="line">        &#123;% for page in all_orgs.pages %&#125;</span><br><span class="line">            &#123;% if page %&#125;</span><br><span class="line">                &#123;% ifequal page all_orgs.number %&#125;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"active"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"?&#123;&#123; page.querystring &#125;&#125;"</span>&gt;</span>&#123;&#123; page &#125;&#125;<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                &#123;% else %&#125;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"?&#123;&#123; page.querystring &#125;&#125;"</span> <span class="attr">class</span>=<span class="string">"page"</span>&gt;</span>&#123;&#123; page &#125;&#125;<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                &#123;% endifequal %&#125;</span><br><span class="line">            &#123;% else %&#125;</span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"none"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span>...<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">            &#123;% endif %&#125;</span><br><span class="line">        &#123;% endfor %&#125;</span><br><span class="line">        &#123;% if all_orgs.has_next %&#125;</span><br><span class="line">            <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"long"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"?&#123;&#123; all_orgs.next_page_number.querystring &#125;&#125;"</span>&gt;</span>下一页<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        &#123;% endif %&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>测试授课机构列表页数据分页显示功能</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190507150215370.gif" alt></fancybox></p>
<p><strong>7.</strong>页面数据筛选功能</p>
<ul>
<li>首选为了方便演示测试，博主这里打算添加各种机构类别的学校数据</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190507163237460.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>在视图中进行地区以及机构内别进行条件筛选逻辑处理，逻辑很简单都是通过获取全部的课程all_orgs，在通过获取的所有授课分别根据城市以及机构条件进行数据筛选操作，最后需要将获取到的请求地址参数传递到模板文件中</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OrgView</span><span class="params">(View)</span>:</span></span><br><span class="line">    <span class="string">"""课程机构列表页"""</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self, request)</span>:</span></span><br><span class="line">        all_orgs = CourseOrg.objects.all()  <span class="comment"># 课程机构</span></span><br><span class="line"> </span><br><span class="line">        all_citys = CityDict.objects.all()  <span class="comment"># 城市</span></span><br><span class="line">        <span class="comment"># 从请求地址中获取city_id</span></span><br><span class="line">        city_id = request.GET.get(<span class="string">"city"</span>, <span class="string">""</span>)</span><br><span class="line">        <span class="comment"># 城市筛选</span></span><br><span class="line">        <span class="keyword">if</span> city_id:</span><br><span class="line">            all_orgs = all_orgs.filter(city_id=int(city_id))  <span class="comment"># 需要注意的是models中并没有定义city_id字段，但数据库显示为此字段</span></span><br><span class="line"> </span><br><span class="line">        <span class="comment"># 机构类别筛选</span></span><br><span class="line">        category = request.GET.get(<span class="string">"ct"</span>, <span class="string">""</span>)</span><br><span class="line">        <span class="keyword">if</span> category:</span><br><span class="line">            <span class="comment"># 将过滤查询后的结果赋值给all_orgs变量，在分页处理逻辑中根据此变量的数据进行分页处理，如果category的值不存在，就按照CourseOrg数据表的所有数据进行分页处理，此说明针对逻辑理解力差的朋友</span></span><br><span class="line">            all_orgs = all_orgs.filter(category=category)</span><br><span class="line">        </span><br><span class="line">        org_nums = all_orgs.count()  <span class="comment"># 机构数量</span></span><br><span class="line">        <span class="comment"># 分页处理</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            page = request.GET.get(<span class="string">'page'</span>, <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">except</span> PageNotAnInteger:</span><br><span class="line">            page = <span class="number">1</span></span><br><span class="line">        p = Paginator(all_orgs, <span class="number">5</span>, request=request)</span><br><span class="line">        orgs = p.page(page)</span><br><span class="line">        <span class="keyword">return</span> render(request, <span class="string">"org-list.html"</span>, &#123;<span class="string">"all_orgs"</span>:orgs, <span class="string">"org_nums"</span>:org_nums, <span class="string">"all_citys"</span>:all_citys</span><br><span class="line">                                                 , <span class="string">"city_id"</span>:city_id, <span class="string">"category"</span>:category&#125;)</span><br></pre></td></tr></table></figure>

<ul>
<li>在模板文件中首先根据后端传递过来的参数是否存在来判断筛选条件中按钮是否为激活状态，请求地址都为?xxxx，表示当前地址上添加筛选条件参数，即调用同一视图OrgView</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">h2</span>&gt;</span>机构类别<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"cont"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"?city="</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"&#123;% if not category %&#125;active2&#123;% endif %&#125;"</span>&gt;</span>全部<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"?ct=pxjg"</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"&#123;% if category == 'pxjg' %&#125;active2&#123;% endif %&#125;"</span>&gt;</span>培训机构<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"?ct=gx"</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"&#123;% if category == 'gx' %&#125;active2&#123;% endif %&#125;"</span>&gt;</span>高校<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"?ct=gr"</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"&#123;% if category == 'gr' %&#125;active2&#123;% endif %&#125;"</span>&gt;</span>个人<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">h2</span>&gt;</span>所在地区<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"more"</span>&gt;</span>更多<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"cont"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"?city="</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"&#123;% if not city_id %&#125;active2&#123;% endif %&#125;"</span>&gt;</span>全部<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        &#123;% for city in all_citys %&#125;</span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"?city=&#123;&#123; city.id &#125;&#125;"</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"&#123;% if city.id|stringformat:"</span><span class="attr">i</span>" == <span class="string">city_id</span> %&#125;<span class="attr">active2</span>&#123;% <span class="attr">endif</span> %&#125;"&gt;</span>&#123;&#123; city.name &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        &#123;% endfor %&#125;</span><br><span class="line">	<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>测试授课机构列表页条件筛选功能</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190507171644393.gif" alt></fancybox></p>
<ul>
<li><p>问题：<font style="color:red">当筛选条件为城市时，再点击机构类别时，则城市筛选条件会清空，反之当筛选条件为机构类别时，再点击城市，则机构类别变为全部；导致这种情况的原因是筛选条件的链接地址，不管点击机构类别还是城市时，都只会按照各自定义的链接进行跳转，即刷新页面，而导致重置之前选中的筛选条件</font></p>
</li>
<li><p>解决方法：<font style="color:red">修改模板中筛选条件的url地址，这里稍微比较绕，给机构类别筛选条件url地址添加城市筛选条件地址，也就是city=city_id，反之城市筛选条件url地址也添加机构类别的筛选条件地址，这样做的逻辑为当点击机构类别筛选条件时附带city的参数，在此条件下再选择城市条件时，则会给当前地址city参数赋值，反之道理也一样</font>，例如：<a href="http://127.0.0.1:8000/org_list/?city=2&ct=pxjg" target="_blank" rel="noopener">http://127.0.0.1:8000/org_list/?city=2&amp;ct=pxjg</a></p>
</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">h2</span>&gt;</span>机构类别<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"cont"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"?city=&#123;&#123; city_id &#125;&#125;"</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"&#123;% if not category %&#125;active2&#123;% endif %&#125;"</span>&gt;</span>全部<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"?ct=pxjg&amp;city=&#123;&#123; city_id &#125;&#125;"</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"&#123;% if category == 'pxjg' %&#125;active2&#123;% endif %&#125;"</span>&gt;</span>培训机构<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"?ct=gx&amp;city=&#123;&#123; city_id &#125;&#125;"</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"&#123;% if category == 'gx' %&#125;active2&#123;% endif %&#125;"</span>&gt;</span>高校<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"?ct=gr&amp;city=&#123;&#123; city_id &#125;&#125;"</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"&#123;% if category == 'gr' %&#125;active2&#123;% endif %&#125;"</span>&gt;</span>个人<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">h2</span>&gt;</span>所在地区<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"more"</span>&gt;</span>更多<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"cont"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"?ct=&#123;&#123; category &#125;&#125;"</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"&#123;% if not city_id %&#125;active2&#123;% endif %&#125;"</span>&gt;</span>全部<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        &#123;% for city in all_citys %&#125;</span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"?city=&#123;&#123; city.id &#125;&#125;&amp;ct=&#123;&#123; category &#125;&#125;"</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"&#123;% if city.id|stringformat:"</span><span class="attr">i</span>" == <span class="string">city_id</span> %&#125;<span class="attr">active2</span>&#123;% <span class="attr">endif</span> %&#125;"&gt;</span>&#123;&#123; city.name &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        &#123;% endfor %&#125;</span><br><span class="line">	<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>再次测试授课机构列表页条件筛选功能（注意浏览器地址变化）</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190507174450410.gif" alt></fancybox></p>
<p><strong>8.</strong>授课机构排名</p>
<ul>
<li>在类视图get方法中通过模型表点击量字段进行倒序排序并且只取前三个授课机构信息</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 授课机构排名</span></span><br><span class="line">hot_orgs = all_orgs.order_by(<span class="string">"-click_nums"</span>)[:<span class="number">3</span>]</span><br></pre></td></tr></table></figure>

<ul>
<li>在模板中找到授课机构排名，进行数据打印显示</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"right companyrank layout"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"head"</span>&gt;</span>授课机构排名<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        &#123;% for hot_org in hot_orgs %&#125;</span><br><span class="line">        <span class="tag">&lt;<span class="name">dl</span> <span class="attr">class</span>=<span class="string">"des"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dt</span> <span class="attr">class</span>=<span class="string">"num fl"</span>&gt;</span>&#123;&#123; forloop.counter &#125;&#125;<span class="tag">&lt;/<span class="name">dt</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dd</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/company/2/"</span>&gt;</span><span class="tag">&lt;<span class="name">h1</span>&gt;</span>&#123;&#123; hot_org.name &#125;&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123; hot_org.address &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dd</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dl</span>&gt;</span></span><br><span class="line">        &#123;% endfor %&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>测试显示授课机构排名</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190507182018472.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<p><strong>9.</strong>授课机构排序</p>
<ul>
<li>分析：从授课机构列表中可以看到排序按照学习人数和课程数这两个条件进行排序的</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190507182429877.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>因为当初定义数据模型类时，未定义这两个字段，所以需要在models进行添加</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">students = models.IntegerField(default=<span class="number">0</span>, verbose_name=<span class="string">u"学习人数"</span>)</span><br><span class="line">course_nums = models.IntegerField(default=<span class="number">0</span>, verbose_name=<span class="string">u"课程数"</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li>生成对应数据表字段</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190507182755667.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>在视图中获取数据库中授课机构所有信息，并对获取的信息按照学习人数和课程数进行排序（逻辑与筛选功能一致）</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 授课机构排序</span></span><br><span class="line">sort = request.GET.get(<span class="string">"sort"</span>, <span class="string">""</span>)</span><br><span class="line"><span class="keyword">if</span> sort:</span><br><span class="line">    <span class="keyword">if</span> sort == <span class="string">"students"</span>:</span><br><span class="line">        all_orgs = all_orgs.order_by(<span class="string">"-students"</span>)</span><br><span class="line">    <span class="keyword">elif</span> sort == <span class="string">"courses"</span>:</span><br><span class="line">        all_orgs = all_orgs.order_by(<span class="string">"-course_nums"</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li>回到模板文件中进行判断显示激活active样式，以及定义排序条件url链接地址，添加筛选条件参数（逻辑与筛选功能一致，不再重述）</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"head"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"tab_header"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"&#123;% if not sort %&#125;active&#123;% endif %&#125;"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"?ct=&#123;&#123; category &#125;&#125;&amp;city=&#123;&#123; city_id &#125;&#125;"</span>&gt;</span>全部<span class="tag">&lt;/<span class="name">a</span>&gt;</span> <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"&#123;% if sort == 'students' %&#125;active&#123;% endif %&#125;"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"?sort=students&amp;ct=&#123;&#123; category &#125;&#125;&amp;city=&#123;&#123; city_id &#125;&#125;"</span>&gt;</span>学习人数 &amp;#8595;<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"&#123;% if sort == 'courses' %&#125;active&#123;% endif %&#125;"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"?sort=courses&amp;ct=&#123;&#123; category &#125;&#125;&amp;city=&#123;&#123; city_id &#125;&#125;"</span>&gt;</span>课程数 &amp;#8595;<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>测试授课机构排序功能（注意浏览器地址变化）</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190507184824603.gif" alt></fancybox></p>
<h1 id="二丶授课机构（用户咨询）"><a href="#二丶授课机构（用户咨询）" class="headerlink" title="二丶授课机构（用户咨询）"></a>二丶授课机构（用户咨询）</h1><p><strong>1.</strong><font style="color:red">使用modelform对表单进行验证和保存</font>来完成咨询功能</p>
<ul>
<li>在授课机构列表页中如下图所示有个立即咨询功能</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190507194849121.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>立即咨询功能<font style="color:red">说白了就是表单数据的提交，设计到表单验证操作，按照之前users应用中表单的操作，定义表单类继承与forms.Form来完成表单的验证，但是这样定义表单的验证缺点比较多，例如：与模型类中的代码重复性高，并且此方式并不能保存表单的数据，所以在实现咨询功能时，定义的表单类不继承与forms.Form而是继承于forms.ModelForm，只需要在定义Meta类中指定要验证的模型类以及模型类中的字段，即可完整表单的验证及保存</font>，在organization目录下创建forms.py模块，咋forms中定义表单验证类</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">class UserAskFrom(forms.Form):</span></span><br><span class="line"><span class="string">    name = forms.CharField(required=True, min_length=2, max_length=10)  # 姓名</span></span><br><span class="line"><span class="string">    mobile = forms.CharField(required=True, min_length=11, max_length=11)  # 手机</span></span><br><span class="line"><span class="string">    course_name = forms.CharField(required=True)  # 课程名</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserAskForm</span><span class="params">(forms.ModelForm)</span>:</span></span><br><span class="line">    <span class="string">"""用户咨询"""</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">        model = UserAsk</span><br><span class="line">        fields = [<span class="string">"name"</span>, <span class="string">"mobile"</span>, <span class="string">"course_name"</span>]  <span class="comment"># 只保留想要的模型中的字段</span></span><br></pre></td></tr></table></figure>

<ul>
<li>在所有的应用目录下创建urls.py文件，用于完成页面中功能的路由，需要说明的是在本项目创建的app应用中没有生产urls.py文件，而在之前的Django项目中使用命令创建的应用时包含此文件的，然后在organization/urls中进行编写咨询功能路由</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">urlpatterns = [</span><br><span class="line">    url(<span class="string">r'^list/$'</span>, OrgView.as_view(), name=<span class="string">"org_list"</span>),  <span class="comment"># 课程机构列表页</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<ul>
<li>紧接着在根级的urls中需要定义将应用organization下的urls包含进来，这样就很之前Django电商项目配置一样了</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url(<span class="string">r'org/'</span>, include(<span class="string">'organization.urls'</span>, namespace=<span class="string">"org"</span>)),  <span class="comment"># 应用organization下的urls</span></span><br></pre></td></tr></table></figure>

<ul>
<li>此时授课机构列表页的链接地址就不再是<a href="http://127.0.0.1:8000/org_list/" target="_blank" rel="noopener">http://127.0.0.1:8000/org_list/</a> 而是<a href="http://127.0.0.1:8000/org/list/" target="_blank" rel="noopener">http://127.0.0.1:8000/org/list/</a> 了，并且在index模板中需要修改授课机构列表页面的链接地址，也就是之前Django 电商项目说的反向解析</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">li</span> &gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&#123;% url 'org:org_list' %&#125;"</span>&gt;</span>授课机构<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>测试访问<a href="http://127.0.0.1:8000/org/list/" target="_blank" rel="noopener">http://127.0.0.1:8000/org/list/</a> 授课机构列页面</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190507203742891.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<p><strong>2.</strong><font style="color:red">再次说明</font>：此做法与之前的Django项目一样，在根级urls中匹配地址后，将所有应用下的的urls路由包含进去，例如本项目中的captcha验证码一样url(r’captcha/‘,include(‘captcha.urls’))，理解此路由就是只要匹配captcha规则的请求，通通的进入到captcha.urls中进行匹配调用，如下图流程</p>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190507202228868.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li><p>分析授课机构列表页中的我要学习咨询功能，当用户点击立即咨询按钮时则应该页面不进行任何跳转，并且是异步执行的过程，所以这里在前端模板中使用ajax方式进行异步请求 </p>
</li>
<li><p>在organization/views中定义用户咨询类视图，返回响应的浏览器协议格式的数据</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AddUserAskView</span><span class="params">(View)</span>:</span></span><br><span class="line">    <span class="string">"""添加用户咨询"""</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">post</span><span class="params">(self, request)</span>:</span></span><br><span class="line">        userask_form = UserAskForm(request.POST)</span><br><span class="line">        <span class="keyword">if</span> userask_form.is_valid():</span><br><span class="line">            user_ask = userask_form.save(commit=<span class="literal">True</span>)  <span class="comment"># 设置自动保存数据到数据库，就不用像之前的表单验证模型那样</span></span><br><span class="line">            <span class="keyword">return</span> HttpResponse(<span class="string">'&#123;"status":"success"&#125;'</span>, content_type=<span class="string">'application/json'</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> HttpResponse(<span class="string">'&#123;"status":"fail", "msg":"咨询失败"&#125;'</span>, content_type=<span class="string">'application/json'</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li>在父模板文件中需要在底部进行挖坑（block custom_js），并在子模板org-list中填充js数据，并进行如下编写（博主全方面注释）</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&#123;% block custom_js %&#125;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">$(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    $(<span class="string">'#jsStayBtn'</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        &#123;#alert(222);#&#125;</span><br><span class="line">        $.ajax(&#123;</span><br><span class="line">            cache: false,  &#123;#禁用缓存#&#125;</span><br><span class="line">            type: "POST",  &#123;#请求方式#&#125;</span><br><span class="line">            url: "&#123;% url 'org:add_ask' %&#125;",  &#123;#请求地址#&#125;</span><br><span class="line">            data: $('#jsStayForm').serialize(), &#123;#序列化表单内容#&#125;</span><br><span class="line">            async: true,  &#123;#异步请求方式#&#125;</span><br><span class="line">            success: function (data) &#123;  &#123;#发送请求成功回调函数，接收后端响应数据data#&#125;</span><br><span class="line">                &#123;#alert(1111);#&#125;</span><br><span class="line">                <span class="keyword">if</span> (data.status == <span class="string">'success'</span>) &#123;</span><br><span class="line">                    &#123;# 重置表单#&#125;</span><br><span class="line">                    $(<span class="string">'#jsStayForm'</span>)[<span class="number">0</span>].reset();</span><br><span class="line">                    alert(<span class="string">"提交成功"</span>)</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (data.status == <span class="string">'fail'</span>) &#123;</span><br><span class="line">                    &#123;#alert(111);#&#125;</span><br><span class="line">                    &#123;# 将错误信息条件到id=jsCompanyTips的标签内容中 #&#125;</span><br><span class="line">                    $(<span class="string">'#jsCompanyTips'</span>).html(data.msg)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line"> &#125;)</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br><span class="line"><span class="regexp">&#123;% endblock %&#125;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>Debug测试咨询功能（空表单进行提交）</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190508101625485.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>当Debug测试完毕后，查看页面提示信息，以及后端响应前端页面数据</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190508101707181.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>Debug测试咨询功能（填写完整数据进行提交）</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190508103422343.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>Debug断点完成后，页面打印出提交成功，点击确定后，查看后端返回的响应数据为success</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190508103536788.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>查看数据operation_userask表信息，成功通过ajax异步提交的表单数据保存到响应的数据表中</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/2019050810384859.png" alt></p>
<ul>
<li>完善咨询功能，判断用户输入的手机号码是否合法，在forms表单验证类中直接forms.ModelFrom提供的clean方法，后面跟字段明，必须是该写法， 在clean_mobile方法中使用正则匹配进行判断，并返回正确结果或者错误提示</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserAskForm</span><span class="params">(forms.ModelForm)</span>:</span></span><br><span class="line">    <span class="string">"""用户咨询"""</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">        model = UserAsk</span><br><span class="line">        fields = [<span class="string">"name"</span>, <span class="string">"mobile"</span>, <span class="string">"course_name"</span>]  <span class="comment"># 只保留想要的模型中的字段</span></span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">clean_mobile</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""验证手机号码是否合法"""</span></span><br><span class="line">        mobile = self.cleaned_data[<span class="string">'mobile'</span>]</span><br><span class="line">        REGEX_MOBILE = <span class="string">"^1[358]\d&#123;9&#125;$|^147\d&#123;8&#125;$|^176\d&#123;8&#125;$|^177\d&#123;8&#125;$|^199\d&#123;8&#125;$"</span></span><br><span class="line">        p = re.compile(REGEX_MOBILE)  </span><br><span class="line">        <span class="keyword">if</span> p.match(mobile):</span><br><span class="line">            <span class="keyword">return</span> mobile</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">raise</span> forms.ValidationError(<span class="string">u"手机号码非法"</span>, code=<span class="string">"mobile_invalid"</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li>Debug测试（输入不合法的手机号）</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190508105327484.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<h1 id="三丶授课机构（详情页）"><a href="#三丶授课机构（详情页）" class="headerlink" title="三丶授课机构（详情页）"></a>三丶授课机构（详情页）</h1><p><strong>1.</strong>机构详情页面展示</p>
<ul>
<li>说明：当用户在授课机构列表页中点击机构即进入机构详情页面</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190508110534905.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li><p>说明：在以上页面中需要讲师以及课程的数据，所以需要在xadmin后台进行数据添加</p>
</li>
<li><p>在xadmin后台机构管理中添加教师模型表数据</p>
</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190508114642197.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>在xadmin后台课程管理中添加课程模型表数据，但是发现该课程表未与课程机构表关联，无法选择课程机构</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190508115915868.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>即所以在课程管理course/models中在课程表模型类中定义外键，并且允许为空，因为在搭建后台管理系统的时候已经存在一条数据了</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">course_org = models.ForeignKey(CourseOrg, verbose_name=<span class="string">u"课程机构"</span>, null=<span class="literal">True</span>, blank=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li>生成对应数据表字段</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/2019050812093638.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>刷新xadmin后台增加课程页面，则可以选择对应课程的课程机构了</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190508121425730.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190508145652612.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>将机构详情页面所需要的模板文件拷贝到templates模板目录下，总共有4个模板（org-detail-course，org-detail-desc，org-detail-homepage，org-detail-teachers）分析页面得知，这四个页面除了各自内容不同其他均一样，所以需要将共有的部分单独放到一个模板中，即利用模板继承</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/2019050812371211.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>在template是目录下新建org_base.html模板，将org-detail-homepage.html或者其他三个模板的数据拷贝到org_base模板中，然后在org_base模板中进行如下数据块挖坑，通俗来说将是将四个页面不同的地方进行挖坑</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190508134159313.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>在模板org-detail-homepage中继承与父模板org_base，并进行独有数据块填充</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/20190508134407258.png" alt></p>
<ul>
<li>在organization/views中定义类视图post方法，用于获取机构详情首页中页面数据</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OrgHomeView</span><span class="params">(View)</span>:</span></span><br><span class="line">    <span class="string">"""机构首页"""</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self, request, org_id)</span>:</span></span><br><span class="line">        course_org = CourseOrg.objects.get(id=int(org_id))  <span class="comment"># 获取课程机构信息</span></span><br><span class="line">        <span class="comment"># 根据Course表的外键关联CourseOrg表通过django提供的course_set方法来获取Course表的课程所有信息</span></span><br><span class="line">        <span class="comment"># 并不是所有课程，而是一个课程的所有信息</span></span><br><span class="line">        all_courses = course_org.course_set.all()[:<span class="number">3</span>]</span><br><span class="line">        <span class="comment"># 同理根据Teachers表的外键关联CourseOrg表通过teacher_set方法获取Teachers表的教师所有信息</span></span><br><span class="line">        <span class="comment"># 并不是所有教师，而是一个教师的所有信息</span></span><br><span class="line">        all_teachers = course_org.teacher_set.all()[:<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">return</span> render(request, <span class="string">"org-detail-homepage.html"</span>, &#123;<span class="string">"all_courses"</span>:all_courses, <span class="string">"all_teachers"</span>:all_teachers</span><br><span class="line">                                                            ,<span class="string">"course_org"</span>:course_org&#125;)</span><br></pre></td></tr></table></figure>

<ul>
<li>在urls中定义机构详情首页路由</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url(<span class="string">r'^home/(?P&lt;org_id&gt;\d+)$'</span>, OrgHomeView.as_view(), name=<span class="string">"org_home"</span>),  <span class="comment"># 机构首页</span></span><br></pre></td></tr></table></figure>

<ul>
<li>在org-detail-homepage模板中打印显示页面数据</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"brief group_list"</span>&gt;</span></span><br><span class="line">&#123;%  for course in all_courses %&#125;</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"module1_5 box"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"course-detail.html"</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">width</span>=<span class="string">"214"</span> <span class="attr">src</span>=<span class="string">"&#123;&#123; MEDIA_URL &#125;&#125;&#123;&#123; course.image &#125;&#125;"</span>/&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"des"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"course-detail.html"</span>&gt;</span><span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;&#123; course.name &#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"fl"</span>&gt;</span>课时：<span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"key"</span>&gt;</span>&#123;&#123; course.learn_times &#125;&#125;<span class="tag">&lt;/<span class="name">i</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"fr"</span>&gt;</span>参加人数：&#123;&#123; course.students &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"bottom"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"fl"</span>&gt;</span>&#123;&#123; course.course_org.name &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"star fr  notlogin</span></span></span><br><span class="line"><span class="tag"><span class="string">            "</span> <span class="attr">data-favid</span>=<span class="string">"13"</span> <span class="attr">data-fav-type</span>=<span class="string">"4"</span>&gt;</span></span><br><span class="line">            &#123;&#123; course.fav_nums &#125;&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>在父模板org_base中打印显示出机构名称以及机构logo图片</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"wp"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">"fl"</span> <span class="attr">style</span>=<span class="string">"width: 112px;height: 103px"</span> <span class="attr">src</span>=<span class="string">"&#123;&#123; MEDIA_URL &#125;&#125;&#123;&#123; course_org.image &#125;&#125;"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"head fl"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span></span><br><span class="line">            &#123;&#123; course_org.name &#125;&#125;</span><br><span class="line">            <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"&#123;% static 'images/authentication.png' %&#125;"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"&#123;% static 'images/gold.png' %&#125;"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"fl"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"fl"</span> <span class="attr">style</span>=<span class="string">"margin-top:8px;color:#848484;"</span>&gt;</span>推荐指数： <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"precision company-credit"</span> <span class="attr">data-star-scope</span>=<span class="string">"5.0"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"key"</span>&gt;</span>5.0<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"btn fr collectionbtn  notlogin</span></span></span><br><span class="line"><span class="tag"><span class="string"> "</span> <span class="attr">data-favid</span>=<span class="string">"22"</span> <span class="attr">data-fav-type</span>=<span class="string">"1"</span>&gt;</span></span><br><span class="line">        收藏</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>测试机构详情首页数据显示</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190508160931436.gif" alt></fancybox></p>
<ul>
<li>在机构详情首页中需要对机构教师进行打印显示，则需要在xadmin管理后台上传头像，在前面添加讲师时，并没有图片字段，所以老规矩在models中定义Teacher模型的image字段，并生成数据表，最后在xadmin后台中添加教师头像即可</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">image = models.ImageField(default=<span class="string">''</span>, upload_to=<span class="string">"teacher/%Y/%m"</span>, verbose_name=<span class="string">u"头像"</span>, max_length=<span class="number">100</span>)</span><br></pre></td></tr></table></figure>

<p><fancybox><img src="https://img-blog.csdnimg.cn/20190508161615985.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>在org-detail-homepage模板中打印显示机构教师以及机构介绍</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&#123;% for teacher in all_teachers %&#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"diarys"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"module5 share company-diary-box"</span> <span class="attr">style</span>=<span class="string">"padding:10px 0;"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"left"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">"pic"</span> <span class="attr">src</span>=<span class="string">"&#123;&#123; MEDIA_URL &#125;&#125;&#123;&#123; teacher.image &#125;&#125;"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">p</span>&gt;</span>昵称：&#123;&#123; teacher.name &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"right"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"top"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"fl"</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Java开发教程<span class="tag">&lt;/<span class="name">h1</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">span</span>&gt;</span>发表于：2017-11-12<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"middle"</span> <span class="attr">style</span>=<span class="string">"border-bottom:0; "</span>&gt;</span>课程介绍</span><br><span class="line">                <span class="tag">&lt;<span class="name">p</span> <span class="attr">style</span>=<span class="string">"font-size: 16px"</span>&gt;</span>1.java基础 2.java进阶 3.java高级<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">&#123;%  endfor %&#125;</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"cont"</span>&gt;</span>&amp;nbsp; &amp;nbsp;&#123;&#123; course_org.desc &#125;&#125;<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/company/desc/22/"</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"green"</span>&gt;</span>[查看更多]<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>刷新页面成功显示出机构教师以及机构介绍数据</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190508171228392.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<p><strong>2.</strong>机构课程列表页数据显示</p>
<ul>
<li>整个逻辑跟机构首页一样，首先就是完成模板的继承，这个就不在细说了，然后定义类视图get方法，获取课程表数据并传递给前端模板，在页面左侧栏，需要通过后端传递current_page变量的值来判断是否激活，并且修改父模板中的左侧栏的链接地址</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OrgCourseView</span><span class="params">(View)</span>:</span></span><br><span class="line">    <span class="string">"""机构课程页"""</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self, request, org_id)</span>:</span></span><br><span class="line">        current_page = <span class="string">"course"</span></span><br><span class="line">        course_org = CourseOrg.objects.get(id=int(org_id))  <span class="comment"># 获取课程机构信息</span></span><br><span class="line">        <span class="comment"># 根据Course表的外键关联CourseOrg表通过django提供的course_set方法来获取Course表的课程所有信息</span></span><br><span class="line">        <span class="comment"># 并不是所有课程，而是一个课程的所有信息</span></span><br><span class="line">        all_courses = course_org.course_set.all()</span><br><span class="line">        <span class="keyword">return</span> render(request, <span class="string">"org-detail-course.html"</span>, &#123;<span class="string">"all_courses"</span>:all_courses,<span class="string">"course_org"</span>:course_org</span><br><span class="line">                                                          ,<span class="string">"current_page"</span>:current_page&#125;)</span><br></pre></td></tr></table></figure>

<ul>
<li>定义url路由</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url(<span class="string">r'^course/(?P&lt;org_id&gt;\d+)$'</span>, OrgCourseView.as_view(), name=<span class="string">"org_course"</span>),  <span class="comment"># 机构课程页</span></span><br></pre></td></tr></table></figure>

<ul>
<li>在机构课程列表页模板org-detail-course中打印显示页面数据</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"brief group_list"</span>&gt;</span></span><br><span class="line">    &#123;%  for course in all_courses %&#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"module1_5 box"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"comp-img-box"</span> <span class="attr">href</span>=<span class="string">"course-detail.html"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">            <span class="tag">&lt;<span class="name">img</span> <span class="attr">width</span>=<span class="string">"214"</span> <span class="attr">height</span>=<span class="string">"195"</span> <span class="attr">src</span>=<span class="string">"&#123;&#123; MEDIA_URL &#125;&#125;&#123;&#123; course.image &#125;&#125;"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"des"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"course-detail.html"</span>&gt;</span><span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;&#123; course.name &#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"fl"</span>&gt;</span>课时：<span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"key"</span>&gt;</span>&#123;&#123; course.learn_times &#125;&#125;<span class="tag">&lt;/<span class="name">i</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"fr"</span>&gt;</span>学习人数：&#123;&#123; course.students &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"bottom"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"fl"</span>&gt;</span>&#123;&#123; course.course_org.name &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">             <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"star fr  notlogin</span></span></span><br><span class="line"><span class="tag"><span class="string">                "</span> <span class="attr">data-favid</span>=<span class="string">"13"</span> <span class="attr">data-fav-type</span>=<span class="string">"4"</span>&gt;</span></span><br><span class="line">                &#123;&#123; course.fav_nums &#125;&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    &#123;% endfor %&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>在父模板org_base中修改详情页左侧栏菜单链接地址</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"left"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"&#123;% if current_page == 'home' %&#125;active2&#123;% endif %&#125;"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&#123;% url 'org:org_home' course_org.id %&#125;"</span>&gt;</span>机构首页<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"&#123;% if current_page == 'course' %&#125;active2&#123;% endif %&#125;"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&#123;% url 'org:org_course' course_org.id %&#125;"</span>&gt;</span>机构课程<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"&#123;% if current_page == 'desc' %&#125;active2&#123;% endif %&#125;"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"org-detail-desc.html"</span>&gt;</span>机构介绍<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"&#123;% if current_page == 'teacher' %&#125;active2&#123;% endif %&#125;"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"org-detail-teachers.html"</span>&gt;</span>机构讲师<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>测试左侧菜单激活并跳转到正确页面以及显示课程机构列表页数据</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190508180457778.gif" alt></fancybox></p>
<p><strong>3.</strong>机构介绍页面以及机构讲师页面数据显示</p>
<p><strong>说明：</strong>这两个页面都很简单逻辑与前面两个机构首页机构课程一样，就不细说了</p>
<ul>
<li>定义类视图</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OrgDescView</span><span class="params">(View)</span>:</span></span><br><span class="line">    <span class="string">"""机构介绍页"""</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self, request, org_id)</span>:</span></span><br><span class="line">        current_page = <span class="string">"desc"</span></span><br><span class="line">        course_org = CourseOrg.objects.get(id=int(org_id))  <span class="comment"># 获取课程机构信息</span></span><br><span class="line">        <span class="keyword">return</span> render(request, <span class="string">"org-detail-desc.html"</span>, &#123;<span class="string">"course_org"</span>:course_org</span><br><span class="line">                                                          ,<span class="string">"current_page"</span>:current_page&#125;)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OrgTeacherView</span><span class="params">(View)</span>:</span></span><br><span class="line">    <span class="string">"""教师列表页"""</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self, request, org_id)</span>:</span></span><br><span class="line">        current_page = <span class="string">"teacher"</span></span><br><span class="line">        course_org = CourseOrg.objects.get(id=int(org_id))  <span class="comment"># 获取课程机构信息</span></span><br><span class="line">        <span class="comment"># 根据Course表的外键关联CourseOrg表通过django提供的course_set方法来获取Course表的课程所有信息</span></span><br><span class="line">        <span class="comment"># 并不是所有课程，而是一个课程的所有信息</span></span><br><span class="line">        all_teachers = course_org.teacher_set.all()</span><br><span class="line">        <span class="keyword">return</span> render(request, <span class="string">"org-detail-teachers.html"</span>, &#123;<span class="string">"all_teachers"</span>:all_teachers,<span class="string">"course_org"</span>:course_org</span><br><span class="line">                                                          ,<span class="string">"current_page"</span>:current_page&#125;)</span><br></pre></td></tr></table></figure>

<ul>
<li>定义路由</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">url(<span class="string">r'^desc/(?P&lt;org_id&gt;\d+)$'</span>, OrgDescView.as_view(), name=<span class="string">"org_desc"</span>),  <span class="comment"># 机构介绍页</span></span><br><span class="line">url(<span class="string">r'^teacher/(?P&lt;org_id&gt;\d+)$'</span>, OrgTeacherView.as_view(), name=<span class="string">"org_teacher"</span>),  <span class="comment"># 教师列表页</span></span><br></pre></td></tr></table></figure>

<ul>
<li>对应的模板文件继承于org_base模板，只需要重写right_form数据库块内容即可，前面两个模板中并没有去重写bread_title数据块，博主在写完后面两个模板就已经给补充了，这里演示org-detail-teacher模板即可</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">&#123;% extends 'org_base.html' %&#125;</span><br><span class="line">&#123;% load staticfiles %&#125;</span><br><span class="line">&#123;% block title %&#125;慕课网教师列表 - 慕学网&#123;% endblock %&#125;</span><br><span class="line">&#123;% block bread_title %&#125;机构讲师&#123;% endblock %&#125;</span><br><span class="line">&#123;% block right_form %&#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"right companycenter layout"</span> &gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"head"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">h1</span>&gt;</span>机构讲师<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"messagelist"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">" butler_list butler-fav-box"</span>&gt;</span></span><br><span class="line">                &#123;% for teacher in all_teachers %&#125;</span><br><span class="line">                <span class="tag">&lt;<span class="name">dl</span> <span class="attr">class</span>=<span class="string">"des users"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">dt</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">img</span> <span class="attr">width</span>=<span class="string">"100"</span> <span class="attr">height</span>=<span class="string">"100"</span> <span class="attr">class</span>=<span class="string">"scrollLoading"</span> <span class="attr">src</span>=<span class="string">"&#123;&#123; MEDIA_URL &#125;&#125;&#123;&#123; teacher.image &#125;&#125;"</span>/&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">dt</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">dd</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">h1</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span></span><br><span class="line">                            &#123;&#123; teacher.name &#125;&#125;<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"key"</span>&gt;</span>已认证<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"cont clearfix"</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"time"</span>&gt;</span>工作年限：<span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;&#123; teacher.work_years &#125;&#125;年<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"c7"</span>&gt;</span>课程数：<span class="tag">&lt;<span class="name">span</span>&gt;</span>3<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">dd</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">dl</span>&gt;</span></span><br><span class="line">                &#123;% endfor %&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">&#123;% endblock %&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>在父模板org_base中完善详情页左侧栏菜单链接地址</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"&#123;% if current_page == 'home' %&#125;active2&#123;% endif %&#125;"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&#123;% url 'org:org_home' course_org.id %&#125;"</span>&gt;</span>机构首页<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"&#123;% if current_page == 'course' %&#125;active2&#123;% endif %&#125;"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&#123;% url 'org:org_course' course_org.id %&#125;"</span>&gt;</span>机构课程<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"&#123;% if current_page == 'desc' %&#125;active2&#123;% endif %&#125;"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&#123;% url 'org:org_desc' course_org.id %&#125;"</span>&gt;</span>机构介绍<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"&#123;% if current_page == 'teacher' %&#125;active2&#123;% endif %&#125;"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&#123;% url 'org:org_teacher' course_org.id %&#125;"</span>&gt;</span>机构讲师<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>测试机构详情页四个页面数据</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190508194019192.gif" alt></fancybox></p>
<h1 id="四丶授课机构（用户收藏）"><a href="#四丶授课机构（用户收藏）" class="headerlink" title="四丶授课机构（用户收藏）"></a>四丶授课机构（用户收藏）</h1><p><strong>1.</strong>课程机构收藏功能实现</p>
<p><strong>分析：</strong>该功能跟咨询功能一样使用ajax异步向后端接口发送请求的，当收藏功能显示收藏字段时，用户点击收藏，则该功能按钮显示已收藏，反之表示取消收藏，则该功能内容显示为收藏；在后端逻辑中如果在数据库中根据用户id和fav_id以及fav_type能查询到数据，则表示用户是想取消收藏，反之查询不到则表示用户想收藏</p>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190510175044696.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>定义收藏及取消功能视图</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AddFavView</span><span class="params">(View)</span>:</span></span><br><span class="line">    <span class="string">"""用户收藏以及取消收藏课程机构"""</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">post</span><span class="params">(self, request)</span>:</span></span><br><span class="line">        <span class="comment"># 获取请求中的参数</span></span><br><span class="line">        fav_id = request.POST.get(<span class="string">'fav_id'</span>, <span class="number">0</span>)</span><br><span class="line">        fav_type = request.POST.get(<span class="string">'fav_type'</span>, <span class="number">0</span>)</span><br><span class="line">        <span class="comment"># 跟在index模板中判断用户登录使用django提供的is_authenticated方法进行判断</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> request.user.is_authenticated():</span><br><span class="line">            <span class="comment"># 用户未登录的返回错误响应</span></span><br><span class="line">            <span class="keyword">return</span> HttpResponse(<span class="string">'&#123;"status":"fail", "msg":"用户未登录"&#125;'</span>, content_type=<span class="string">'application/json'</span>)</span><br><span class="line">        <span class="comment"># 用户存在则在UserFavorite表中根据当前用户对象和fav_id以及fav_type字段查询该条记录</span></span><br><span class="line">        exist_records = UserFavorite.objects.filter(user=request.user, fav_id=int(fav_id), fav_type=int(fav_type))</span><br><span class="line">        <span class="keyword">if</span> exist_records:</span><br><span class="line">            <span class="comment"># 如果记录存在，表示用户是想取消收藏，则删除此记录</span></span><br><span class="line">            exist_records.delete()</span><br><span class="line">            <span class="comment"># 返回正确状态，以及收藏消息，该‘收藏’用于显示收藏按钮标签中的内容</span></span><br><span class="line">            <span class="keyword">return</span> HttpResponse(<span class="string">'&#123;"status":"success", "msg":"收藏"&#125;'</span>, content_type=<span class="string">'application/json'</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># 判断获取的fav_id以及fav_type不为0，则只能是&gt;0，才表示用户选择</span></span><br><span class="line">            <span class="keyword">if</span> int(fav_id) &gt; <span class="number">0</span> <span class="keyword">and</span> int(fav_type) &gt; <span class="number">0</span> :</span><br><span class="line">                user_fav = UserFavorite()</span><br><span class="line">                <span class="comment"># 保存数据到数据库</span></span><br><span class="line">                user_fav.user = request.user</span><br><span class="line">                user_fav.fav_id = int(fav_id)</span><br><span class="line">                user_fav.fav_type = int(fav_type)</span><br><span class="line">                user_fav.save()</span><br><span class="line">                <span class="keyword">return</span> HttpResponse(<span class="string">'&#123;"status":"success", "msg":"已收藏"&#125;'</span>, content_type=<span class="string">'application/json'</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span> HttpResponse(<span class="string">'&#123;"status":"fail", "msg":"错误收藏"&#125;'</span>, content_type=<span class="string">'application/json'</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li>配置类视图路由</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url(<span class="string">r'^add_fav/$'</span>, AddFavView.as_view(), name=<span class="string">"add_fav"</span>),  <span class="comment"># 用户收藏功能</span></span><br></pre></td></tr></table></figure>

<ul>
<li>因为该功能是4个页面共有的，所以在父模板中定义js代码即可，简单说明一下js代码，点击事件绑定类选择器collectionbtn，调用定义的add_fav函数，这个函数需要接收标签对象，以及后端类视图的参数fav_id以及fav_type，使用ajax post异步向后端接口发送请求，根据后端返回的响应数据msg来判断是取消收藏还是添加收藏以及判断用户的状态，状态未登录则跳转到登录页</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&lt;script type=<span class="string">"text/javascript"</span>&gt;</span><br><span class="line">    <span class="comment">//收藏</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">add_fav</span>(<span class="params">current_elem, fav_id, fav_type</span>) </span>&#123;</span><br><span class="line">        $.ajax(&#123;</span><br><span class="line">            cache: <span class="literal">false</span>,</span><br><span class="line">            type: <span class="string">"POST"</span>,</span><br><span class="line">            url: <span class="string">"/org/add_fav/"</span>,</span><br><span class="line">            data: &#123;<span class="string">'fav_id'</span>: fav_id, <span class="string">'fav_type'</span>: fav_type&#125;,</span><br><span class="line">            <span class="keyword">async</span>: <span class="literal">true</span>,</span><br><span class="line">            beforeSend: <span class="function"><span class="keyword">function</span> (<span class="params">xhr, settings</span>) </span>&#123;</span><br><span class="line">                xhr.setRequestHeader(<span class="string">"X-CSRFToken"</span>, <span class="string">"&#123;&#123; csrf_token &#125;&#125;"</span>);</span><br><span class="line">            &#125;,</span><br><span class="line">            success: <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">                <span class="keyword">if</span> (data.status == <span class="string">'fail'</span>) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (data.msg == <span class="string">'用户未登录'</span>) &#123;</span><br><span class="line">                        <span class="built_in">window</span>.location.href = <span class="string">"/login/"</span>;</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        alert(data.msg)</span><br><span class="line">                    &#125;</span><br><span class="line"> </span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (data.status == <span class="string">'success'</span>) &#123;</span><br><span class="line">                    current_elem.text(data.msg)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    $(<span class="string">'.collectionbtn'</span>).on(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        add_fav($(<span class="keyword">this</span>), &#123;&#123; course_org.id &#125;&#125;, <span class="number">2</span>);</span><br><span class="line">    &#125;);</span><br><span class="line"> </span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>Debug测试收藏功能（用户未登录时）</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/2019050821382827.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>Debug测试收藏功能（用户已登录）</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190508214037837.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>收藏功能展示</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190508214703922.gif" alt></fancybox></p>
<p><strong>2.</strong>完善收藏功能</p>
<p><strong>说明：</strong>当用户点击收藏并且收藏成功时，则功能内容显示为已收藏，但刷新页面就变成了收藏，实际数据库userfavorite表时存在数据的；因为当前的页面并不知道收藏功能的状态时什么状态</p>
<ul>
<li>在机构详情4个页面类视图中添加以下代码，并将has_fav变量进行返回给前端模板</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 设置默认为未收藏状态</span></span><br><span class="line">has_fav = <span class="literal">False</span></span><br><span class="line"><span class="comment"># 当用户为登录状态才能根据条件查询该用户收藏数据</span></span><br><span class="line"><span class="keyword">if</span> request.user.is_authenticated():</span><br><span class="line">    <span class="comment"># 当用户已收藏时，即has_fav = True ，需注意这里的fav_type = 2 这个条件是固定的因为此页面为课程机构页面</span></span><br><span class="line">    <span class="keyword">if</span> UserFavorite.objects.filter(user=request.user, fav_id=int(course_org.id), fav_type=<span class="number">2</span>):</span><br><span class="line">        has_fav = <span class="literal">True</span></span><br></pre></td></tr></table></figure>

<ul>
<li>在父模板org_base中根据后端传递的has_fav数据的值，判断页面是显示收藏还是已收藏</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"btn fr collectionbtn  notlogin</span></span></span><br><span class="line"><span class="tag"><span class="string">"</span> <span class="attr">data-favid</span>=<span class="string">"22"</span> <span class="attr">data-fav-type</span>=<span class="string">"1"</span>&gt;</span></span><br><span class="line">    &#123;% if has_fav %&#125;已收藏&#123;% else %&#125;收藏&#123;% endif %&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>在机构详情页面top栏还是登录注册应该进行判断显示，直接将index模板的判断内容拷贝替换掉org_base模板中同标签内容</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/20190509000700597.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></p>
<ul>
<li>测试收藏功能</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190509013347739.gif" alt></fancybox></p>
<h1 id="五丶公开课（列表页）"><a href="#五丶公开课（列表页）" class="headerlink" title="五丶公开课（列表页）"></a>五丶公开课（列表页）</h1><p><strong>1.</strong>模板继承</p>
<ul>
<li>前端模板为course-list，页面如下</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190509144344213.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>course-list模板与org-list模板一样都是继承于base模板（这里不用再多说了）</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/20190509153351454.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></p>
<p><strong>2.</strong>显示课程列表页</p>
<ul>
<li>在根级urls中配置course应用下的urls</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url(<span class="string">r'course/'</span>, include(<span class="string">'courses.urls'</span>, namespace=<span class="string">"course"</span>)),  <span class="comment"># 课程应用course下的urls</span></span><br></pre></td></tr></table></figure>

<ul>
<li>在course/views中定义类视图get方法</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CourseListView</span><span class="params">(View)</span>:</span></span><br><span class="line">    <span class="string">"""课程列表页"""</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self, request)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> render(request, <span class="string">"course-list.html"</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li>在应用urls中定义路由</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url(<span class="string">r'^list/$'</span>, CourseListView.as_view(), name=<span class="string">"course_list"</span>),  <span class="comment"># 课程列表页</span></span><br></pre></td></tr></table></figure>

<ul>
<li>访问<a href="http://127.0.0.1:8000/course/list/" target="_blank" rel="noopener">http://127.0.0.1:8000/course/list/</a>  课程列表页，成功显示出页面</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190509153753716.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<p><strong>3.</strong>课程列表页动态数据展示</p>
<ul>
<li>在xadmin后台中添加课程表数据</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190509155029810.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>在视图中获取所有的课程信息，并返回给模板</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CourseListView</span><span class="params">(View)</span>:</span></span><br><span class="line">    <span class="string">"""课程列表页"""</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self, request)</span>:</span></span><br><span class="line">        all_courses = Course.objects.all()</span><br><span class="line">        <span class="keyword">return</span> render(request, <span class="string">"course-list.html"</span>, &#123;<span class="string">"all_courses"</span>:all_courses&#125;)</span><br></pre></td></tr></table></figure>

<ul>
<li>在模板中进行循环遍历打印显示页面内容字段数据</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"group_list"</span>&gt;</span></span><br><span class="line">    &#123;%  for course in all_courses %&#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"course-detail.html"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">img</span> <span class="attr">width</span>=<span class="string">"280"</span> <span class="attr">height</span>=<span class="string">"350"</span> <span class="attr">class</span>=<span class="string">"scrollLoading"</span></span></span><br><span class="line"><span class="tag">                 <span class="attr">src</span>=<span class="string">&#123;&#123;</span> <span class="attr">MEDIA_URL</span> &#125;&#125;&#123;&#123; <span class="attr">course.image</span> &#125;&#125;/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"des"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"course-detail.html"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;&#123; course.name &#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"fl"</span>&gt;</span>时长：<span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"key"</span>&gt;</span>&#123;&#123; course.learn_times &#125;&#125;<span class="tag">&lt;/<span class="name">i</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"fr"</span>&gt;</span>学习人数：&#123;&#123; course.students &#125;&#125;&amp;nbsp;&amp;nbsp;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"bottom"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"course-detail.html"</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"fl"</span>&gt;</span>来自&#123;&#123; course.course_org.name &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"star fr  notlogin</span></span></span><br><span class="line"><span class="tag"><span class="string">            "</span> <span class="attr">data-favid</span>=<span class="string">"15"</span>&gt;</span></span><br><span class="line">            &#123;&#123; course.fav_nums &#125;&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    &#123;% endfor %&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>刷新页面，成功显示出动态数据</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190509160155154.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<p><strong>4.</strong>课程列表页数据分页</p>
<ul>
<li>跟机构列表页一样使用pure_pagination第三方工具进行分页处理，完全可以照搬，首先在视图中进行分页数据处理</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CourseListView</span><span class="params">(View)</span>:</span></span><br><span class="line">    <span class="string">"""课程列表页"""</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self, request)</span>:</span></span><br><span class="line">        all_courses = Course.objects.all()</span><br><span class="line">        <span class="comment"># 分页处理</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            page = request.GET.get(<span class="string">'page'</span>, <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">except</span> PageNotAnInteger:</span><br><span class="line">            page = <span class="number">1</span></span><br><span class="line">        p = Paginator(all_courses, <span class="number">12</span>, request=request)</span><br><span class="line">        courses = p.page(page)</span><br><span class="line">        <span class="keyword">return</span> render(request, <span class="string">"course-list.html"</span>, &#123;<span class="string">"all_courses"</span>:courses&#125;)</span><br></pre></td></tr></table></figure>

<ul>
<li>在course-list模板中需要将前面遍历的all_courses修改为{% for course in all_courses.object_list %}，然后将org-list模板中的分页代码拷贝到course-list分页标签下，只需要将代码中的all_orgs修改为all_courses即可</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"pageturn"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"pagelist"</span>&gt;</span></span><br><span class="line">        &#123;% if all_courses.has_previous %&#125;</span><br><span class="line">            <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"long"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"?&#123;&#123; all_courses.previous_page_number.querystring &#125;&#125;"</span>&gt;</span>上一页<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        &#123;% endif %&#125;</span><br><span class="line">        &#123;% for page in all_courses.pages %&#125;</span><br><span class="line">            &#123;% if page %&#125;</span><br><span class="line">                &#123;% ifequal page all_courses.number %&#125;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"active"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"?&#123;&#123; page.querystring &#125;&#125;"</span>&gt;</span>&#123;&#123; page &#125;&#125;<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                &#123;% else %&#125;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"?&#123;&#123; page.querystring &#125;&#125;"</span> <span class="attr">class</span>=<span class="string">"page"</span>&gt;</span>&#123;&#123; page &#125;&#125;<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                &#123;% endifequal %&#125;</span><br><span class="line">            &#123;% else %&#125;</span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"none"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span>...<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">            &#123;% endif %&#125;</span><br><span class="line">        &#123;% endfor %&#125;</span><br><span class="line">        &#123;% if all_courses.has_next %&#125;</span><br><span class="line">            <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"long"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"?&#123;&#123; all_courses.next_page_number.querystring &#125;&#125;"</span>&gt;</span>下一页<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        &#123;% endif %&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>课程列表页分页功能测试</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190509161731127.gif" alt></fancybox></p>
<p><strong>5.</strong>课程列表页面数据排序</p>
<ul>
<li>在视图中根据链接地址sort参数来判断从数据库进行什么条件排序，需将请求地址获取的sort参数的值传递给前端模板，用于前端模板判断标签active激活操作</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CourseListView</span><span class="params">(View)</span>:</span></span><br><span class="line">    <span class="string">"""课程列表页"""</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self, request)</span>:</span></span><br><span class="line">        <span class="comment"># 默认按最新排序</span></span><br><span class="line">        all_courses = Course.objects.all().order_by(<span class="string">"-add_time"</span>)</span><br><span class="line"> </span><br><span class="line">        <span class="comment"># 热门与人数排序</span></span><br><span class="line">        sort = request.GET.get(<span class="string">"sort"</span>, <span class="string">""</span>)</span><br><span class="line">        <span class="keyword">if</span> sort:</span><br><span class="line">            <span class="keyword">if</span> sort == <span class="string">"students"</span>:</span><br><span class="line">                all_courses = all_courses.order_by(<span class="string">"-students"</span>)  <span class="comment"># 人数</span></span><br><span class="line">            <span class="keyword">elif</span> sort == <span class="string">"hot"</span>: </span><br><span class="line">                all_courses = all_courses.order_by(<span class="string">"-click_nums"</span>)  <span class="comment"># 点击数来决定热门</span></span><br><span class="line">        <span class="comment"># 分页处理</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            page = request.GET.get(<span class="string">'page'</span>, <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">except</span> PageNotAnInteger:</span><br><span class="line">            page = <span class="number">1</span></span><br><span class="line">        p = Paginator(all_courses, <span class="number">12</span>, request=request)</span><br><span class="line">        courses = p.page(page)</span><br><span class="line">        <span class="keyword">return</span> render(request, <span class="string">"course-list.html"</span>, &#123;<span class="string">"all_courses"</span>:courses, <span class="string">"sort"</span>:sort&#125;)</span><br></pre></td></tr></table></figure>

<ul>
<li>在模板中需要定义链接地址，以及判断后台传递过来的sort值，来给标签添加激活样式</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"tab_header"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"&#123;% if not sort %&#125;active&#123;% endif %&#125;"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"?sort="</span>&gt;</span>最新 <span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"&#123;% if sort == 'hot' %&#125;active&#123;% endif %&#125;"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"?sort=hot"</span>&gt;</span>最热门<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"&#123;% if sort == 'students' %&#125;active&#123;% endif %&#125;"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"?sort=students"</span>&gt;</span>参与人数<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>测试页面数据排序功能</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190509163919597.gif" alt></fancybox></p>
<p><strong>6.</strong>页面右侧栏热门课程显示</p>
<ul>
<li>在视图中按照click_num倒序排序获取数据，传递到模板中</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 热门课程</span></span><br><span class="line">hot_courses = Course.objects.all().order_by(<span class="string">"-click_nums"</span>)[:<span class="number">3</span>]</span><br></pre></td></tr></table></figure>

<ul>
<li>在模板中进行打印显示即可，非常简单，需要注意的是因为degree课程难度为choice字段所以需要使用django提供的此方式进行打印get_表字段_display</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"right layout"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"head"</span>&gt;</span>热门课程推荐<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"group_recommend"</span>&gt;</span></span><br><span class="line">        &#123;%  for hot_course in hot_courses %&#125;</span><br><span class="line">        <span class="tag">&lt;<span class="name">dl</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dt</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">a</span> <span class="attr">target</span>=<span class="string">"_blank"</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">img</span> <span class="attr">width</span>=<span class="string">"240"</span> <span class="attr">height</span>=<span class="string">"220"</span> <span class="attr">class</span>=<span class="string">"scrollLoading"</span></span></span><br><span class="line"><span class="tag">                         <span class="attr">src</span>=<span class="string">&#123;&#123;</span> <span class="attr">MEDIA_URL</span> &#125;&#125;&#123;&#123; <span class="attr">hot_course.image</span> &#125;&#125;/&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dt</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dd</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">a</span> <span class="attr">target</span>=<span class="string">"_blank"</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span><span class="tag">&lt;<span class="name">h2</span>&gt;</span> &#123;&#123; hot_course.name &#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"fl"</span>&gt;</span>难度：<span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"key"</span>&gt;</span>&#123;&#123; hot_course.get_degree_display &#125;&#125;<span class="tag">&lt;/<span class="name">i</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dd</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dl</span>&gt;</span></span><br><span class="line">        &#123;%  endfor %&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>测试显示页面中的热门课程</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190509164433303.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<br>

<p>————————————————<br>版权声明：本文为CSDN博主「cdtaogang」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。<br>原文链接：<a href="https://blog.csdn.net/qq_41782425/article/details/89914436" target="_blank" rel="noopener">https://blog.csdn.net/qq_41782425/article/details/89914436</a></p>

      </div>
      
        <br>
        


  <section class='meta' id="footer-meta">
    <div class='new-meta-box'>
      
        
          <div class="new-meta-item date" itemprop="dateUpdated" datetime="2019-11-15T13:56:43+08:00">
  <a class='notlink'>
    <i class="fas fa-clock" aria-hidden="true"></i>
    <p>更新于 2019年11月15日</p>
  </a>
</div>

        
      
        
          
  
  <div class="new-meta-item meta-tags"><a class="tag" href="/tags/Python/" rel="nofollow"><i class="fas fa-tag" aria-hidden="true"></i><p>Python</p></a></div> <div class="new-meta-item meta-tags"><a class="tag" href="/tags/Django/" rel="nofollow"><i class="fas fa-tag" aria-hidden="true"></i><p>Django</p></a></div> <div class="new-meta-item meta-tags"><a class="tag" href="/tags/Django网站实战/" rel="nofollow"><i class="fas fa-tag" aria-hidden="true"></i><p>Django网站实战</p></a></div> <div class="new-meta-item meta-tags"><a class="tag" href="/tags/Python-Web开发/" rel="nofollow"><i class="fas fa-tag" aria-hidden="true"></i><p>Python Web开发</p></a></div>


        
      
        
          
  <div class="new-meta-item share -mob-share-list">
  <div class="-mob-share-list share-body">
    
      
        <a class="-mob-share-qq" title="QQ好友" rel="external nofollow noopener noreferrer"
          
          href="http://connect.qq.com/widget/shareqq/index.html?url=https://hellotaogang.github.io/2019/11/14/Django项目于之在线教育平台网站的实战开发（三）/&title=Django项目于之在线教育平台网站的实战开发（三） | TG'S BLOG&summary=该篇文章是博主一字一码编写的，实属不易，请尊重原创，谢谢大家！温馨提示：需要项目源码的朋友，请添加博主微信进行获取！
&nbsp;&nbsp;本文目录
一丶授课机构（列表页）
二丶授课机构（用户咨询）
三丶授课机构（详情页） 
四丶授课机构（用户收藏）
五丶公开课（列表页）"
          
          >
          
            <img src="https://cdn.jsdelivr.net/gh/xaoxuu/assets@19.1.9/logo/128/qq.png">
          
        </a>
      
    
      
        <a class="-mob-share-qzone" title="QQ空间" rel="external nofollow noopener noreferrer"
          
          href="https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=https://hellotaogang.github.io/2019/11/14/Django项目于之在线教育平台网站的实战开发（三）/&title=Django项目于之在线教育平台网站的实战开发（三） | TG'S BLOG&summary=该篇文章是博主一字一码编写的，实属不易，请尊重原创，谢谢大家！温馨提示：需要项目源码的朋友，请添加博主微信进行获取！
&nbsp;&nbsp;本文目录
一丶授课机构（列表页）
二丶授课机构（用户咨询）
三丶授课机构（详情页） 
四丶授课机构（用户收藏）
五丶公开课（列表页）"
          
          >
          
            <img src="https://cdn.jsdelivr.net/gh/xaoxuu/assets@19.1.9/logo/128/qzone.png">
          
        </a>
      
    
      
        <a class='qrcode' rel="external nofollow noopener noreferrer" href='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQ4AAAEOCAAAAABd2qZ5AAAD+klEQVR42u3dy27bQBAEQP//TytATjFkSt0zSyUBiidDlihu5dCeB5Cvr/h6/L6uXv/zen7/82eff3t1vf72/BkOXzhw4MCBIzhq8kDPryeHzF/Jn2rzXW/OggMHDhw4DnHkx7sKzteBmoduG585R/QHBA4cOHDg+CDHLA7zA+cxv4HGgQMHDhz/GkdUCJXvnMVzW1LiwIEDB45PcswGP3mU5uOiNsI3UY0DBw4cOO7gaBca/sefb9zvwIEDBw4cizBryTZLErPmYNt8/PYpHDhw4MCx5mhXBzYtvDz82iWGWUlWVLQ4cODAgaPk2Cy3tQ+3X0qYxXZyTxw4cODAsefIFwJm7cI8RJND5n8WtG1BHDhw4MBxiqOdv8yW1XL0tvG3H6QVhRwOHDhw4AieLSmi2tfzImpW+O2LvctgxoEDBw4ct3HkpdFjceX3nJV/efDjwIEDB45THHlbrY26WWwnRd1s4JQ/Gw4cOHDg2HC0Tb3NckM7rMqXHmYrEZcLDThw4MCB4xBH8rE2ldrx0mZY1T75m4oWBw4cOHAsODbjnPYR28Zf20Bsy0UcOHDgwHEfx+GO42jFoY3k/B8pOikOHDhw4DjK0Qbknm8/fNqgXzYHceDAgQPHIY7kdpvgTO68KQXz+1/GMw4cOHDgOMSxaQUm779vbaI+8Ot/Whw4cODAcYhjNkbKC612KWHWlGzLxejvDhw4cODAcQNHHqhJELb32bDmyxPD+RUOHDhw4Ljg2Lfw2njetwhP3f+yosWBAwcOHB+fs+SlV1uq5etu+ZNHn8WBAwcOHGuOzbgoabrlQGe/tx1l4cCBAweOsxztmkJ7pPy3eXl2xztx4MCBA8cpjtmth6OduL3YHrI9djF8woEDBw4cRzmShl1Clgx+8qhu1zKKZ8OBAwcOHIc4ZgOkWRi3MTxbvJsB4cCBAweOPcfZ4dNsASIpBdvCLOmGvinkcODAgQNHydF+/SzwNuVcUjpu4v/bzzhw4MCB4xBHXoAlwblZUKv3L0aF3+W5cODAgQPHIY68TJqtEbSDq7xlOQt7HDhw4MBxN0cSRS1EUpK1K3r5PduQvizhcODAgQPHpNKp/7vltv03e8RZoOajpnq/AwcOHDhwBByP8jrWhhstH0QxObr/D1M4HDhw4MAx4tiPc/ZMm8ZiUmrmZSEOHDhw4DjF0TbdkgPnpVQb5PnBhg1EHDhw4MBxiKMNwrY0apt37UrEbNRUrDXgwIEDB44bOGZh3M7BTrUa23PhwIEDB46/y5EXVO3IZ9Ne3LcRceDAgQPHKY48RNvG4uvCLAfKg39DgwMHDhw49hztQsPs9Q1o3mScDau+2gsHDhw4cPx8n1+kdwGTuqlR6AAAAABJRU5ErkJggg=='>
        
          <img src="https://cdn.jsdelivr.net/gh/xaoxuu/assets@19.1.9/logo/128/wechat.png">
        
        </a>
      
    
      
        <a class="-mob-share-weibo" title="微博" rel="external nofollow noopener noreferrer"
          
          href="http://service.weibo.com/share/share.php?url=https://hellotaogang.github.io/2019/11/14/Django项目于之在线教育平台网站的实战开发（三）/&title=Django项目于之在线教育平台网站的实战开发（三） | TG'S BLOG&summary=该篇文章是博主一字一码编写的，实属不易，请尊重原创，谢谢大家！温馨提示：需要项目源码的朋友，请添加博主微信进行获取！
&nbsp;&nbsp;本文目录
一丶授课机构（列表页）
二丶授课机构（用户咨询）
三丶授课机构（详情页） 
四丶授课机构（用户收藏）
五丶公开课（列表页）"
          
          >
          
            <img src="https://cdn.jsdelivr.net/gh/xaoxuu/assets@19.1.9/logo/128/weibo.png">
          
        </a>
      
    
  </div>
</div>



        
      
    </div>
  </section>


      
      
          <div class="prev-next">
              
                  <section class="prev">
                      <span class="art-item-left">
                          <h6><i class="fas fa-chevron-left" aria-hidden="true"></i>&nbsp;上一页</h6>
                          <h4>
                              <a href="/2019/11/15/Django项目于之在线教育平台网站的实战开发（四）/" rel="prev" title="Django项目于之在线教育平台网站的实战开发（四）">
                                
                                    Django项目于之在线教育平台网站的实战开发（四）
                                
                              </a>
                          </h4>
                          
                              
                              <h6 class="tags">
                                  <a class="tag" href="/tags/Python/"><i class="fas fa-tag fa-fw" aria-hidden="true"></i> Python</a> <a class="tag" href="/tags/Django/"><i class="fas fa-tag fa-fw" aria-hidden="true"></i> Django</a> <a class="tag" href="/tags/Django网站实战/"><i class="fas fa-tag fa-fw" aria-hidden="true"></i> Django网站实战</a> <a class="tag" href="/tags/Python-Web开发/"><i class="fas fa-tag fa-fw" aria-hidden="true"></i> Python Web开发</a>
                              </h6>
                          
                      </span>
                  </section>
              
              
                  <section class="next">
                      <span class="art-item-right" aria-hidden="true">
                          <h6>下一页&nbsp;<i class="fas fa-chevron-right" aria-hidden="true"></i></h6>
                          <h4>
                              <a href="/2019/11/12/Django项目于之在线教育平台网站的实战开发（二）/" rel="prev" title="Django项目于之在线教育平台网站的实战开发（二）">
                                  
                                      Django项目于之在线教育平台网站的实战开发（二）
                                  
                              </a>
                          </h4>
                          
                              
                              <h6 class="tags">
                                  <a class="tag" href="/tags/Python/"><i class="fas fa-tag fa-fw" aria-hidden="true"></i> Python</a> <a class="tag" href="/tags/Django/"><i class="fas fa-tag fa-fw" aria-hidden="true"></i> Django</a> <a class="tag" href="/tags/Django网站实战/"><i class="fas fa-tag fa-fw" aria-hidden="true"></i> Django网站实战</a> <a class="tag" href="/tags/Python-Web开发/"><i class="fas fa-tag fa-fw" aria-hidden="true"></i> Python Web开发</a>
                              </h6>
                          
                      </span>
                  </section>
              
          </div>
      
    </section>
  </article>



  <!-- 显示推荐文章和评论 -->



  <article class="post white-box comments">
    <section class="article typo">
      <h4><i class="fas fa-comments fa-fw" aria-hidden="true"></i>&nbsp;评论</h4>
      
      
      
        <section id="comments">
          <div id="gitalk-container"></div>
        </section>
      
      
    </section>
  </article>






<!-- 根据页面mathjax变量决定是否加载MathJax数学公式js -->



  <script>
    window.subData = {
      title: 'Django项目于之在线教育平台网站的实战开发（三）',
      tools: true
    }
  </script>


</div>
<aside class='l_side'>
  
    
    
      
        
          
          
        
          
          
            
              
  <section class='widget toc-wrapper'>
    
<header class='pure'>
  <div><i class="fas fa-list fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;本文目录</div>
  
    <!-- <div class='wrapper'><a class="s-toc rightBtn" rel="external nofollow noopener noreferrer" href="javascript:void(0)"><i class="fas fa-thumbtack fa-fw"></i></a></div> -->
  
</header>

    <div class='content pure'>
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#一丶授课机构（列表页）"><span class="toc-text">一丶授课机构（列表页）</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#二丶授课机构（用户咨询）"><span class="toc-text">二丶授课机构（用户咨询）</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#三丶授课机构（详情页）"><span class="toc-text">三丶授课机构（详情页）</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#四丶授课机构（用户收藏）"><span class="toc-text">四丶授课机构（用户收藏）</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#五丶公开课（列表页）"><span class="toc-text">五丶公开课（列表页）</span></a></li></ol>
    </div>
  </section>


            
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
      
    

  
</aside>

<footer id="footer" class="clearfix">
  
  
    <div class="social-wrapper">
      
        
          <a href="http://wpa.qq.com/msgrd?v=3&amp;uin=1126331350&amp;site=qq&amp;menu=yes"
            class="social fab fa-qq flat-btn flat-btn"
            target="_blank"
            rel="external nofollow noopener noreferrer">
          </a>
        
      
        
          <a href="https://cdn.jsdelivr.net/gh/Hellotaogang/cdn@4.4/about/wxhy.png"
            class="social fab fa-weixin flat-btn flat-btn"
            target="_blank"
            rel="external nofollow noopener noreferrer">
          </a>
        
      
        
          <a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=cdtaogang@163.com"
            class="social fas fa-envelope flat-btn"
            target="_blank"
            rel="external nofollow noopener noreferrer">
          </a>
        
      
        
          <a href="https://github.com/Hellotaogang"
            class="social fab fa-github flat-btn"
            target="_blank"
            rel="external nofollow noopener noreferrer">
          </a>
        
      
        
          <a href="https://blog.csdn.net/qq_41782425"
            class="social fab fa-cuttlefish flat-btn flat-btn"
            target="_blank"
            rel="external nofollow noopener noreferrer">
          </a>
        
      
    </div>
  
  <br>
  <div><p>Copyright <i class='far fa-copyright'></i> 2019-2020 <a style='color: #333333' href='https://www.cdtaogang.top/' target='_blank'>TG’BLOG</a>&nbsp;&nbsp;|&nbsp;&nbsp;<span id='timeDate'>载入天数…</span><span id='times'>载入时分秒…</span></p>
</div>
  <br>
  <div>
    <div class='github-badge'> <a style='color: #fff' href='https://hexo.io/'><span class='badge-subject'>框架</span><span class='badge-value bg-blue'>Hexo</span></a> </div> <div class='github-badge'> <a style='color: #fff' href='https://github.com/'><span class='badge-subject'>托管</span><span class='badge-value bg-brightgreen'>GitHub</span></a> </div> <div class='github-badge'> <a style='color: #fff' href='https://www.aliyun.com/'><span class='badge-subject'>域名</span><span class='badge-value bg-firebrick'>Aliyun</span></a> </div> <div class='github-badge'> <a style='color: #fff' href='https://www.jsdelivr.com/'><span class='badge-subject'>内容分发网络</span><span class='badge-value bg-orange'>jsDelivr</span></a> </div> <div class='github-badge'> <a style='color: #fff' href='https://996.icu/#/zh_CN'><span class='badge-subject'>链接</span><span class='badge-value bg-red'>996.ICU</span></a> </div> <div class='github-badge'> <a style='color: #fff' href='https://xaoxuu.com/wiki/material-x/'><span class='badge-subject'>主题</span><span class='badge-value bg-blue'>Material X</span></a> </div> <div class='github-badge'> <a style='color: #fff' href='https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh'><span class='badge-subject'>协议</span><span class='badge-value bg-pink'>BY-NC-SA 4.0</span></a> </div>
  </div>
<script>
    var now = new Date(); 
    function createtime() { 
        var grt= new Date("10/11/2019 21:38:00");//在此处修改你的建站时间
        now.setTime(now.getTime()+250); 
        days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days); 
        hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours); 
        if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum); 
        mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;} 
        seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum); 
        snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;} 
        document.getElementById("timeDate").innerHTML = "本站已安全运行 "+dnum+" 天 "; 
        document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒"; 
    } 
setInterval("createtime()",250);
</script>
</footer>
<script>setLoadingBarProgress(80);</script>



      <script>setLoadingBarProgress(60);</script>
    </div>
    <a class="s-top fas fa-arrow-up fa-fw" href='javascript:void(0)'></a>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>

  <script>
    var GOOGLE_CUSTOM_SEARCH_API_KEY = "";
    var GOOGLE_CUSTOM_SEARCH_ENGINE_ID = "";
    var ALGOLIA_API_KEY = "";
    var ALGOLIA_APP_ID = "";
    var ALGOLIA_INDEX_NAME = "";
    var AZURE_SERVICE_NAME = "";
    var AZURE_INDEX_NAME = "";
    var AZURE_QUERY_KEY = "";
    var BAIDU_API_ID = "";
    var SEARCH_SERVICE = "hexo" || "hexo";
    var ROOT = "/"||"/";
    if(!ROOT.endsWith('/'))ROOT += '/';
  </script>

<script src="//instant.page/1.2.2" type="module" integrity="sha384-2xV8M5griQmzyiY3CDqh1dn4z3llDVqZDqzjzcY+jCBCk/a5fXJmuZ/40JJAPeoU"></script>


  <script async src="https://cdn.jsdelivr.net/npm/scrollreveal@4.0.5/dist/scrollreveal.min.js"></script>
  <script type="text/javascript">
    $(function() {
      const $reveal = $('.reveal');
      if ($reveal.length === 0) return;
      const sr = ScrollReveal({ distance: 0 });
      sr.reveal('.reveal');
    });
  </script>


  <script src="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.js"></script>
  <script type="text/javascript">
    $(function() {
      Waves.attach('.flat-btn', ['waves-button']);
      Waves.attach('.float-btn', ['waves-button', 'waves-float']);
      Waves.attach('.float-btn-light', ['waves-button', 'waves-float', 'waves-light']);
      Waves.attach('.flat-box', ['waves-block']);
      Waves.attach('.float-box', ['waves-block', 'waves-float']);
      Waves.attach('.waves-image');
      Waves.init();
    });
  </script>


  <script async src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-busuanzi@2.3/js/busuanzi.pure.mini.js"></script>




  
  
  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-backstretch/2.0.4/jquery.backstretch.min.js"></script>
    <script type="text/javascript">
      $(function(){
        if ('.cover') {
          $('.cover').backstretch(
          ["https://cdn.jsdelivr.net/gh/Hellotaogang/cdn@4.5.7/images/background_4.jpg", "https://cdn.jsdelivr.net/gh/Hellotaogang/cdn@4.5.7/images/background_5.jpg", "https://cdn.jsdelivr.net/gh/Hellotaogang/cdn@4.5.7/images/background_6.jpg"],
          {
            duration: "6000",
            fade: "2500"
          });
        } else {
          $.backstretch(
          ["https://cdn.jsdelivr.net/gh/Hellotaogang/cdn@4.5.7/images/background_4.jpg", "https://cdn.jsdelivr.net/gh/Hellotaogang/cdn@4.5.7/images/background_5.jpg", "https://cdn.jsdelivr.net/gh/Hellotaogang/cdn@4.5.7/images/background_6.jpg"],
          {
            duration: "6000",
            fade: "2500"
          });
        }
      });
    </script>
  







  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
  <script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
  <script src="https://cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.min.js"></script>
  <script type="text/javascript">
    var gitalk = new Gitalk({
      clientID: "71020b6958cd6bbf65b7",
      clientSecret: "3cfeccd9125b8bac76f2bd8a7f6e30a601ae3a81",
      repo: "Hellotaogang.github.io",
      owner: "Hellotaogang",
      admin: "Hellotaogang",
      
        id: md5(location.pathname),      // Ensure uniqueness and length less than 50
      
      distractionFreeMode: false  // Facebook-like distraction free mode
    });
    gitalk.render('gitalk-container');
  </script>





  <script src="/js/app.js"></script>


  <script src="/js/search.js"></script>




<!-- 复制 -->
<script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script>
  let COPY_SUCCESS = "复制成功";
  let COPY_FAILURE = "复制失败";
  /*页面载入完成后，创建复制按钮*/
  !function (e, t, a) {
    /* code */
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '  <i class="fa fa-copy"></i><span>复制</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });

      clipboard.on('success', function(e) {
        //您可以加入成功提示
        console.info('Action:', e.action);
        console.info('Text:', e.text);
        console.info('Trigger:', e.trigger);
        success_prompt(COPY_SUCCESS);
        e.clearSelection();
      });
      clipboard.on('error', function(e) {
        //您可以加入失败提示
        console.error('Action:', e.action);
        console.error('Trigger:', e.trigger);
        fail_prompt(COPY_FAILURE);
      });
    }
    initCopyCode();

  }(window, document);

  /**
   * 弹出式提示框，默认1.5秒自动消失
   * @param message 提示信息
   * @param style 提示样式，有alert-success、alert-danger、alert-warning、alert-info
   * @param time 消失时间
   */
  var prompt = function (message, style, time)
  {
      style = (style === undefined) ? 'alert-success' : style;
      time = (time === undefined) ? 1500 : time*1000;
      $('<div>')
          .appendTo('body')
          .addClass('alert ' + style)
          .html(message)
          .show()
          .delay(time)
          .fadeOut();
  };

  // 成功提示
  var success_prompt = function(message, time)
  {
      prompt(message, 'alert-success', time);
  };

  // 失败提示
  var fail_prompt = function(message, time)
  {
      prompt(message, 'alert-danger', time);
  };

  // 提醒
  var warning_prompt = function(message, time)
  {
      prompt(message, 'alert-warning', time);
  };

  // 信息提示
  var info_prompt = function(message, time)
  {
      prompt(message, 'alert-info', time);
  };

</script>


<!-- fancybox -->
<script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>
<script>
  let LAZY_LOAD_IMAGE = "";
  $(".article-entry").find("fancybox").find("img").each(function () {
      var element = document.createElement("a");
      $(element).attr("data-fancybox", "gallery");
      $(element).attr("href", $(this).attr("src"));
      /* 图片采用懒加载处理时,
       * 一般图片标签内会有个属性名来存放图片的真实地址，比如 data-original,
       * 那么此处将原本的属性名src替换为对应属性名data-original,
       * 修改如下
       */
       if (LAZY_LOAD_IMAGE) {
         $(element).attr("href", $(this).attr("data-original"));
       }
      $(this).wrap(element);
  });
</script>





  <script>setLoadingBarProgress(100);</script>
  <!-- 页面点击小红心 -->
  <!-- <script type="text/javascript" src="/js/love.js"></script> -->
  <!--单击显示文字-->
  <!-- <script type="text/javascript" src="/js/click_show_text.js"></script> -->
  <!-- 鼠标点击烟花 -->
  <!-- <canvas class="fireworks" style="position: fixed;left: 0;top: 0;z-index: 1; pointer-events: none;" ></canvas> 
  <script type="text/javascript" src="//cdn.bootcss.com/animejs/2.2.0/anime.min.js"></script> 
  <script type="text/javascript" src="/js/fireworks.js"></script> -->
  <!--浏览器搞笑标题-->
  <script type="text/javascript" src="\js\FunnyTitle.js"></script>
  <!--动态线条背景-->
  <script type="text/javascript"
color="0,0,0" opacity='0.7' zIndex="-2" count="200" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js">
  </script>
  <!-- 样式一（鼠标点击更换样式） -->
<!-- <script src="https://g.joyinshare.com/hc/ribbon.min.js" type="text/javascript"></script> -->
<!-- 样式二（飘动的彩带） -->
<!-- <script src="https://g.joyinshare.com/hc/piao.js" type="text/javascript"></script> -->
  <!-- 数字雨 -->
  <!-- <canvas id="canvas" width="1440" height="900" ></canvas>
  <script type="text/javascript" src="/js/DigitalRain.js"></script> -->
</body>
</html>
