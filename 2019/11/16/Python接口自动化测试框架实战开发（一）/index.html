<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  
  <title>Python接口自动化测试框架实战开发（一） | TG&#39;S BLOG</title>
  
  
  <meta name="description" content="该篇文章是博主一字一码编写的，实属不易，请尊重原创，谢谢大家！">
  

  

  <meta name="HandheldFriendly" content="True">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <!-- meta -->
  

  <!-- link -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css">
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.css">
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.10.1/css/all.min.css">
  

  
  <link rel="shortcut icon" type="image/x-icon" href="https://cdn.jsdelivr.net/gh/Hellotaogang/cdn@4.3/images/favicon.ico">
  

  
    <link rel="stylesheet" href="/style.css">
  

  <script>
    function setLoadingBarProgress(num) {
      document.getElementById('loading-bar').style.width=num+"%";
    }
  </script>

  
  
</head>

<body>
  
  
  <div class="cover-wrapper">
    <cover class='cover post half'>
      
        
  <img class='logo' src='https://cdn.jsdelivr.net/gh/Hellotaogang/cdn@4.5.6/images/logo_2.png'/>


  <div class="m_search">
    <form name="searchform" class="form u-search-form">
      <input type="text" class="input u-search-input" placeholder="" />
      <i class="icon fas fa-search fa-fw"></i>
    </form>
  </div>

<div class='menu navgation'>
  <ul class='h-list'>
    
      
        <li>
          <a class="nav home" href="/"
            
            
            id="home">
            <i class='fas fa-home fa-fw'></i>&nbsp;主页
          </a>
        </li>
      
        <li>
          <a class="nav home" href="/categories/"
            
            
            id="categories">
            <i class='fas fa-folder-open fa-fw'></i>&nbsp;分类
          </a>
        </li>
      
        <li>
          <a class="nav home" href="/tags/"
            
              rel="nofollow"
            
            
            id="tags">
            <i class='fas fa-tags fa-fw'></i>&nbsp;标签
          </a>
        </li>
      
        <li>
          <a class="nav home" href="/love/"
            
              rel="nofollow"
            
            
            id="love">
            <i class='fas fa-heart fa-fw'></i>&nbsp;记录
          </a>
        </li>
      
        <li>
          <a class="nav home" href="/about/"
            
              rel="nofollow"
            
            
            id="about">
            <i class='fas fa-info-circle fa-fw'></i>&nbsp;关于
          </a>
        </li>
      
    
  </ul>
</div>

      
    </cover>
    <header class="l_header pure">
  <div id="loading-bar-wrapper">
    <div id="loading-bar" class="pure"></div>
  </div>

	<div class='wrapper'>
		<div class="nav-main container container--flex">
      <a class="logo flat-box" href='/' >
        
          TG'S BLOG
        
      </a>
			<div class='menu navgation'>
				<ul class='h-list'>
          
  					
  						<li>
								<a class="nav flat-box" href="/"
                  
                  
                  id="home">
									<i class='fas fa-home fa-fw'></i>&nbsp;主页
								</a>
							</li>
      			
  						<li>
								<a class="nav flat-box" href="/categories/"
                  
                    rel="nofollow"
                  
                  
                  id="categories">
									<i class='fas fa-folder-open fa-fw'></i>&nbsp;分类
								</a>
							</li>
      			
  						<li>
								<a class="nav flat-box" href="/tags/"
                  
                    rel="nofollow"
                  
                  
                  id="tags">
									<i class='fas fa-tags fa-fw'></i>&nbsp;标签
								</a>
							</li>
      			
  						<li>
								<a class="nav flat-box" href="/archives/"
                  
                    rel="nofollow"
                  
                  
                  id="archives">
									<i class='fas fa-archive fa-fw'></i>&nbsp;归档
								</a>
							</li>
      			
  						<li>
								<a class="nav flat-box" href="/love/"
                  
                    rel="nofollow"
                  
                  
                  id="love">
									<i class='fas fa-heart fa-fw'></i>&nbsp;记录
								</a>
							</li>
      			
  						<li>
								<a class="nav flat-box" href="/about/"
                  
                    rel="nofollow"
                  
                  
                  id="about">
									<i class='fas fa-info-circle fa-fw'></i>&nbsp;关于
								</a>
							</li>
      			
      		
				</ul>
			</div>

			
				<div class="m_search">
					<form name="searchform" class="form u-search-form">
						<input type="text" class="input u-search-input" placeholder="搜索" />
						<i class="icon fas fa-search fa-fw"></i>
					</form>
				</div>
			
			<ul class='switcher h-list'>
				
					<li class='s-search'><a class="fas fa-search fa-fw" href='javascript:void(0)'></a></li>
				
				<li class='s-menu'><a class="fas fa-bars fa-fw" href='javascript:void(0)'></a></li>
			</ul>
		</div>

		<div class='nav-sub container container--flex'>
			<a class="logo flat-box"></a>
			<ul class='switcher h-list'>
				<li class='s-comment'><a class="flat-btn fas fa-comments fa-fw" href='javascript:void(0)'></a></li>
        
          <li class='s-toc'><a class="flat-btn fas fa-list fa-fw" href='javascript:void(0)'></a></li>
        
			</ul>
		</div>
	</div>
</header>
	<aside class="menu-phone">
    <header>
		<nav class="menu navgation">
      <ul>
        
          
            <li>
							<a class="nav flat-box" href="/"
                
                
                id="home">
								<i class='fas fa-clock fa-fw'></i>&nbsp;近期文章
							</a>
            </li>
          
            <li>
							<a class="nav flat-box" href="/blog/archives/"
                
                  rel="nofollow"
                
                
                id="blogarchives">
								<i class='fas fa-archive fa-fw'></i>&nbsp;文章归档
							</a>
            </li>
          
            <li>
							<a class="nav flat-box" href="/projects/"
                
                
                id="projects">
								<i class='fas fa-code-branch fa-fw'></i>&nbsp;开源项目
							</a>
            </li>
          
            <li>
							<a class="nav flat-box" href="/friends/"
                
                  rel="nofollow"
                
                
                id="friends">
								<i class='fas fa-link fa-fw'></i>&nbsp;我的友链
							</a>
            </li>
          
            <li>
							<a class="nav flat-box" href="https://xaoxuu.com/wiki/material-x/"
                
                  rel="nofollow"
                
                
                id="https:xaoxuu.comwikimaterial-x">
								<i class='fas fa-book fa-fw'></i>&nbsp;主题文档
							</a>
            </li>
          
            <li>
							<a class="nav flat-box" href="/about/"
                
                  rel="nofollow"
                
                
                id="about">
								<i class='fas fa-info-circle fa-fw'></i>&nbsp;关于小站
							</a>
            </li>
          
       
      </ul>
		</nav>
    </header>
	</aside>
<script>setLoadingBarProgress(40);</script>

  </div>


  <div class="l_body">
    <div class='body-wrapper'>
      <div class='l_main'>
  

  <article id="post" class="post white-box article-type-post" itemscope itemprop="blogPost">
    


  <section class='meta'>
    
    
      <a title='Python接口自动化测试框架实战开发（一）' href='/2019/11/16/Python接口自动化测试框架实战开发（一）/'><img class='thumbnail' src='https://cdn.jsdelivr.net/gh/Hellotaogang/cdn@4.6.5/images/python.png'></a>
    
    <div class="meta" id="header-meta">
      
        
  
    <h1 class="title">
      <a href="/2019/11/16/Python接口自动化测试框架实战开发（一）/">
        Python接口自动化测试框架实战开发（一）
      </a>
    </h1>
  


      
      <div class='new-meta-box'>
        
          
        
          
            
  <div class='new-meta-item author'>
    
      <a href="/" rel="nofollow">
        
          <img src="https://cdn.jsdelivr.net/gh/Hellotaogang/cdn@4.4.3/images/avatar_4.png">
        
        <p>cdtaogang</p>
      </a>
    
  </div>


          
        
          
            <div class="new-meta-item date">
  <a class='notlink'>
    <i class="fas fa-calendar-alt" aria-hidden="true"></i>
    <p>2019-11-16</p>
  </a>
</div>

          
        
          
            
  
  <div class='new-meta-item category'>
    <a href='/categories/自动化测试框架/' rel="nofollow">
      <i class="fas fa-folder-open" aria-hidden="true"></i>
      <p>自动化测试框架</p>
    </a>
  </div>


          
        
          
            
  
    <div class="new-meta-item browse busuanzi">
      <a class='notlink'>
        <i class="fas fa-eye" aria-hidden="true"></i>
        <p>
          <span id="busuanzi_value_page_pv">
            <i class="fas fa-spinner fa-spin fa-fw" aria-hidden="true"></i>
          </span>
        </p>
      </a>
    </div>
  


          
        
          
            

          
        
      </div>
      
        <hr>
      
    </div>
  </section>


    <section class="article typo">
      <div class="article-entry" itemprop="articleBody">
        <p><fancybox><img src="https://cdn.jsdelivr.net/gh/Hellotaogang/cdn@4.6.7/images/interface_test.png" width="900px" height="300px" align></fancybox><br>该篇文章是博主一字一码编写的，实属不易，请尊重原创，谢谢大家！<br><font style="color:red">温馨提示：需要项目源码的朋友，请添加博主微信进行获取！</font></p>
<div style="color:#fb651b"><i class="fas fa-list fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;本文目录</div>
<li class="toc-item toc-level-1"><a style=" text-decoration:none;" href="#一丶叙述"><span style="color:#4ea1db">一丶叙述</span></a></li>
<li class="toc-item toc-level-1"><a style=" text-decoration:none;" href="#二丶接口基础知识"><span style="color:#4ea1db">二丶接口基础知识</span></a></li>
<li class="toc-item toc-level-1"><a style=" text-decoration:none;" href="#三丶接口测试工具"><span style="color:#4ea1db">三丶接口测试工具</span></a></li>
<li class="toc-item toc-level-1"><a style=" text-decoration:none;" href="#四丶Fiddler的使用"><span style="color:#4ea1db">四丶Fiddler的使用</span></a></li>
<li class="toc-item toc-level-1"><a style=" text-decoration:none;" href="#五丶unittest使用"><span style="color:#4ea1db">五丶unittest使用</span></a></li>
<li class="toc-item toc-level-1"><a style=" text-decoration:none;" href="#六丶mock服务入门到实战"><span style="color:#4ea1db">六丶mock服务入门到实战</span></a></li>
<li class="toc-item toc-level-1"><a style=" text-decoration:none;" href="#七丶接口自动化框架设计到开发"><span style="color:#4ea1db">七丶接口自动化框架设计到开发</span></a></li>
<a id="more"></a>

<h1 id="一丶叙述"><a href="#一丶叙述" class="headerlink" title="一丶叙述"></a>一丶叙述</h1><p><strong>1.项目介绍</strong></p>
<p>整个项目分为四个部分：接口基础丶接口开发丶Unittest与接口测试结合以及接口自动化框架从设计到开发</p>
<p>接口基础包括：HTTP接口 / 常见接口 / 接口工具 / 接口基础知识</p>
<p>接口开发：通过Django来开发get/post接口</p>
<p>Unittest与接口测试结合：unittest应用 / 断言 / requests引入 / HTMLTestRunner / case的管理</p>
<p>接口自动化框架从设计到开发：如何设计框架 / 封装工具类 / 重构基类 / 错误调试 / 结果收集以及处理 / 解决数据依赖 / 结果统计及报告发送</p>
<p>项目整体思路：通过对接口数据文档的读写操作，来获取文档中case的所有数据，然后通过requests模块来发送请求获取的响应数据，通过返回的响应数据中的某个标志性字段的值来判断是否测试成功或者失败，最后将测试的结果数据写入到测试文档或者是html页面又或者是将结果以邮件的形式发送到指定邮箱，这是整个大框架思路，要完成这一系列自动化的测试框架，则需要有一定的python代码基础，博主这里只是粗略的叙述了思路，有很多地方就不细说了比如数据依赖等就请大家慢慢的阅读吧</p>
<p><strong>2.测试报告效果预览</strong></p>
<ul>
<li>unittest和HTMLTestRunner结合生成报告（新版本的）</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190628152401691.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>unittest和HTMLTestRunner结合生成报告（经典版本的）</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190628154501118.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>测试报告邮件通知</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190628152856823.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<h1 id="二丶接口基础知识"><a href="#二丶接口基础知识" class="headerlink" title="二丶接口基础知识"></a>二丶接口基础知识</h1><p><strong>1.什么是接口</strong></p>
<p>连接前后端以及移动端，通俗来说就是前端和后端之间的桥梁，比如网站需要去调用银行丶微信及支付宝的接口来完成业务需求</p>
<p><strong>2.接口的种类</strong></p>
<p>外部接口和内部接口；内部接口又分为上层服务与下层服务以及同级服务</p>
<p><strong>3.接口的分类</strong></p>
<p>请求方式：post丶get丶delete丶put</p>
<p><strong>4.为什么要做接口测试</strong></p>
<p>原因：不同端的工作进度肯定是不一致的，那么就需要对最开始开发出来的接口进行测试；对于项目来说缩短项目周期，提高开发效率以及提高系统的健壮性</p>
<p><strong>5.接口测试流程</strong></p>
<p>需求讨论——需求评审——场景设计——用例设计——数据准备——执行</p>
<p><strong>6.为什么要设计测试用例</strong></p>
<ul>
<li>理清思路，避免侧漏</li>
<li>提高测试效率</li>
<li>跟进测试进度</li>
<li>告诉领导做过</li>
<li>跟进重复重复性工作</li>
</ul>
<p><strong>7.用例设计分类</strong></p>
<p><strong>功能用例测试：</strong>测试功能是否正常丶测试功能是否按照接口文档实现</p>
<p><strong>逻辑用例设计：</strong>是否存在依赖业务，例如有些操作是需要用户登录成功的状态下才能进行的操作</p>
<p><strong>异常测试用例设计：</strong>参数异常以及数据异常；参数异常包括关键字参数丶参数为空丶多参数丶少参数丶错误参数，数据异常包括关键字数据丶数据为空丶长度不一致丶错误数据</p>
<p><strong>安全测试用例设计：</strong>cookie丶header丶唯一识别码</p>
<h1 id="三丶接口测试工具"><a href="#三丶接口测试工具" class="headerlink" title="三丶接口测试工具"></a>三丶接口测试工具</h1><p><strong>1.接口测试工具分类</strong></p>
<ul>
<li>抓取接口工具</li>
</ul>
<p><strong>httpwatch：</strong>集成于IE和Firefox浏览器中，在其他浏览器中无法使用，查看数据也比较麻烦</p>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190613155140400.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<p><strong>wireshark：</strong>只要是经过电脑的所有请求都会去抓取，导致数据量比较庞大，看数据也比较麻烦</p>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190613154236162.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<p><strong>fiddler：</strong>轻量级抓包工具，功能比较全，只会记录http请求不会像wireshark工具记录tcp和udp等请求</p>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190613154620501.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>测试接口工具：</li>
</ul>
<p><strong>loadrunner：</strong>不仅仅是性能测试工具，由于该工具几乎都是基于http请求，所以也可以用来测试接口</p>
<p><strong>fiddler：</strong>它除了可以抓包还可以向接口发送各种请求</p>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190613160113688.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<p><strong>soapui：</strong>接口和自动化测试工具，功能也比较强大</p>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190613165752320.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<p><strong>jmeter：</strong>跟loadrunner一样不仅仅是做性能测试，也可以对接口进行测试</p>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190613170926541.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<p><strong>postman：</strong>谷歌旗下的接口测试工具</p>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190613173122840.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<h1 id="四丶Fiddler的使用"><a href="#四丶Fiddler的使用" class="headerlink" title="四丶Fiddler的使用"></a>四丶Fiddler的使用</h1><p><strong>1.抓取不同类型接口数据（http以及https）</strong></p>
<ul>
<li>查看windows本机的IP</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190616102151181.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>配置fiddler</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190616102331496.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>需要保证要抓取的手机与电脑保持同一网段，博主这里使用逍遥模拟器模拟安卓手机，修改手机网络</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190616102410932.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>在高级选项中设置手动代理IP为windows本机IP地址，端口设置与fiddler抓取端口保持一致</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190616102534420.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>再安卓手机中打开知乎app，抓取知乎app的http服务的数据</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190616102745974.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>现在的移动app都是基于https请求的，所以需要在fiddler中设置https请求</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190616104754560.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>然后在手机端浏览器中访问windows电脑IP+port，进行网络安全证书的下载安装</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190616105536697.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>点击下面一个下载证书</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190616105820923.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>然后设置密码即可</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190616105838526.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>证书安装成功后，重新打开知乎app，则成功抓取https请求的数据</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190616110323708.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>在知乎app中随便对一文章进行评论，抓取该app评论接口</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190616111626177.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<p><strong>2.数据模拟以及过滤规则</strong></p>
<ul>
<li>如下图进行选择要过滤的hosts类型，并在输入框添加要过滤的hosts即可</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/2019061611221693.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>对知乎上的一篇文章进行回答后，获取<a href="https://api.zhihu.com/answers" target="_blank" rel="noopener">https://api.zhihu.com/answers</a>接口，查看发送的post请求数据中的content字段内容也就是博主回答的内容</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190616114209893.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>然后进行数据模拟，也就是点击fiddler软件上的replay对<a href="https://api.zhihu.com/answers" target="_blank" rel="noopener">https://api.zhihu.com/answers</a>接口进行post请求数据的而二次发送，由于知乎这边设定对一个问题只能进行一次回答，所以知乎服务器返回的json数据提示我们失败，同时也说明对接口进行二次数据发送成功，只是规则逻辑失败</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190616114632147.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<p><strong>3.如何模拟接口响应数据</strong></p>
<ul>
<li>首先第一步，访问知乎app热榜，在fiddler软件中获取接口查看服务器响应的json格式数据，从服务器返回的json数据看出热榜标题字段名为title_area</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190616130323517.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>然后选择服务器返回的数据类型为TextView，点击.View in Notepad即打开数据记事本，如下图在记事本中找到title_area字段的内容，该字段内容进行了将中文转换为一串字符串</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190616130511999.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>将记事本中的title_area字段的数据修改为this is a test for cdtaogang</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190616130918229.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>点击文件——另存为保存到桌面 </li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190616131927773.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>回到fiddler中，左侧选中热榜接口，右侧选中AutoResponder，在此窗口下点击Add Rule将左侧的接口添加进去，在右侧下方导入保存在桌面的zhihu_hot.htm文件，最后点击sava保存</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/2019061613103271.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>回到知乎app中刷新当前热榜页面，则成功返回修改的热榜标题</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190616132055358.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<p><strong>4.使用fiddler进行评论接口测试</strong></p>
<ul>
<li>对一篇文章进行评论，抓取评论接口，因为get请求的接口测试太简单，所以博主这里选择评论接口即POST请求方式</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190616143241904.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>右击评论接口选择copy复制接口的url地址</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190616143341130.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>右侧选择Composer，将复制的评论接口url粘贴到地址栏，并选择POST请求方式</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190616143435678.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>因为评论接口涉及到用户身份验证也就是登录后才能进行评论的，所以需要将comments接口中request headers请求头中的所有请求数据以及请求数据中的TextView的值进行复制</li>
</ul>
<p><strong>请求头数据</strong></p>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190616143752238.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<p><strong>请求体数据</strong></p>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190616143823354.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>将上面复制的请求头和请求体数据分别粘贴到如下输入框中，点击Execute执行发送，然后在左侧则出现了另一个comments接口数据</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190616144037902.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>查看该comments接口，服务器返回的响应数据中与第一个comments接口一致，说明接口测试成功</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190616144407794.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<h1 id="五丶unittest使用"><a href="#五丶unittest使用" class="headerlink" title="五丶unittest使用"></a>五丶unittest使用</h1><p><strong>1.unittest简单使用</strong></p>
<ul>
<li>在IDE中使用python的环境随便创建个py文件，需要注意的是该py文件的名字不能是test.py，否在运行时会出错，unittest包是python自带的不需要下载安装，代码如下</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line">__author__ = <span class="string">'cdtaogang'</span></span><br><span class="line">__date__ = <span class="string">'2019/6/17 13:10'</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> unittest</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestMethod</span><span class="params">(unittest.TestCase)</span>:</span></span><br><span class="line"> </span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">setUpClass</span><span class="params">(cls)</span>:</span></span><br><span class="line">        print(<span class="string">"Method before class execution"</span>)</span><br><span class="line"> </span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">tearDownClass</span><span class="params">(cls)</span>:</span></span><br><span class="line">        print(<span class="string">"Method after class execution"</span>)</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">setUp</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">"------setUp------"</span>)</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">tearDown</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">"------tearDown------"</span>)</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test_01</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">"First test method"</span>)</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test_02</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">"The second test method"</span>)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    unittest.main()</span><br></pre></td></tr></table></figure>

<ul>
<li>直接run运行以上代码</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190617132533712.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<p><strong>2.unittest和request重构封装</strong></p>
<p><strong>说明：</strong>使用requests模块对接口url地址发送请求，通过unittest测试框架进行case测试</p>
<ul>
<li>首先博主在逍遥安卓模拟器中下载了一个看书app，通过fiddler对app上的某一接口进行获取，之所以选择对此app进行接口测试，是因为该app的所有接口全是POST请求</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190617203242327.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>在PyCharm下新建工程目录，目录下创建base包，在包下创建一个demo.py文件以及test_method.py文件，用于使用unittest框架来测试以上app接口</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/20190617204015343.png" alt></p>
<ul>
<li>在demo.py文件中，使用requests get以及post方法进行了封装，主要是根据传递的参数method来对get以及post方法进行分别调用而已，具体实现如下</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RunMain</span>:</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">send_get</span><span class="params">(self,url,data)</span>:</span></span><br><span class="line">		res = requests.get(url=url,data=data).json()</span><br><span class="line">		<span class="keyword">return</span> res</span><br><span class="line">		</span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">send_post</span><span class="params">(self,url,data)</span>:</span></span><br><span class="line">		res = requests.post(url=url,data=data).json()</span><br><span class="line">		<span class="keyword">return</span> res</span><br><span class="line"> </span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">run_main</span><span class="params">(self,url,method,data=None)</span>:</span></span><br><span class="line">		res = <span class="literal">None</span></span><br><span class="line">		<span class="keyword">if</span> method == <span class="string">'GET'</span>:</span><br><span class="line">			res = self.send_get(url,data)</span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			res = self.send_post(url,data)</span><br><span class="line">		<span class="keyword">return</span> res</span><br></pre></td></tr></table></figure>

<ul>
<li>在test_method.py文件中则创建测试类以及test方法，在test方法中调用demo.py中的run_main方法，即使用requests模块向传递的接口url地址和请求方式以及请求体发送对应的请求，这里使用setUp方法则是利用其优先调用而对RunMain类进行实例化</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> unittest</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> HtmlTestRunner</span><br><span class="line"><span class="keyword">from</span> .demo <span class="keyword">import</span> RunMain</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestMethod</span><span class="params">(unittest.TestCase)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">setUp</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.run = RunMain()</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test_01</span><span class="params">(self)</span>:</span></span><br><span class="line">        url = <span class="string">'http://api.ishugui.com/asg/portal/call/265.do'</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">"sstoken"</span>:<span class="string">"eyJleHAiOjE1Njg1MzgyNTczMzUsImlhdCI6MTU2MDc2MjI1NzMzNSwicHAiOiIxMTQwNTQ1Njg5MDYwMDQ0ODAwQHNvaHUuY29tIiwidGsiOiIwZkNYSHpjTUZzR0dFMEswbVdvUVFCNWVCanpXa0hmWiIsInYiOjB9.SDYkT9FpWrBbko6xRrESN74IXJhzkqQLtijKjGiVrqA"</span>,</span><br><span class="line">            <span class="string">"gidinf"</span>:<span class="string">"x011060802ff0fd40695d68140002799751474c540b3"</span>,</span><br><span class="line">            <span class="string">"ppinf"</span>:<span class="string">"2|1560762257|1561971857|bG9naW5pZDowOnx1c2VyaWQ6Mjg6MTE0MDU0NTY4OTA2MDA0NDgwMEBzb2h1LmNvbXxzZXJ2aWNldXNlOjMwOjAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMHxjcnQ6MTA6MjAxOS0wNi0xN3xlbXQ6MTowfGFwcGlkOjY6MTEwNjA4fHRydXN0OjE6MXxwYXJ0bmVyaWQ6MTowfHJlbGF0aW9uOjA6fHV1aWQ6MTY6czk1YWIwNDk5NjE3YmJhNnx1aWQ6MTY6czk1YWIwNDk5NjE3YmJhNnx1bmlxbmFtZTowOnw"</span>,</span><br><span class="line">            <span class="string">"pprdig"</span>:<span class="string">"kaKPdU0WwIdzL58CqxNz5pgMyv23P0-Y5GRnd5ufPlXIGzrk7_7TlIK5XFQiuoqAHNqGVXHCVd4cB1DIkR5yFZ_nExnSjIZbBJWYlMkrsiIjDYqWCvedZRLm8sZqS0WqA0FcKXuSn3Z0gVRus9YpEonNz5wyuWdUqxaSmzlzygY"</span>,</span><br><span class="line">            <span class="string">"ppsmu"</span>:<span class="string">"1|1560762257|1561971857|dXNlcmlkOjI4OjExNDA1NDU2ODkwNjAwNDQ4MDBAc29odS5jb218dWlkOjA6fHV1aWQ6MDo|byWcaoPqy02s2_9GHLhZFAQ6Ov_GazMPFLrq115HiSTBS9Ijr33a55quRq2Mr1_6ZMruKEk-BYFpShUaMtwRYA"</span></span><br><span class="line">        &#125;</span><br><span class="line">        res1 = self.run.run_main(url, <span class="string">"POST"</span>, json.dumps(data))</span><br><span class="line">        print(res1)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test_02</span><span class="params">(self)</span>:</span></span><br><span class="line">        url = <span class="string">'http://api.ishugui.com/asg/portal/call/265.do'</span></span><br><span class="line">        data = &#123;</span><br><span class="line"> </span><br><span class="line">        &#125;</span><br><span class="line">        res2 = self.run.run_main(url, <span class="string">'POST'</span>, data)</span><br><span class="line"> </span><br><span class="line">        print(res2)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    unittest.main()</span><br></pre></td></tr></table></figure>

<ul>
<li>运行test_method模块，查看测试接口，test_02则是错误测试</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190617205903518.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<p><strong>3.unittest中assert的使用</strong></p>
<ul>
<li>首先根据返回的结果字典dict数据中的status状态值来判断测试是否通过或者失败，逻辑很基础就不细说了</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestMethod</span><span class="params">(unittest.TestCase)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">setUp</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.run = RunMain()</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test_01</span><span class="params">(self)</span>:</span></span><br><span class="line">        url = <span class="string">'http://api.ishugui.com/asg/portal/call/265.do'</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">"sstoken"</span>:<span class="string">"eyJleHAiOjE1Njg1MzgyNTczMzUsImlhdCI6MTU2MDc2MjI1NzMzNSwicHAiOiIxMTQwNTQ1Njg5MDYwMDQ0ODAwQHNvaHUuY29tIiwidGsiOiIwZkNYSHpjTUZzR0dFMEswbVdvUVFCNWVCanpXa0hmWiIsInYiOjB9.SDYkT9FpWrBbko6xRrESN74IXJhzkqQLtijKjGiVrqA"</span>,</span><br><span class="line">            <span class="string">"gidinf"</span>:<span class="string">"x011060802ff0fd40695d68140002799751474c540b3"</span>,</span><br><span class="line">            <span class="string">"ppinf"</span>:<span class="string">"2|1560762257|1561971857|bG9naW5pZDowOnx1c2VyaWQ6Mjg6MTE0MDU0NTY4OTA2MDA0NDgwMEBzb2h1LmNvbXxzZXJ2aWNldXNlOjMwOjAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMHxjcnQ6MTA6MjAxOS0wNi0xN3xlbXQ6MTowfGFwcGlkOjY6MTEwNjA4fHRydXN0OjE6MXxwYXJ0bmVyaWQ6MTowfHJlbGF0aW9uOjA6fHV1aWQ6MTY6czk1YWIwNDk5NjE3YmJhNnx1aWQ6MTY6czk1YWIwNDk5NjE3YmJhNnx1bmlxbmFtZTowOnw"</span>,</span><br><span class="line">            <span class="string">"pprdig"</span>:<span class="string">"kaKPdU0WwIdzL58CqxNz5pgMyv23P0-Y5GRnd5ufPlXIGzrk7_7TlIK5XFQiuoqAHNqGVXHCVd4cB1DIkR5yFZ_nExnSjIZbBJWYlMkrsiIjDYqWCvedZRLm8sZqS0WqA0FcKXuSn3Z0gVRus9YpEonNz5wyuWdUqxaSmzlzygY"</span>,</span><br><span class="line">            <span class="string">"ppsmu"</span>:<span class="string">"1|1560762257|1561971857|dXNlcmlkOjI4OjExNDA1NDU2ODkwNjAwNDQ4MDBAc29odS5jb218dWlkOjA6fHV1aWQ6MDo|byWcaoPqy02s2_9GHLhZFAQ6Ov_GazMPFLrq115HiSTBS9Ijr33a55quRq2Mr1_6ZMruKEk-BYFpShUaMtwRYA"</span></span><br><span class="line">        &#125;</span><br><span class="line">        res1 = self.run.run_main(url, <span class="string">"POST"</span>, json.dumps(data))</span><br><span class="line">        <span class="comment"># print(type(res1))</span></span><br><span class="line">        <span class="comment"># print(res1['pub'])</span></span><br><span class="line">        <span class="comment"># print(type(res1['pub']))</span></span><br><span class="line">        <span class="keyword">if</span> res1[<span class="string">'pub'</span>][<span class="string">'status'</span>] == <span class="number">0</span>:</span><br><span class="line">            print(<span class="string">"测试通过"</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">"测试失败"</span>)</span><br><span class="line">        print(res1)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test_02</span><span class="params">(self)</span>:</span></span><br><span class="line">        url = <span class="string">'http://api.ishugui.com/asg/portal/call/265.do'</span></span><br><span class="line">        data = &#123;</span><br><span class="line"> </span><br><span class="line">        &#125;</span><br><span class="line">        res2 = self.run.run_main(url, <span class="string">'POST'</span>, data)</span><br><span class="line">        <span class="keyword">if</span> res2[<span class="string">'pub'</span>][<span class="string">'status'</span>] == <span class="number">0</span>:</span><br><span class="line">            print(<span class="string">"测试通过"</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">"测试失败"</span>)</span><br><span class="line">        print(res2)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    unittest.main()</span><br></pre></td></tr></table></figure>

<ul>
<li>运行以上代码，查看结果与预期一样</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/2019062009303826.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>将if判断代码更换成unittest模块中的assert断言进行判断，这里使用assertEqual方法来判断两个值是否相等，当两个值相等则返回OK，当不相同时返回assertEqual方法msg变量自定义的值</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestMethod</span><span class="params">(unittest.TestCase)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">setUp</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.run = RunMain()</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test_01</span><span class="params">(self)</span>:</span></span><br><span class="line">        url = <span class="string">'http://api.ishugui.com/asg/portal/call/265.do'</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">"sstoken"</span>:<span class="string">"eyJleHAiOjE1Njg1MzgyNTczMzUsImlhdCI6MTU2MDc2MjI1NzMzNSwicHAiOiIxMTQwNTQ1Njg5MDYwMDQ0ODAwQHNvaHUuY29tIiwidGsiOiIwZkNYSHpjTUZzR0dFMEswbVdvUVFCNWVCanpXa0hmWiIsInYiOjB9.SDYkT9FpWrBbko6xRrESN74IXJhzkqQLtijKjGiVrqA"</span>,</span><br><span class="line">            <span class="string">"gidinf"</span>:<span class="string">"x011060802ff0fd40695d68140002799751474c540b3"</span>,</span><br><span class="line">            <span class="string">"ppinf"</span>:<span class="string">"2|1560762257|1561971857|bG9naW5pZDowOnx1c2VyaWQ6Mjg6MTE0MDU0NTY4OTA2MDA0NDgwMEBzb2h1LmNvbXxzZXJ2aWNldXNlOjMwOjAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMHxjcnQ6MTA6MjAxOS0wNi0xN3xlbXQ6MTowfGFwcGlkOjY6MTEwNjA4fHRydXN0OjE6MXxwYXJ0bmVyaWQ6MTowfHJlbGF0aW9uOjA6fHV1aWQ6MTY6czk1YWIwNDk5NjE3YmJhNnx1aWQ6MTY6czk1YWIwNDk5NjE3YmJhNnx1bmlxbmFtZTowOnw"</span>,</span><br><span class="line">            <span class="string">"pprdig"</span>:<span class="string">"kaKPdU0WwIdzL58CqxNz5pgMyv23P0-Y5GRnd5ufPlXIGzrk7_7TlIK5XFQiuoqAHNqGVXHCVd4cB1DIkR5yFZ_nExnSjIZbBJWYlMkrsiIjDYqWCvedZRLm8sZqS0WqA0FcKXuSn3Z0gVRus9YpEonNz5wyuWdUqxaSmzlzygY"</span>,</span><br><span class="line">            <span class="string">"ppsmu"</span>:<span class="string">"1|1560762257|1561971857|dXNlcmlkOjI4OjExNDA1NDU2ODkwNjAwNDQ4MDBAc29odS5jb218dWlkOjA6fHV1aWQ6MDo|byWcaoPqy02s2_9GHLhZFAQ6Ov_GazMPFLrq115HiSTBS9Ijr33a55quRq2Mr1_6ZMruKEk-BYFpShUaMtwRYA"</span></span><br><span class="line">        &#125;</span><br><span class="line">        res1 = self.run.run_main(url, <span class="string">"POST"</span>, json.dumps(data))</span><br><span class="line">        <span class="comment"># print(type(res1))</span></span><br><span class="line">        <span class="comment"># print(res1['pub'])</span></span><br><span class="line">        <span class="comment"># print(type(res1['pub']))</span></span><br><span class="line">        <span class="comment"># if res1['pub']['status'] == 0:</span></span><br><span class="line">        <span class="comment">#     print("测试通过")</span></span><br><span class="line">        <span class="comment"># else:</span></span><br><span class="line">        <span class="comment">#     print("测试失败")</span></span><br><span class="line">        self.assertEqual(res1[<span class="string">'pub'</span>][<span class="string">'status'</span>], <span class="number">0</span>, <span class="string">"测试失败"</span>)</span><br><span class="line">        print(res1)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test_02</span><span class="params">(self)</span>:</span></span><br><span class="line">        url = <span class="string">'http://api.ishugui.com/asg/portal/call/265.do'</span></span><br><span class="line">        data = &#123;</span><br><span class="line"> </span><br><span class="line">        &#125;</span><br><span class="line">        res2 = self.run.run_main(url, <span class="string">'POST'</span>, data)</span><br><span class="line">        <span class="comment"># if res2['pub']['status'] == 0:</span></span><br><span class="line">        <span class="comment">#     print("测试通过")</span></span><br><span class="line">        <span class="comment"># else:</span></span><br><span class="line">        <span class="comment">#     print("测试失败")</span></span><br><span class="line">        self.assertEqual(res2[<span class="string">'pub'</span>][<span class="string">'status'</span>], <span class="number">0</span>, <span class="string">"测试失败"</span>)</span><br><span class="line">        print(res2)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    unittest.main()</span><br></pre></td></tr></table></figure>

<ul>
<li>测试查看结果，断言失败，测试结果如下很清晰</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190620094641513.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<p><strong>4.unittest中case的管理及运用</strong></p>
<ul>
<li>在测试一些接口时，有些接口的返回数据需要在下一个接口进行使用，所以需要定义全局变量，方便每个case都能够得着，当在test_01中定义全局变量userid，然后在test_02中进行打印</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/2019062009594167.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>在unittest中，是按照字母数字来进行case先后执行顺序的，将test_01改为test_03后，运行代码后，会提示test_02中的userid未定义，原因是程序先去执行了test_02这个case，所以出现该提示是正常的</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190620100316940.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>当在测试代码中有很多case时，我想跳过某个case，则在该case方法上定义unittest的skip方法装饰器，并需要传递此方法名作为实参进行传递</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190620101028245.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>除了在if <strong>name</strong> == ‘<strong>main</strong>‘中使用unittest.main方法执行所有的case以外，还可以将要测试的case添加到unittest.TestSuite集合中执行想要执行的case，若想要全部都执行则需要一个一个的添加</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190620102828506.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<p><strong>5.unittest和HTMLTestRunner结合生成报告（博主这里给大家展现两种）</strong></p>
<p><font style="color:red"><strong>第一种：比较新版本的htmltestrunner报告</strong></font></p>
<ul>
<li>安装HTMLTestRunner，在<a href="https://pypi.org/project/html-testRunner/#files" target="_blank" rel="noopener">https://pypi.org/project/html-testRunner/#files</a> 网站上进行下载whl文件</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190620104550852.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>然后将下载好的whl文件放在你的项目环境的Scripts目录下</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190620104723582.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>最后在Terminal终端或者cmd终端中进入以上目录，执行如下命令即可</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190620105004508.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>安装成功后，即在以下路径中可以找到安装的HTMLTestRunner的包了</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190620105136939.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>在if <strong>name</strong> == ‘<strong>main</strong>‘中只需要调用HtmlTestRunner模块中的HtmlTestRunner类，向该类传递报告标题参数值即可，其他均默认，需要注意的时启动文件run为当前的py文件，如果是Unittests开头的启动文件，则不会运行if <strong>name</strong> == ‘<strong>main</strong>‘下的代码，只会执行unittest框架的setUp以及test开头的case代码</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190620123843461.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>运行test_method.py文件，成功在base目录下创建reports目录，并在该目录下生成对应时间的测试报告</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190620125533418.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>打开reports目录下生成的html测试报告，查看测试内容，与预期设定一样，test_02失败test_03成功，说明一下报告中的乱码为中文</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190620124212640.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<p><font style="color:red"><strong>第二种：比较经典版本的htmltestrunner报告</strong></font></p>
<ul>
<li>为了方便演示效果，博主在testItems项目目录下，创建base2的模块，将base模块下的demo.py和test_method.py文件拷贝到base2目录下并将test_method.py命令为test_method2.py免得搞混淆，然后在base2目录下新建HTMLTestRunner.py文件用于存放其源码，目录结构如下</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190620124855218.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>紧接着到<a href="http://tungwaiyip.info/software/HTMLTestRunner_0_8_2/HTMLTestRunner.py" target="_blank" rel="noopener">http://tungwaiyip.info/software/HTMLTestRunner_0_8_2/HTMLTestRunner.py</a> 地址中将HTMLTestRunner.py的代码全选拷贝，然后粘贴到base2/HTMLTestRunner.py文件中，因为该版本的HTMLTestRunner代码是以py2进行编写的，博主的环境使用的是py3，所以需要进行修改，修改的内容如下</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">第94行， 将import StringIO修改成import io</span><br><span class="line">第539行，将self.outputBuffer = StringIO.StringIO()修改成self.outputBuffer = io.StringIO()</span><br><span class="line">第642行，将if not rmap.has_key(cls):修改成if not cls in rmap:</span><br><span class="line">第631行，将print &gt;&gt; sys.stderr, &apos;\nTime Elapsed: %s&apos; % (self.stopTime-self.startTime)修改成print(sys.stderr, &apos;\nTime Elapsed: %s&apos; % (self.stopTime-self.startTime))</span><br><span class="line">第766行，将uo = o.decode(&apos;latin-1&apos;)修改成uo = e</span><br><span class="line">第775行，将ue = e.decode(&apos;latin-1&apos;)修改成ue = e</span><br></pre></td></tr></table></figure>

<ul>
<li>在test_method2模块中首先需要从base2模块中去导入HTMLTestRunner文件，然后if <strong>name</strong> == ‘<strong>main</strong>‘中，需要创建一个文件源，同样是调用HTMLTestRunner模块中的HTMLTestRunner类，不同的是需要将创建的文件源传递给实例属性stream变量</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190620130110696.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>运行test_method2.py，成功在上一级report目录下生成html_report.html报告文件</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190620130310900.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>打开html_report.html测试报告，测试结果与代码设定一致</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190620130443400.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<h1 id="六丶mock服务入门到实战"><a href="#六丶mock服务入门到实战" class="headerlink" title="六丶mock服务入门到实战"></a>六丶mock服务入门到实战</h1><p><strong>1.mock简介</strong></p>
<p>mock测试就是在测试过程中，对于某些不容易构造或者不容易获取的对象，用一个虚拟的对象来创建以便测试的测试方法，mock是在测试过程中，对于一些不容易构造/获取的对象，创建一个mock对象来模拟对象的行为即就是模拟fiddler返回接口响应数据的一个过程。</p>
<p><strong>2.mock安装</strong></p>
<ul>
<li>在终端使用pip进行安装即可</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/2019062015412713.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<p><strong>3.在case中通过底层函数实现mock</strong></p>
<ul>
<li>在test_method模块中导入mock，然后在test_03函数中通过以下代码设置返回的return_value的值为请求的data数据</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mock_data = mock.Mock(return_value=data)</span><br><span class="line">print(mock_data)</span><br></pre></td></tr></table></figure>

<ul>
<li>run运行Unittests in test_method.py，打印出Mock id的值</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/2019062016200462.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>将调用run_main方法的值设定为mock_data，即print(res1)则表示打印请求的data数据的值，<font style="color:red">因为res1的数据不再是接口返回的响应数据，则arrest断言是会提示报错的，这是正常的</font></li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190620162246859.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<p><strong>4.重构封装mock服务</strong></p>
<ul>
<li>在base目录下创建mock_demo.py文件，构造一个mock_test方法，该方法就是将test_03方法中self.run.run_main = mock.Mock(return_value=data) 和 res1 = self.run.run_main(url, “POST”, json.dumps(data))方法的调用进行了封装成为test_02和test_03方法通用的一个方法，上一步骤中的代码mock_data = mock.Mock(return_value=data) 和self.run.run_main = mock_data，即就相当于self.run.run_main = mock.Mock(return_value=data)而已，都是python基本的调用封装基础知识，mock_demo.py中的代码如下</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line">__author__ = <span class="string">'cdtaogang'</span></span><br><span class="line">__date__ = <span class="string">'2019/6/20 16:26'</span></span><br><span class="line"><span class="keyword">from</span> mock <span class="keyword">import</span> mock</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">mock_test</span><span class="params">(mock_method, request_data, url, method, response_data)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    :param mock_method:</span></span><br><span class="line"><span class="string">    :param request_data:</span></span><br><span class="line"><span class="string">    :param url:</span></span><br><span class="line"><span class="string">    :param method:</span></span><br><span class="line"><span class="string">    :param response_data:</span></span><br><span class="line"><span class="string">    :return: res</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    mock_method = mock.Mock(return_value=response_data)</span><br><span class="line">    print(<span class="string">'mock_method:'</span>, mock_method)</span><br><span class="line">    res = mock_method(url, method, json.dumps(request_data))</span><br><span class="line">    <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure>

<ul>
<li>那么在test_03方法中，如下进行调用即可</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">res1 = mock_test(self.run.run_main, data, url, &apos;POST&apos;, &apos;ssssssss&apos;)</span><br><span class="line">print(&apos;res1:&apos;, res1)</span><br></pre></td></tr></table></figure>

<ul>
<li>运行Unittests in test_method.py，查看运行结果和博主设定一样成功返回自定义的response_data数据</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/2019062016550410.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<h1 id="七丶接口自动化框架设计到开发"><a href="#七丶接口自动化框架设计到开发" class="headerlink" title="七丶接口自动化框架设计到开发"></a>七丶接口自动化框架设计到开发</h1><p><strong>1.如何设计一个接口自动化测试框架</strong></p>
<p>根据接口地址丶接口类型丶请求数据丶预期结果来进行设计，对于需要登录后才能进行操作的接口那么则需要进行header cookie等数据的传递，自动化测试的难点就是数据依赖。</p>
<p><strong>2.python操作excel获得内容</strong></p>
<ul>
<li>首先python操作excel，需要安装两个包，分别是xlrd和xlwt这两个库，xlrd这个库是负责读取excel数据的，而xlwt库是负责向excel写入数据的</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190620172617439.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>在项目目录下创建utils工具包，在该包下创建op_excel.py文件，在该文件中通过导入xlrd包，对excel表的数据进行读取操作</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190620181401309.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<p><strong>3.重构操作excel函数</strong></p>
<ul>
<li>根据上一步骤读取excel表的内容代码后，进行了一个简单的封装，提高代码的通用性，过程相当的简单，实现代码如下</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line">__author__ = <span class="string">'cdtaogang'</span></span><br><span class="line">__date__ = <span class="string">'2019/6/20 17:33'</span></span><br><span class="line"><span class="keyword">import</span> xlrd</span><br><span class="line"> </span><br><span class="line">data = xlrd.open_workbook(<span class="string">"../test_data/rs.xls"</span>)</span><br><span class="line">tables = data.sheets()[<span class="number">0</span>]  <span class="comment"># 获取表格数据对象</span></span><br><span class="line">print(tables.nrows) <span class="comment"># 打印表格行数</span></span><br><span class="line">print(tables.cell_value(<span class="number">0</span>,<span class="number">0</span>))  <span class="comment"># 打印excel表格数据，需要传递数据所在的坐标(x,y)</span></span><br><span class="line">print(tables.cell_value(<span class="number">0</span>,<span class="number">1</span>))</span><br><span class="line">print(<span class="string">"*"</span>*<span class="number">50</span>+<span class="string">"封装前后数据对比"</span>+<span class="string">"*"</span>*<span class="number">50</span>)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">operationExcel</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, file_path=<span class="string">"../test_data/rs.xls"</span>, sheet_id=<span class="number">0</span>)</span>:</span></span><br><span class="line">        self.file_path = file_path</span><br><span class="line">        self.sheet_id = sheet_id</span><br><span class="line">        self.data = self.get_data()</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_data</span><span class="params">(self)</span>:</span></span><br><span class="line">        data = xlrd.open_workbook(self.file_path)</span><br><span class="line">        tables = data.sheets()[self.sheet_id]</span><br><span class="line">        <span class="keyword">return</span> tables</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_rows</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""获取单元格的排数"""</span></span><br><span class="line">        <span class="keyword">return</span> self.data.nrows</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_cell_value</span><span class="params">(self, x=<span class="number">0</span>, y=<span class="number">0</span>)</span>:</span></span><br><span class="line">        <span class="string">"""获取某个单元格的数据"""</span></span><br><span class="line">        <span class="keyword">return</span> self.data.cell_value(x, y)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    print(operationExcel().get_rows())</span><br><span class="line">    print(operationExcel().get_cell_value())</span><br><span class="line">    print(operationExcel().get_cell_value(<span class="number">0</span>,<span class="number">1</span>))</span><br></pre></td></tr></table></figure>

<ul>
<li>运行op_excel.py文件后，结果与封装之前代码结果一致，表示重构封装代码成功</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190620184824963.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<p><strong>4.学习操作json文件</strong></p>
<ul>
<li>自定义一个登录的json文件名为login.json，文件内容如下，存放在test_data目录下</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/20190620190132820.png" alt></p>
<ul>
<li>在utils工具包下创建op_json.py文件，在文件中对login.json文件内容进行读取操作，代码如下</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/2019062019082690.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<p><strong>5.重构json工具类</strong></p>
<ul>
<li>将上一步操作json的代码进行封装</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">operationJson</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, file_path=<span class="string">"../test_data/login.json"</span>)</span>:</span></span><br><span class="line">        self.file_path = file_path</span><br><span class="line">        self.data = self.get_data()</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_data</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">with</span> open(self.file_path) <span class="keyword">as</span> f:</span><br><span class="line">            data = json.load(f)</span><br><span class="line">            <span class="keyword">return</span> data</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_key_words</span><span class="params">(self, key=None)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> key:</span><br><span class="line">            <span class="keyword">return</span> self.data[key]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> self.data</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    print(operationJson().get_key_words())</span><br><span class="line">    print(operationJson().get_key_words(<span class="string">"login"</span>))</span><br><span class="line">    print(operationJson().get_key_words(<span class="string">"login"</span>)[<span class="string">'username'</span>])</span><br></pre></td></tr></table></figure>

<ul>
<li>运行op_json.py文件，结果与封装之前代码结果一致，表示重构封装代码成功</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190620193959689.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<p><strong>6.封装获取常量方法</strong></p>
<ul>
<li>首先打开excel表格，查看需要获取的字段有哪些</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190621094819611.png" alt></fancybox></p>
<ul>
<li>对excel表的字段进行获取，在项目目录下创建名为data的python包，在该包下创建data_conf.py，代码就是简单的获取对应的变量值，具体如下</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line">__author__ = <span class="string">'cdtaogang'</span></span><br><span class="line">__date__ = <span class="string">'2019/6/21 9:29'</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">global_var</span>:</span></span><br><span class="line">    id = <span class="string">'0'</span>  <span class="comment"># id</span></span><br><span class="line">    module = <span class="string">'1'</span>  <span class="comment"># 模块</span></span><br><span class="line">    url = <span class="string">'2'</span>  <span class="comment"># url</span></span><br><span class="line">    run = <span class="string">'3'</span>  <span class="comment"># 是否运行</span></span><br><span class="line">    request_type = <span class="string">'4'</span>  <span class="comment"># 请求类型</span></span><br><span class="line">    request_header = <span class="string">'5'</span>  <span class="comment"># 是否携带header</span></span><br><span class="line">    case_depend = <span class="string">'6'</span>  <span class="comment"># case依赖</span></span><br><span class="line">    response_data_depend = <span class="string">'7'</span>  <span class="comment"># 依赖的返回数据</span></span><br><span class="line">    data_depend = <span class="string">'8'</span>  <span class="comment">#  数据依赖</span></span><br><span class="line">    request_data = <span class="string">'9'</span>  <span class="comment"># 请求数据</span></span><br><span class="line">    expect_result = <span class="string">'10'</span>  <span class="comment"># 预期结果</span></span><br><span class="line">    reality_result = <span class="string">'11'</span>  <span class="comment"># 实际结果</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_id</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> global_var.id</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_module</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> global_var.module</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_url</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> global_var.url</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_run</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> global_var.run</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_request_type</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> global_var.request_type</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_request_header</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> global_var.request_header</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_case_depend</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> global_var.case_depend</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_response_data_depend</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> global_var.response_data_depend</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_data_depend</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> global_var.data_depend</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_request_data</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> global_var.request_data</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_expect_result</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> global_var.expect_result</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_reality_result</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> global_var.reality_result</span><br></pre></td></tr></table></figure>

<p><strong>7.封装获取接口数据</strong></p>
<ul>
<li>在data目录下创建data_get.py文件，在该文件中对excel表数据以及json数据结合上一步封装的常量方法整合后的实现，代码如下</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line">__author__ = <span class="string">'cdtaogang'</span></span><br><span class="line">__date__ = <span class="string">'2019/6/21 10:01'</span></span><br><span class="line"><span class="keyword">from</span> utils.op_excel <span class="keyword">import</span> operationExcel</span><br><span class="line"><span class="keyword">from</span> utils.op_json <span class="keyword">import</span> operationJson</span><br><span class="line"><span class="keyword">from</span> data <span class="keyword">import</span> data_conf</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">getData</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.op_excel = operationExcel()</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_case_lines</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""获取表格行数"""</span></span><br><span class="line">        <span class="keyword">return</span> self.op_excel.get_rows()</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_is_run</span><span class="params">(self, x)</span>:</span></span><br><span class="line">        <span class="string">"""获取case是否运行"""</span></span><br><span class="line">        flag = <span class="literal">None</span></span><br><span class="line">        y = data_conf.get_run()</span><br><span class="line">        run_value = self.op_excel.get_cell_value(x, y)</span><br><span class="line">        <span class="keyword">if</span> run_value == <span class="string">'yes'</span>:</span><br><span class="line">            flag = <span class="literal">True</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            flag = <span class="literal">False</span></span><br><span class="line">        <span class="keyword">return</span> flag</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_is_header</span><span class="params">(self, x)</span>:</span></span><br><span class="line">        <span class="string">"""是否携带header"""</span></span><br><span class="line">        y = data_conf.get_request_header()</span><br><span class="line">        header = self.op_excel.get_cell_value(x, y)</span><br><span class="line">        <span class="keyword">if</span> header == <span class="string">'yes'</span>:</span><br><span class="line">            <span class="keyword">return</span> data_conf.get_header_value()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_request_method</span><span class="params">(self, x)</span>:</span></span><br><span class="line">        <span class="string">"""获取请求方式"""</span></span><br><span class="line">        y = data_conf.get_request_type()</span><br><span class="line">        request_method = self.op_excel.get_cell_value(x, y)</span><br><span class="line">        <span class="keyword">return</span> request_method</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_request_url</span><span class="params">(self, x)</span>:</span></span><br><span class="line">        <span class="string">"""获取请求地址"""</span></span><br><span class="line">        y = data_conf.get_url()</span><br><span class="line">        request_url = self.op_excel.get_cell_value(x, y)</span><br><span class="line">        <span class="keyword">return</span> request_url</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_request_data</span><span class="params">(self, x)</span>:</span></span><br><span class="line">        <span class="string">"""获取请求数据"""</span></span><br><span class="line">        y = data_conf.get_request_data()</span><br><span class="line">        request_data = self.op_excel.get_cell_value(x, y)</span><br><span class="line">        <span class="keyword">if</span> request_data == <span class="string">''</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        <span class="keyword">return</span> request_data</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_data_for_json</span><span class="params">(self, x)</span>:</span></span><br><span class="line">        <span class="string">"""通过excel中的关键字去获取json数据"""</span></span><br><span class="line">        op_json = operationJson()</span><br><span class="line">        data = op_json.get_key_words(self.get_request_data(x))</span><br><span class="line">        <span class="keyword">return</span> data</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_expect_data</span><span class="params">(self, x)</span>:</span></span><br><span class="line">        <span class="string">"""获取预期结果数据"""</span></span><br><span class="line">        y = data_conf.get_expect_result()</span><br><span class="line">        expect_data = self.op_excel.get_cell_value(x, y)</span><br><span class="line">        <span class="keyword">if</span> expect_data == <span class="string">''</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        <span class="keyword">return</span> expect_data</span><br></pre></td></tr></table></figure>

<p><strong>8.post、get基类的封装</strong></p>
<ul>
<li>在base包下创建run_method.py文件，在文件中重新编写对get丶post请求方式的代码封装，具体如下</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line">__author__ = <span class="string">'cdtaogang'</span></span><br><span class="line">__date__ = <span class="string">'2019/6/21 11:19'</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RunMain</span><span class="params">(object)</span>:</span></span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_main</span><span class="params">(self, url, data=None, header=None)</span>:</span></span><br><span class="line">        res = <span class="literal">None</span></span><br><span class="line">        <span class="keyword">if</span> header <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            res = requests.get(url=url, data=data, headers=header).json()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            res = requests.get(url=url, data=data).json()</span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">post_main</span><span class="params">(self, url, data, header=None)</span>:</span></span><br><span class="line">        res = <span class="literal">None</span></span><br><span class="line">        <span class="keyword">if</span> header <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            res = requests.post(url=url, data=data, headers=header).json()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            res = requests.post(url=url, data=data).json()</span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run_main</span><span class="params">(self, url, method, data=None, header=None)</span>:</span></span><br><span class="line">        res = <span class="literal">None</span></span><br><span class="line">        <span class="keyword">if</span> method.lower() == <span class="string">'post'</span>:</span><br><span class="line">            res = self.post_main(url, data, header)</span><br><span class="line">        <span class="keyword">elif</span> method.lower() == <span class="string">'get'</span>:</span><br><span class="line">            res = self.get_main(url, data, header)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"what ?????"</span></span><br><span class="line">        <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure>

<p><strong>9.主流程封装及错误解决调试</strong></p>
<ul>
<li>首先在testItems项目目录下新建一个名为main的python包，在该包下创建名为run_test的py文件，该文件为主程序启动文件，代码的逻辑就是将前面封装的方法进行了调用核心就是读取excel表的数据，通过读取到的数据，发送请求，其中包括某一些变量的判断，根据该判断然后到json数据中获取请求的数据，最后就这么的简单，代码如下</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line">__author__ = <span class="string">'cdtaogang'</span></span><br><span class="line">__date__ = <span class="string">'2019/6/21 11:57'</span></span><br><span class="line"><span class="keyword">from</span> base.run_method <span class="keyword">import</span> RunMain</span><br><span class="line"><span class="keyword">from</span> data.data_get <span class="keyword">import</span> getData</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RunTest</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.runmain = RunMain()</span><br><span class="line">        self.data = getData()</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></span><br><span class="line">        res = <span class="literal">None</span></span><br><span class="line">        row_counts = self.data.get_case_lines()  <span class="comment"># 获取excel表格行数</span></span><br><span class="line">        <span class="comment"># print(row_counts) 5</span></span><br><span class="line">        <span class="keyword">for</span> row_count <span class="keyword">in</span> range(<span class="number">1</span>, row_counts):</span><br><span class="line">            <span class="comment"># print(row_count) 1,2,3,4</span></span><br><span class="line">            url = self.data.get_request_url(row_count)  <span class="comment"># y行不变遍历获取x列的请求地址</span></span><br><span class="line">            method = self.data.get_request_method(row_count)  <span class="comment"># y行不变遍历获取x列的请求方式</span></span><br><span class="line">            is_run = self.data.get_is_run(row_count)  <span class="comment"># y行不变遍历获取x列的是否运行</span></span><br><span class="line">            data = self.data.get_data_for_json(row_count)  <span class="comment"># y行不变遍历获取x列的请求数据，这里面时三次调用，依次分别是get_data_for_json丶get_key_words丶get_request_data</span></span><br><span class="line">            header = self.data.get_is_header(row_count)</span><br><span class="line">            print(<span class="string">'url:'</span>, url)</span><br><span class="line">            print(<span class="string">'method:'</span>, method)</span><br><span class="line">            print(<span class="string">'is_run:'</span>, is_run)</span><br><span class="line">            print(<span class="string">'data:'</span>, data)</span><br><span class="line">            print(<span class="string">'header:'</span>, header)</span><br><span class="line"> </span><br><span class="line">            <span class="keyword">if</span> is_run:</span><br><span class="line">                res = self.runmain.run_main(url,method,data,header)</span><br><span class="line">                print(<span class="string">"*"</span>*<span class="number">60</span>+<span class="string">"分割线"</span>+<span class="string">"*"</span>*<span class="number">60</span>)</span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    print(<span class="string">'res:'</span>, RunTest().run())</span><br></pre></td></tr></table></figure>

<ul>
<li>运行run_test，成功的将excel以及json数据正确打印出来，返回res服务器返回结果，<font style="color:red">需要说明的是excel表中的所有数据都不是真实存在的，包括json文档数据也是，这里主要是测试整个框架的正确性读取excel以及json文档数据，并正确的发送请求获得相应数据</font></li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190621134112979.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>运行结果出现红色的内容，是由requests模块发送请求的安全请求警告，如不想显示此警告，可以在run_method.py发送请求核心代码进行禁用，禁用代码如下</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190621134337526.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>重新运行run_test，安全请求警告不再显示</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190621134450944.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>根据代码运行结果，对比excel表以及json数据文档内容，数据正确无误</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190621134714363.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<p><strong>10.返回数据格式处理以及调错</strong></p>
<ul>
<li>为了测试返回的接口的响应数据，博主这里在excel文档以及json文档中添加了一条数据</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190621145504252.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>因为在excel文档中小说的接口不携带header所以在向接口发送请求数据核心代码块，进行了如下修改，因为在excel文档中的最后一个接口时真实的，所以只需要对最后一个接口url返回的字典类型的响应数据进行转换成json格式的数据，并按照关键字进行排序</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190621150728390.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>运行run_test，在最后一个接口中成功打印出我们想要的数据</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190621150859489.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<p><strong>11.获取接口返回状态</strong></p>
<ul>
<li>在发送请求数据核心代码中，进行打印返回的状态码status_code即可，最后一个接口比较特殊，返回的响应数据中没有status_code，所以需要对返回的json数据中的status进行判断，并向其返回数据中添加我们所要的status_code的值</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190621183201455.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>运行代码，当返回的状态码为404表示接口不存在，只要是存在响应数据，则status_code为200，必须说明一点的就是status_code为200不一定表示接口存在，有些大型网站会对其域名下不存在的接口返回200的错误页面显示，所以在测试文档中会体现预期结果和实际结果两项数据需要一致才能表示测试通过</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190621183501974.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<p><strong>12.通过预期结果判断case是否执行成功</strong></p>
<ul>
<li>进行接下来的测试，博主这里重新准备了另一个excel表来进行测试，需要对json文件中的数据进行添加，在excel表Book-05中的请求数据book5关键字对应的json文件的数据故意为空，可以对测试结果有一个对比</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190621200131880.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>在数据获取核心类中定义了一个方法来获取excel表模块字段的数据</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190621200316628.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>回过头在启动文件中获取模块名预期结果并进行打印</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190621200438610.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>运行启动文件，查看运行结果</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190621200722687.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>在utils目录下，创建common_util.py文件，在该文件代码中通过启动文件传递过来的数据来判断excel表预期结果数据的status状态码与res结果中的status状态码是否一致，一致表示测试通过，不一致则失败，代码如下</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line">__author__ = <span class="string">'cdtaogang'</span></span><br><span class="line">__date__ = <span class="string">'2019/6/21 18:43'</span></span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CommonUtil</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">is_contains</span><span class="params">(self, expect, reality)</span>:</span></span><br><span class="line">        flag = <span class="literal">None</span></span><br><span class="line">        reality = json.loads(reality)</span><br><span class="line">        expect = json.loads(expect)</span><br><span class="line">        <span class="keyword">if</span> expect[<span class="string">'status'</span>] == reality[<span class="string">'pub'</span>][<span class="string">'status'</span>]:</span><br><span class="line">            flag = <span class="literal">True</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            flag = <span class="literal">False</span></span><br><span class="line">        <span class="keyword">return</span> flag</span><br></pre></td></tr></table></figure>

<ul>
<li>在启动文件中需要注释掉res响应数据，利于查看测试结果，还需要在启动文件调用is_contains方法来根据其返回值判断测试是否通过</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/2019062120253318.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>运行启动文件，查看测试结果</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190621202646676.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<p><strong>13.将测试结果写入到excel中</strong></p>
<ul>
<li>首先在op_excel.py中定义一个方法，该方法实现读取excel的数据，并进行copy复制，然后再write方法将数据写入到坐标位置</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/2019062121041584.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>然后在data_get.py中需要定义一个方法，在该方法中核心逻辑为获取y坐标的值</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190621210553955.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>最后在启动文件中，调用data_get模块中的write_reality_data方法，并将剩余的x坐标的值以及data数据传递给最终的核心方法write_reality_result_data来完成对excel表中的实际结果数据的写入</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190621210850261.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>将excel表进行关闭后，运行启动文件，再次打开excel表，实际结果数据写入正确，之所以需要关闭excel是避免提示提示错误，无法写入保存数据</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190621211153696.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<br>

<p>————————————————<br>版权声明：本文为CSDN博主「cdtaogang」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。<br>原文链接：<a href="https://blog.csdn.net/qq_41782425/article/details/91841130" target="_blank" rel="noopener">https://blog.csdn.net/qq_41782425/article/details/91841130</a></p>

      </div>
      
        <br>
        


  <section class='meta' id="footer-meta">
    <div class='new-meta-box'>
      
        
          <div class="new-meta-item date" itemprop="dateUpdated" datetime="2019-11-18T14:55:25+08:00">
  <a class='notlink'>
    <i class="fas fa-clock" aria-hidden="true"></i>
    <p>更新于 2019年11月18日</p>
  </a>
</div>

        
      
        
          
  
  <div class="new-meta-item meta-tags"><a class="tag" href="/tags/Fiddler/" rel="nofollow"><i class="fas fa-tag" aria-hidden="true"></i><p>Fiddler</p></a></div> <div class="new-meta-item meta-tags"><a class="tag" href="/tags/Unittest/" rel="nofollow"><i class="fas fa-tag" aria-hidden="true"></i><p>Unittest</p></a></div> <div class="new-meta-item meta-tags"><a class="tag" href="/tags/HTMLTestRunner/" rel="nofollow"><i class="fas fa-tag" aria-hidden="true"></i><p>HTMLTestRunner</p></a></div> <div class="new-meta-item meta-tags"><a class="tag" href="/tags/接口自动化测试/" rel="nofollow"><i class="fas fa-tag" aria-hidden="true"></i><p>接口自动化测试</p></a></div>


        
      
        
          
  <div class="new-meta-item share -mob-share-list">
  <div class="-mob-share-list share-body">
    
      
        <a class="-mob-share-qq" title="QQ好友" rel="external nofollow noopener noreferrer"
          
          href="http://connect.qq.com/widget/shareqq/index.html?url=https://hellotaogang.github.io/2019/11/16/Python接口自动化测试框架实战开发（一）/&title=Python接口自动化测试框架实战开发（一） | TG'S BLOG&summary=该篇文章是博主一字一码编写的，实属不易，请尊重原创，谢谢大家！温馨提示：需要项目源码的朋友，请添加博主微信进行获取！
&nbsp;&nbsp;本文目录
一丶叙述
二丶接口基础知识
三丶接口测试工具
四丶Fiddler的使用
五丶unittest使用
六丶mock服务入门到实战
七丶接口自动化框架设计到开发"
          
          >
          
            <img src="https://cdn.jsdelivr.net/gh/xaoxuu/assets@19.1.9/logo/128/qq.png">
          
        </a>
      
    
      
        <a class="-mob-share-qzone" title="QQ空间" rel="external nofollow noopener noreferrer"
          
          href="https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=https://hellotaogang.github.io/2019/11/16/Python接口自动化测试框架实战开发（一）/&title=Python接口自动化测试框架实战开发（一） | TG'S BLOG&summary=该篇文章是博主一字一码编写的，实属不易，请尊重原创，谢谢大家！温馨提示：需要项目源码的朋友，请添加博主微信进行获取！
&nbsp;&nbsp;本文目录
一丶叙述
二丶接口基础知识
三丶接口测试工具
四丶Fiddler的使用
五丶unittest使用
六丶mock服务入门到实战
七丶接口自动化框架设计到开发"
          
          >
          
            <img src="https://cdn.jsdelivr.net/gh/xaoxuu/assets@19.1.9/logo/128/qzone.png">
          
        </a>
      
    
      
        <a class='qrcode' rel="external nofollow noopener noreferrer" href='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQ4AAAEOCAAAAABd2qZ5AAAD9UlEQVR42u3ay64aQQwEUP7/p4mUVSQyQ5XdcBXlzAohHtOHhbFdj0d8PX9fr49fX/Pn9fp88szVdX9vV5/5+MSFAwcOHDiCo97fRP6aFijBTd614caBAwcOHJ/gSIrr1eFnx9uU8BnH/Rlx4MCBA8f3OZLHpw6c38n+e3HgwIEDx89yzJq0ZMzXlu1TA00cOHDgwPEJjnzwN1sLzY6dN3L74SYOHDhw4DjFsQk0/CuPv5TvwIEDB47/nuNZXrPYwSzW0Jb25/rCgQMHDhx7jmTAlwcd8ufzenf1rtmPlwQscODAgQPHWY52tDcLtN2X1VkAbjasfFNoceDAgQPHiGMzVpsV6dmKaxZZaEefOHDgwIHjFMd9+cyL2Wy8OGvkisZsVphx4MCBA8eIY9aktaujPB4xGzK277r8NBw4cODAseZoX9oeoI0U5M+0Y8EDHS0OHDhw4LjlmN1QW5iTYWI0qlvf2xssHDhw4MDxAY6zR2oXSMnr27BC8S04cODAgWPNsSmTm/BBu+hqB5dtqX7s/zXgwIEDB454/ZOgbMaCm4VWfvgIBQcOHDhwrDnaKEAeEUiAZo1Zvk9r/yjgwIEDB46zHJu4wGZc2LaCm6NGfxpw4MCBA8eCYxMyyw/TfktONvv8y3fhwIEDB441x+xr8sOfCkbkB9uXfxw4cODAseFIVkH549nip+g1g0/YDC5x4MCBA8d3OGZDt/YAm6xfO7J8E2XAgQMHDhwLjs11f7AN2almcjgcxIEDBw4c67VTXt7aUF3e8tXtVvmTRD8VDhw4cOA4ytEugdqF02wQOWvk2jUYDhw4cOA4xbE55Gy9NAOaFemCYP+b48CBAweO8kXJ7W7avP0aaXaiqNDiwIEDB46YY/PFbQt3tiFsYxnR6gsHDhw4cKw5Zq1XO7ab/QCbAF8bwsOBAwcOHKc42nZrE1nbx+mS8tnmAS+jcjhw4MCBY8GRRxnyaNqs3LYrq1l84c1wEAcOHDhwrDny0pU3bLOma9YW5sX4zaAQBw4cOHAc4tg3ZptRY9LszSCSdvEvw0EcOHDgwLHmSAZnSQtU77vK97YrqzqrgAMHDhw41hyzIpoU5s8NEPdhuKKRw4EDBw4cJcezvDYlMC/kp/jqwBwOHDhw4FhzbNY5swBEuyKa/Qlo11o4cODAgeMsR1Jc86VU7r0fPub3XIwyceDAgQPHIY58iJZ88aYlmx1sFqorYg04cODAgeMDHLOFUz7IS0Z1bbGvG0IcOHDgwPF1jrYZyxc8CfSpkeWbWAMOHDhw4Fhz7Nuw/HPyGEE+NGyL97G1Ew4cOHDgWAca9uO8HDEPNCQNZLF8woEDBw4cE45ftA1yFF8CzmEAAAAASUVORK5CYII='>
        
          <img src="https://cdn.jsdelivr.net/gh/xaoxuu/assets@19.1.9/logo/128/wechat.png">
        
        </a>
      
    
      
        <a class="-mob-share-weibo" title="微博" rel="external nofollow noopener noreferrer"
          
          href="http://service.weibo.com/share/share.php?url=https://hellotaogang.github.io/2019/11/16/Python接口自动化测试框架实战开发（一）/&title=Python接口自动化测试框架实战开发（一） | TG'S BLOG&summary=该篇文章是博主一字一码编写的，实属不易，请尊重原创，谢谢大家！温馨提示：需要项目源码的朋友，请添加博主微信进行获取！
&nbsp;&nbsp;本文目录
一丶叙述
二丶接口基础知识
三丶接口测试工具
四丶Fiddler的使用
五丶unittest使用
六丶mock服务入门到实战
七丶接口自动化框架设计到开发"
          
          >
          
            <img src="https://cdn.jsdelivr.net/gh/xaoxuu/assets@19.1.9/logo/128/weibo.png">
          
        </a>
      
    
  </div>
</div>



        
      
    </div>
  </section>


      
      
          <div class="prev-next">
              
                  <section class="prev">
                      <span class="art-item-left">
                          <h6><i class="fas fa-chevron-left" aria-hidden="true"></i>&nbsp;上一页</h6>
                          <h4>
                              <a href="/2019/11/16/Python接口自动化测试框架实战开发（二）/" rel="prev" title="Python接口自动化测试框架实战开发（二）">
                                
                                    Python接口自动化测试框架实战开发（二）
                                
                              </a>
                          </h4>
                          
                              
                              <h6 class="tags">
                                  <a class="tag" href="/tags/Fiddler/"><i class="fas fa-tag fa-fw" aria-hidden="true"></i> Fiddler</a> <a class="tag" href="/tags/Unittest/"><i class="fas fa-tag fa-fw" aria-hidden="true"></i> Unittest</a> <a class="tag" href="/tags/HTMLTestRunner/"><i class="fas fa-tag fa-fw" aria-hidden="true"></i> HTMLTestRunner</a> <a class="tag" href="/tags/接口自动化测试/"><i class="fas fa-tag fa-fw" aria-hidden="true"></i> 接口自动化测试</a>
                              </h6>
                          
                      </span>
                  </section>
              
              
                  <section class="next">
                      <span class="art-item-right" aria-hidden="true">
                          <h6>下一页&nbsp;<i class="fas fa-chevron-right" aria-hidden="true"></i></h6>
                          <h4>
                              <a href="/2019/11/16/Django与Elasticsearch交互打造搜索引擎网站（二）/" rel="prev" title="Django与Elasticsearch交互打造搜索引擎网站（二）">
                                  
                                      Django与Elasticsearch交互打造搜索引擎网站（二）
                                  
                              </a>
                          </h4>
                          
                              
                              <h6 class="tags">
                                  <a class="tag" href="/tags/ElasticSearch/"><i class="fas fa-tag fa-fw" aria-hidden="true"></i> ElasticSearch</a> <a class="tag" href="/tags/Python-Scrapy分布式爬虫/"><i class="fas fa-tag fa-fw" aria-hidden="true"></i> Python Scrapy分布式爬虫</a> <a class="tag" href="/tags/数据抓取/"><i class="fas fa-tag fa-fw" aria-hidden="true"></i> 数据抓取</a> <a class="tag" href="/tags/Django-网站搭建/"><i class="fas fa-tag fa-fw" aria-hidden="true"></i> Django 网站搭建</a>
                              </h6>
                          
                      </span>
                  </section>
              
          </div>
      
    </section>
  </article>



  <!-- 显示推荐文章和评论 -->



  <article class="post white-box comments">
    <section class="article typo">
      <h4><i class="fas fa-comments fa-fw" aria-hidden="true"></i>&nbsp;评论</h4>
      
      
      
        <section id="comments">
          <div id="gitalk-container"></div>
        </section>
      
      
    </section>
  </article>






<!-- 根据页面mathjax变量决定是否加载MathJax数学公式js -->



  <script>
    window.subData = {
      title: 'Python接口自动化测试框架实战开发（一）',
      tools: true
    }
  </script>


</div>
<aside class='l_side'>
  
    
    
      
        
          
          
        
          
          
            
              
  <section class='widget toc-wrapper'>
    
<header class='pure'>
  <div><i class="fas fa-list fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;本文目录</div>
  
    <!-- <div class='wrapper'><a class="s-toc rightBtn" rel="external nofollow noopener noreferrer" href="javascript:void(0)"><i class="fas fa-thumbtack fa-fw"></i></a></div> -->
  
</header>

    <div class='content pure'>
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#一丶叙述"><span class="toc-text">一丶叙述</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#二丶接口基础知识"><span class="toc-text">二丶接口基础知识</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#三丶接口测试工具"><span class="toc-text">三丶接口测试工具</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#四丶Fiddler的使用"><span class="toc-text">四丶Fiddler的使用</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#五丶unittest使用"><span class="toc-text">五丶unittest使用</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#六丶mock服务入门到实战"><span class="toc-text">六丶mock服务入门到实战</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#七丶接口自动化框架设计到开发"><span class="toc-text">七丶接口自动化框架设计到开发</span></a></li></ol>
    </div>
  </section>


            
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
      
    

  
</aside>

<footer id="footer" class="clearfix">
  
  
    <div class="social-wrapper">
      
        
          <a href="http://wpa.qq.com/msgrd?v=3&amp;uin=1126331350&amp;site=qq&amp;menu=yes"
            class="social fab fa-qq flat-btn flat-btn"
            target="_blank"
            rel="external nofollow noopener noreferrer">
          </a>
        
      
        
          <a href="https://cdn.jsdelivr.net/gh/Hellotaogang/cdn@4.4/about/wxhy.png"
            class="social fab fa-weixin flat-btn flat-btn"
            target="_blank"
            rel="external nofollow noopener noreferrer">
          </a>
        
      
        
          <a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=cdtaogang@163.com"
            class="social fas fa-envelope flat-btn"
            target="_blank"
            rel="external nofollow noopener noreferrer">
          </a>
        
      
        
          <a href="https://github.com/Hellotaogang"
            class="social fab fa-github flat-btn"
            target="_blank"
            rel="external nofollow noopener noreferrer">
          </a>
        
      
        
          <a href="https://blog.csdn.net/qq_41782425"
            class="social fab fa-cuttlefish flat-btn flat-btn"
            target="_blank"
            rel="external nofollow noopener noreferrer">
          </a>
        
      
    </div>
  
  <br>
  <div><p>Copyright <i class='far fa-copyright'></i> 2019-2020 <a style='color: #333333' href='https://www.cdtaogang.top/' target='_blank'>TG’BLOG</a>&nbsp;&nbsp;|&nbsp;&nbsp;<span id='timeDate'>载入天数…</span><span id='times'>载入时分秒…</span></p>
</div>
  <br>
  <div>
    <div class='github-badge'> <a style='color: #fff' href='https://hexo.io/'><span class='badge-subject'>框架</span><span class='badge-value bg-blue'>Hexo</span></a> </div> <div class='github-badge'> <a style='color: #fff' href='https://github.com/'><span class='badge-subject'>托管</span><span class='badge-value bg-brightgreen'>GitHub</span></a> </div> <div class='github-badge'> <a style='color: #fff' href='https://www.aliyun.com/'><span class='badge-subject'>域名</span><span class='badge-value bg-firebrick'>Aliyun</span></a> </div> <div class='github-badge'> <a style='color: #fff' href='https://www.jsdelivr.com/'><span class='badge-subject'>内容分发网络</span><span class='badge-value bg-orange'>jsDelivr</span></a> </div> <div class='github-badge'> <a style='color: #fff' href='https://996.icu/#/zh_CN'><span class='badge-subject'>链接</span><span class='badge-value bg-red'>996.ICU</span></a> </div> <div class='github-badge'> <a style='color: #fff' href='https://xaoxuu.com/wiki/material-x/'><span class='badge-subject'>主题</span><span class='badge-value bg-blue'>Material X</span></a> </div> <div class='github-badge'> <a style='color: #fff' href='https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh'><span class='badge-subject'>协议</span><span class='badge-value bg-pink'>BY-NC-SA 4.0</span></a> </div>
  </div>
<script>
    var now = new Date(); 
    function createtime() { 
        var grt= new Date("10/11/2019 21:38:00");//在此处修改你的建站时间
        now.setTime(now.getTime()+250); 
        days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days); 
        hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours); 
        if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum); 
        mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;} 
        seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum); 
        snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;} 
        document.getElementById("timeDate").innerHTML = "本站已安全运行 "+dnum+" 天 "; 
        document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒"; 
    } 
setInterval("createtime()",250);
</script>
</footer>
<script>setLoadingBarProgress(80);</script>



      <script>setLoadingBarProgress(60);</script>
    </div>
    <a class="s-top fas fa-arrow-up fa-fw" href='javascript:void(0)'></a>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>

  <script>
    var GOOGLE_CUSTOM_SEARCH_API_KEY = "";
    var GOOGLE_CUSTOM_SEARCH_ENGINE_ID = "";
    var ALGOLIA_API_KEY = "";
    var ALGOLIA_APP_ID = "";
    var ALGOLIA_INDEX_NAME = "";
    var AZURE_SERVICE_NAME = "";
    var AZURE_INDEX_NAME = "";
    var AZURE_QUERY_KEY = "";
    var BAIDU_API_ID = "";
    var SEARCH_SERVICE = "hexo" || "hexo";
    var ROOT = "/"||"/";
    if(!ROOT.endsWith('/'))ROOT += '/';
  </script>

<script src="//instant.page/1.2.2" type="module" integrity="sha384-2xV8M5griQmzyiY3CDqh1dn4z3llDVqZDqzjzcY+jCBCk/a5fXJmuZ/40JJAPeoU"></script>


  <script async src="https://cdn.jsdelivr.net/npm/scrollreveal@4.0.5/dist/scrollreveal.min.js"></script>
  <script type="text/javascript">
    $(function() {
      const $reveal = $('.reveal');
      if ($reveal.length === 0) return;
      const sr = ScrollReveal({ distance: 0 });
      sr.reveal('.reveal');
    });
  </script>


  <script src="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.js"></script>
  <script type="text/javascript">
    $(function() {
      Waves.attach('.flat-btn', ['waves-button']);
      Waves.attach('.float-btn', ['waves-button', 'waves-float']);
      Waves.attach('.float-btn-light', ['waves-button', 'waves-float', 'waves-light']);
      Waves.attach('.flat-box', ['waves-block']);
      Waves.attach('.float-box', ['waves-block', 'waves-float']);
      Waves.attach('.waves-image');
      Waves.init();
    });
  </script>


  <script async src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-busuanzi@2.3/js/busuanzi.pure.mini.js"></script>




  
  
  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-backstretch/2.0.4/jquery.backstretch.min.js"></script>
    <script type="text/javascript">
      $(function(){
        if ('.cover') {
          $('.cover').backstretch(
          ["https://cdn.jsdelivr.net/gh/Hellotaogang/cdn@4.5.7/images/background_4.jpg", "https://cdn.jsdelivr.net/gh/Hellotaogang/cdn@4.5.7/images/background_5.jpg", "https://cdn.jsdelivr.net/gh/Hellotaogang/cdn@4.5.7/images/background_6.jpg"],
          {
            duration: "6000",
            fade: "2500"
          });
        } else {
          $.backstretch(
          ["https://cdn.jsdelivr.net/gh/Hellotaogang/cdn@4.5.7/images/background_4.jpg", "https://cdn.jsdelivr.net/gh/Hellotaogang/cdn@4.5.7/images/background_5.jpg", "https://cdn.jsdelivr.net/gh/Hellotaogang/cdn@4.5.7/images/background_6.jpg"],
          {
            duration: "6000",
            fade: "2500"
          });
        }
      });
    </script>
  







  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
  <script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
  <script src="https://cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.min.js"></script>
  <script type="text/javascript">
    var gitalk = new Gitalk({
      clientID: "71020b6958cd6bbf65b7",
      clientSecret: "3cfeccd9125b8bac76f2bd8a7f6e30a601ae3a81",
      repo: "Hellotaogang.github.io",
      owner: "Hellotaogang",
      admin: "Hellotaogang",
      
        id: md5(location.pathname),      // Ensure uniqueness and length less than 50
      
      distractionFreeMode: false  // Facebook-like distraction free mode
    });
    gitalk.render('gitalk-container');
  </script>





  <script src="/js/app.js"></script>


  <script src="/js/search.js"></script>




<!-- 复制 -->
<script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script>
  let COPY_SUCCESS = "复制成功";
  let COPY_FAILURE = "复制失败";
  /*页面载入完成后，创建复制按钮*/
  !function (e, t, a) {
    /* code */
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '  <i class="fa fa-copy"></i><span>复制</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });

      clipboard.on('success', function(e) {
        //您可以加入成功提示
        console.info('Action:', e.action);
        console.info('Text:', e.text);
        console.info('Trigger:', e.trigger);
        success_prompt(COPY_SUCCESS);
        e.clearSelection();
      });
      clipboard.on('error', function(e) {
        //您可以加入失败提示
        console.error('Action:', e.action);
        console.error('Trigger:', e.trigger);
        fail_prompt(COPY_FAILURE);
      });
    }
    initCopyCode();

  }(window, document);

  /**
   * 弹出式提示框，默认1.5秒自动消失
   * @param message 提示信息
   * @param style 提示样式，有alert-success、alert-danger、alert-warning、alert-info
   * @param time 消失时间
   */
  var prompt = function (message, style, time)
  {
      style = (style === undefined) ? 'alert-success' : style;
      time = (time === undefined) ? 1500 : time*1000;
      $('<div>')
          .appendTo('body')
          .addClass('alert ' + style)
          .html(message)
          .show()
          .delay(time)
          .fadeOut();
  };

  // 成功提示
  var success_prompt = function(message, time)
  {
      prompt(message, 'alert-success', time);
  };

  // 失败提示
  var fail_prompt = function(message, time)
  {
      prompt(message, 'alert-danger', time);
  };

  // 提醒
  var warning_prompt = function(message, time)
  {
      prompt(message, 'alert-warning', time);
  };

  // 信息提示
  var info_prompt = function(message, time)
  {
      prompt(message, 'alert-info', time);
  };

</script>


<!-- fancybox -->
<script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>
<script>
  let LAZY_LOAD_IMAGE = "";
  $(".article-entry").find("fancybox").find("img").each(function () {
      var element = document.createElement("a");
      $(element).attr("data-fancybox", "gallery");
      $(element).attr("href", $(this).attr("src"));
      /* 图片采用懒加载处理时,
       * 一般图片标签内会有个属性名来存放图片的真实地址，比如 data-original,
       * 那么此处将原本的属性名src替换为对应属性名data-original,
       * 修改如下
       */
       if (LAZY_LOAD_IMAGE) {
         $(element).attr("href", $(this).attr("data-original"));
       }
      $(this).wrap(element);
  });
</script>





  <script>setLoadingBarProgress(100);</script>
  <!-- 页面点击小红心 -->
  <!-- <script type="text/javascript" src="/js/love.js"></script> -->
  <!--单击显示文字-->
  <!-- <script type="text/javascript" src="/js/click_show_text.js"></script> -->
  <!-- 鼠标点击烟花 -->
  <!-- <canvas class="fireworks" style="position: fixed;left: 0;top: 0;z-index: 1; pointer-events: none;" ></canvas> 
  <script type="text/javascript" src="//cdn.bootcss.com/animejs/2.2.0/anime.min.js"></script> 
  <script type="text/javascript" src="/js/fireworks.js"></script> -->
  <!--浏览器搞笑标题-->
  <script type="text/javascript" src="\js\FunnyTitle.js"></script>
  <!--动态线条背景-->
  <script type="text/javascript"
color="0,0,0" opacity='0.7' zIndex="-2" count="200" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js">
  </script>
  <!-- 样式一（鼠标点击更换样式） -->
<!-- <script src="https://g.joyinshare.com/hc/ribbon.min.js" type="text/javascript"></script> -->
<!-- 样式二（飘动的彩带） -->
<!-- <script src="https://g.joyinshare.com/hc/piao.js" type="text/javascript"></script> -->
  <!-- 数字雨 -->
  <!-- <canvas id="canvas" width="1440" height="900" ></canvas>
  <script type="text/javascript" src="/js/DigitalRain.js"></script> -->
</body>
</html>
