<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  
  <title>Python接口自动化测试框架实战开发（二） | TG&#39;S BLOG</title>
  
  
  <meta name="description" content="该篇文章是博主一字一码编写的，实属不易，请尊重原创，谢谢大家！">
  

  

  <meta name="HandheldFriendly" content="True">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <!-- meta -->
  

  <!-- link -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css">
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.css">
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.10.1/css/all.min.css">
  

  
  <link rel="shortcut icon" type="image/x-icon" href="https://cdn.jsdelivr.net/gh/Hellotaogang/cdn@4.3/images/favicon.ico">
  

  
    <link rel="stylesheet" href="/style.css">
  

  <script>
    function setLoadingBarProgress(num) {
      document.getElementById('loading-bar').style.width=num+"%";
    }
  </script>

  
  
</head>

<body>
  
  
  <div class="cover-wrapper">
    <cover class='cover post half'>
      
        
  <img class='logo' src='https://cdn.jsdelivr.net/gh/Hellotaogang/cdn@4.5.6/images/logo_2.png'/>


  <div class="m_search">
    <form name="searchform" class="form u-search-form">
      <input type="text" class="input u-search-input" placeholder="" />
      <i class="icon fas fa-search fa-fw"></i>
    </form>
  </div>

<div class='menu navgation'>
  <ul class='h-list'>
    
      
        <li>
          <a class="nav home" href="/"
            
            
            id="home">
            <i class='fas fa-home fa-fw'></i>&nbsp;主页
          </a>
        </li>
      
        <li>
          <a class="nav home" href="/categories/"
            
            
            id="categories">
            <i class='fas fa-folder-open fa-fw'></i>&nbsp;分类
          </a>
        </li>
      
        <li>
          <a class="nav home" href="/tags/"
            
              rel="nofollow"
            
            
            id="tags">
            <i class='fas fa-tags fa-fw'></i>&nbsp;标签
          </a>
        </li>
      
        <li>
          <a class="nav home" href="/love/"
            
              rel="nofollow"
            
            
            id="love">
            <i class='fas fa-heart fa-fw'></i>&nbsp;记录
          </a>
        </li>
      
        <li>
          <a class="nav home" href="/about/"
            
              rel="nofollow"
            
            
            id="about">
            <i class='fas fa-info-circle fa-fw'></i>&nbsp;关于
          </a>
        </li>
      
    
  </ul>
</div>

      
    </cover>
    <header class="l_header pure">
  <div id="loading-bar-wrapper">
    <div id="loading-bar" class="pure"></div>
  </div>

	<div class='wrapper'>
		<div class="nav-main container container--flex">
      <a class="logo flat-box" href='/' >
        
          TG'S BLOG
        
      </a>
			<div class='menu navgation'>
				<ul class='h-list'>
          
  					
  						<li>
								<a class="nav flat-box" href="/"
                  
                  
                  id="home">
									<i class='fas fa-home fa-fw'></i>&nbsp;主页
								</a>
							</li>
      			
  						<li>
								<a class="nav flat-box" href="/categories/"
                  
                    rel="nofollow"
                  
                  
                  id="categories">
									<i class='fas fa-folder-open fa-fw'></i>&nbsp;分类
								</a>
							</li>
      			
  						<li>
								<a class="nav flat-box" href="/tags/"
                  
                    rel="nofollow"
                  
                  
                  id="tags">
									<i class='fas fa-tags fa-fw'></i>&nbsp;标签
								</a>
							</li>
      			
  						<li>
								<a class="nav flat-box" href="/archives/"
                  
                    rel="nofollow"
                  
                  
                  id="archives">
									<i class='fas fa-archive fa-fw'></i>&nbsp;归档
								</a>
							</li>
      			
  						<li>
								<a class="nav flat-box" href="/love/"
                  
                    rel="nofollow"
                  
                  
                  id="love">
									<i class='fas fa-heart fa-fw'></i>&nbsp;记录
								</a>
							</li>
      			
  						<li>
								<a class="nav flat-box" href="/about/"
                  
                    rel="nofollow"
                  
                  
                  id="about">
									<i class='fas fa-info-circle fa-fw'></i>&nbsp;关于
								</a>
							</li>
      			
      		
				</ul>
			</div>

			
				<div class="m_search">
					<form name="searchform" class="form u-search-form">
						<input type="text" class="input u-search-input" placeholder="搜索" />
						<i class="icon fas fa-search fa-fw"></i>
					</form>
				</div>
			
			<ul class='switcher h-list'>
				
					<li class='s-search'><a class="fas fa-search fa-fw" href='javascript:void(0)'></a></li>
				
				<li class='s-menu'><a class="fas fa-bars fa-fw" href='javascript:void(0)'></a></li>
			</ul>
		</div>

		<div class='nav-sub container container--flex'>
			<a class="logo flat-box"></a>
			<ul class='switcher h-list'>
				<li class='s-comment'><a class="flat-btn fas fa-comments fa-fw" href='javascript:void(0)'></a></li>
        
          <li class='s-toc'><a class="flat-btn fas fa-list fa-fw" href='javascript:void(0)'></a></li>
        
			</ul>
		</div>
	</div>
</header>
	<aside class="menu-phone">
    <header>
		<nav class="menu navgation">
      <ul>
        
          
            <li>
							<a class="nav flat-box" href="/"
                
                
                id="home">
								<i class='fas fa-clock fa-fw'></i>&nbsp;近期文章
							</a>
            </li>
          
            <li>
							<a class="nav flat-box" href="/blog/archives/"
                
                  rel="nofollow"
                
                
                id="blogarchives">
								<i class='fas fa-archive fa-fw'></i>&nbsp;文章归档
							</a>
            </li>
          
            <li>
							<a class="nav flat-box" href="/projects/"
                
                
                id="projects">
								<i class='fas fa-code-branch fa-fw'></i>&nbsp;开源项目
							</a>
            </li>
          
            <li>
							<a class="nav flat-box" href="/friends/"
                
                  rel="nofollow"
                
                
                id="friends">
								<i class='fas fa-link fa-fw'></i>&nbsp;我的友链
							</a>
            </li>
          
            <li>
							<a class="nav flat-box" href="https://xaoxuu.com/wiki/material-x/"
                
                  rel="nofollow"
                
                
                id="https:xaoxuu.comwikimaterial-x">
								<i class='fas fa-book fa-fw'></i>&nbsp;主题文档
							</a>
            </li>
          
            <li>
							<a class="nav flat-box" href="/about/"
                
                  rel="nofollow"
                
                
                id="about">
								<i class='fas fa-info-circle fa-fw'></i>&nbsp;关于小站
							</a>
            </li>
          
       
      </ul>
		</nav>
    </header>
	</aside>
<script>setLoadingBarProgress(40);</script>

  </div>


  <div class="l_body">
    <div class='body-wrapper'>
      <div class='l_main'>
  

  <article id="post" class="post white-box article-type-post" itemscope itemprop="blogPost">
    


  <section class='meta'>
    
    
      <a title='Python接口自动化测试框架实战开发（二）' href='/2019/11/16/Python接口自动化测试框架实战开发（二）/'><img class='thumbnail' src='https://cdn.jsdelivr.net/gh/Hellotaogang/cdn@4.6.5/images/python.png'></a>
    
    <div class="meta" id="header-meta">
      
        
  
    <h1 class="title">
      <a href="/2019/11/16/Python接口自动化测试框架实战开发（二）/">
        Python接口自动化测试框架实战开发（二）
      </a>
    </h1>
  


      
      <div class='new-meta-box'>
        
          
        
          
            
  <div class='new-meta-item author'>
    
      <a href="/" rel="nofollow">
        
          <img src="https://cdn.jsdelivr.net/gh/Hellotaogang/cdn@4.4.3/images/avatar_4.png">
        
        <p>cdtaogang</p>
      </a>
    
  </div>


          
        
          
            <div class="new-meta-item date">
  <a class='notlink'>
    <i class="fas fa-calendar-alt" aria-hidden="true"></i>
    <p>2019-11-16</p>
  </a>
</div>

          
        
          
            
  
  <div class='new-meta-item category'>
    <a href='/categories/自动化测试框架/' rel="nofollow">
      <i class="fas fa-folder-open" aria-hidden="true"></i>
      <p>自动化测试框架</p>
    </a>
  </div>


          
        
          
            
  
    <div class="new-meta-item browse busuanzi">
      <a class='notlink'>
        <i class="fas fa-eye" aria-hidden="true"></i>
        <p>
          <span id="busuanzi_value_page_pv">
            <i class="fas fa-spinner fa-spin fa-fw" aria-hidden="true"></i>
          </span>
        </p>
      </a>
    </div>
  


          
        
          
            

          
        
      </div>
      
        <hr>
      
    </div>
  </section>


    <section class="article typo">
      <div class="article-entry" itemprop="articleBody">
        <p>该篇文章是博主一字一码编写的，实属不易，请尊重原创，谢谢大家！<br><font style="color:red">温馨提示：需要项目源码的朋友，请添加博主微信进行获取！</font></p>
<div style="color:#fb651b"><i class="fas fa-list fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;本文目录</div>
<li class="toc-item toc-level-1"><a style=" text-decoration:none;" href="#七丶接口自动化框架设计到开发"><span style="color:#4ea1db">七丶接口自动化框架设计到开发</span></a></li>
<li class="toc-item toc-level-1"><a style=" text-decoration:none;" href="#八丶持续集成"><span style="color:#4ea1db">八丶持续集成</span></a></li>
<li class="toc-item toc-level-1"><a style=" text-decoration:none;" href="#九丶获取cookie及请求处理"><span style="color:#4ea1db">九丶获取cookie及请求处理</span></a></li>
<a id="more"></a>

<h1 id="七丶接口自动化框架设计到开发"><a href="#七丶接口自动化框架设计到开发" class="headerlink" title="七丶接口自动化框架设计到开发"></a>七丶接口自动化框架设计到开发</h1><p><strong>14.数据依赖问题从设计思路开始</strong></p>
<p><strong>说明：</strong>博主之前的测试的app不存在数据依赖的接口，所以博主这里下载了苏宁易购，用其下单以及支付两个接口来说明接口数据依赖</p>
<ul>
<li>在苏宁易购上选择一款手机，点击立即购买后选择购买的内存以及颜色后，点击确定跳转到订单页面，如下图所示</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190624114046158.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>通过fiddler抓取下单的接口，该接口返回的数据中可以看出cart2No=620200000207514372，该商品的订单编号以及customerNo=7157450907客户编号</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190624114122985.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>在订单页面，点击提交订单，抓取提交订单接口，该接口post请求data数据中的cart2No参数的值，该值就是服务器返回下单接口的数据，这就是所谓的接口数据依赖，需要说明的是，提交订单的接口服务器返回的响应为errorMessage=销售火爆，请稍后再试(E234)，博主测试其他的商品都是提示该错误信息，说明苏定的app此时不能进行购买商品</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190624114606834.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>博主整理了一下整个下单和支付的接口已经请求数据和响应数据</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"># 下单</span><br><span class="line">request_url = &quot;https://shopping.suning.com/app/addcart/private/quickBuy.do&quot;</span><br><span class="line">request_data = &#123;</span><br><span class="line">    &quot;data&quot;:&#123;&quot;cartHeadInfo&quot;:</span><br><span class="line">    &#123;&quot;userFlag&quot;:&quot;0&quot;,&quot;directFlag&quot;:&quot;1&quot;,&quot;operationChannel&quot;:&quot;50&quot;,</span><br><span class="line">    &quot;operationTerminal&quot;:&quot;01&quot;,&quot;operationEquipment&quot;:&quot;02&quot;,&quot;operationUser&quot;:&quot;&quot;,</span><br><span class="line">    &quot;token&quot;:&quot;0706172998861561345578681_3989FF3858C23E2FE49FB96928935FC51BC2D7E2B00145D19087E1232123D1E2F6AEA7E5A1D95F2B9BC731F5FA0F0B48&quot;,</span><br><span class="line">    &quot;detect&quot;:&quot;mmds_a_._920c68ed-4fcc-440e-a717-28b23d2a26fd_._YQQQ**1_PaaX*C****4*n**1_Paa0*C**1-D*n******2_*****oy****1_PbTSXH*1J54.o*******1XH**1LD.o*o1_PaA7XH****k.o******Pv****Pdy****1_P0DZcc**iU4Mq**1_P0DZcc**1-DMq**1_PcB_c2**lm4M9**1_PcB_c2**1-DM9******MS****OHy****1_Pc9*ce**GH4YZ**1_Pc9*ce**1kDYZ**1_Pc9*ce**Iq4YZ**1_Pc9*ce**17DYZ**1_Pc9*cH**DU4Yn**1_Pc9*cH**1CDYn**1_Pc9*cc**3m4Yn**1_Pc9*cc**P3DYn**1_Pc9*cd**X0441**1_Pc9*cd**1AD41**1_Pc9*cm**3R44Z**1_Pc9*cZ**1-D4Z**1_Pc9*cZ**Pa44Z**1_Pc9*cZ**1oD4Z*******1cZ**1p44Z**1_Pc9*cZ**ReD4Z**1_Pc9*cZ**1m44Z**1_Pc9*cZ**1lD4Z**1_Pc9*cm**1X44Z**1_Pc9*cm**1eD4Z**1_Pc9*ck**1l44Z**1_Pc9*ck**1lD4Z**1_Pc9*ck**Px44Z**1_Pc9*ck****D4Z**1_Pc9*cL**9m4Y_**1_Pc9*cL**1kDY_*******1cL**1S4Y_**1_Pc9*cL**RkD41**1_Pc9*cJ**18441**1_Pc9*cJ**1iD41**1_Pc9*cJ**1m441**1_Pc9*cJ**1kD41**1_Pc9*ch*1Sx441**1_Pc9*ch**1aD41**1_P0jS*yPUup4*4**1_P0jS*y**1_D*4******Pv*****ty****1_P0DZch*1WE4Ob**1_P0DZch**1xDOb**1_PcB_c0**fx4M0**1_PcB_c0**1oDM0******MS****3Sy********Pv***J*Ey********2_****ixy****1_PbTS*y**UZ4*d**1_PaPK*y**1XD*d******2N*****By****1_PaPi*v**KZ4*n**1_PaPi*v**POD*n******RA*****hy****1_PcVIcd**qr449*******1cd**POD49**1_PbZJM1**if4YK**1_PavoM1**PXDYK******.p****13y****1_PcjG2E*EhR42N*******12E**1oD2N******Pv****POy****1_PaaX*5*.xf4*j**1_Paa0*5**1CD*j******.p*****qy****1_PcjG2a**uo42x*******12a**PeD2x******Pv****1zy****1_P0DZcc**C84O4**1_P0DZcc**P*DO4**1_PcB_cc*P9m42a**1_PcB_cc**P3D2aQQQNvJjJhSpefQQQMMceTs**aYcXDfPGXDsuXcYGMXuCaebCQQQMDYaPPYKtBQQQMDMYuQQQMQQQP*sPYDCXXPDsaQQQMQPQMf46724f27b81204df0356ffa5666c5ec&quot;,&quot;dfpToken&quot;:&quot;TFItvV179MauUij2SsWqz0b18&quot;,&quot;operationStoreCode&quot;:&quot;&quot;,&quot;provinceCode&quot;:&quot;020&quot;,&quot;cityCode&quot;:&quot;021&quot;,&quot;districtCode&quot;:&quot;02111&quot;,&quot;logContent&quot;:&quot;&quot;&#125;,</span><br><span class="line">    &quot;immediateBuyItems&quot;:[&#123;&quot;itemHeadInfo&quot;:&#123;&quot;itemNo&quot;:&quot;1&quot;,&quot;activityType&quot;:&quot;01&quot;,&quot;activityId&quot;:&quot;&quot;&#125;,</span><br><span class="line">    &quot;mainCmmdtyInfo&quot;:&#123;&quot;basicInfo&quot;:&#123;&quot;itemNo&quot;:&quot;1&quot;,&quot;cmmdtyCode&quot;:&quot;000000010985369117&quot;,&quot;shopCode&quot;:&quot;0000000000&quot;,&quot;shopAddCode&quot;:&quot;0030001790&quot;,&quot;shopName&quot;:&quot;苏宁自营&quot;,&quot;overSeasFlag&quot;:&quot;&quot;,&quot;cmmdtyQty&quot;:&quot;1&quot;,&quot;serviceStoreCode&quot;:&quot;&quot;,&quot;serviceStoreName&quot;:&quot;&quot;,&quot;commodityType&quot;:&quot;&quot;,&quot;carShopSerWay&quot;:&quot;&quot;&#125;&#125;&#125;],</span><br><span class="line">    &quot;supportYB&quot;:&quot;1&quot;,&quot;publishDate&quot;:&quot;20190508&quot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">response_data = &#123;</span><br><span class="line">&quot;api&quot;:&quot;ccf.cart1.quickbuy&quot;,</span><br><span class="line">&quot;code&quot;:&quot;1&quot;,</span><br><span class="line">&quot;data&quot;:&#123;&quot;errorInfos&quot;:[],&quot;result&quot;:&#123;&quot;cart2No&quot;:&quot;620200000207521425&quot;,&quot;customerNo&quot;:&quot;7157450907&quot;,&quot;isSuccess&quot;:&quot;Y&quot;,&quot;reserve&quot;:&quot;&quot;,&quot;safeDps&quot;:&quot;0&quot;,&quot;showRecommend&quot;:&quot;1&quot;&#125;&#125;,</span><br><span class="line">&quot;msg&quot;:&quot;&quot;,&quot;v&quot;:&quot;1.0&quot;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">cart2No = response_data[&quot;data&quot;][&quot;result&quot;][&quot;cart2No&quot;]</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"># 支付</span><br><span class="line">request_url = &quot;https://shopping.suning.com/app/V2/private/confirmOrder.do&quot;</span><br><span class="line">request_data = &#123;&quot;cart2No&quot;:cart2No,</span><br><span class="line">&quot;salesPerson&quot;:&quot;&quot;,</span><br><span class="line">&quot;channelType&quot;:02,</span><br><span class="line">&quot;terminalVersion&quot;:MOBILE|02|01|7.7.3|11007,</span><br><span class="line">&quot;terminalModel&quot;:HUAWEI|DUK-AL20,</span><br><span class="line">&quot;orderMemoJson&quot;:[],</span><br><span class="line">&quot;saleChannel&quot;:000000011116457666|9264|121.492479|31.247221|00|06|;000000011039772482|9264|121.492479|31.247221|00|06|,</span><br><span class="line">&quot;showGift&quot;:1,</span><br><span class="line">&quot;cipher&quot;:&quot;&quot;,  </span><br><span class="line">&quot;detect&quot;:&quot;mmds_a_._920c68ed-4fcc-440e-a717-28b23d2a26fd_._YQQQ**1_Pc9*cd****DY5**1_Pc9*cd**jx4Y5**1_Pc9*cd**PODY5**1_Pc9*cd**9T4Y5**1_Pc9*cd**PMDY5**1_Pc9*cd**X04Y5**1_Pc9*cd**PeDY5**1_Pc9*cd**4q4Y5**1_Pc9*cd**PkDY5**1_Pc9*cd**Dm4Y5**1_Pc9*cd**PkDY5**1_Pc9*cd**E34Y5**1_Pc9*cd**PlDY5**1_P0jS*y*SjM4*X**1_P0jS*y**1ND*X******Pv*****ty****1_P0DZcH*11i42u**1_P0DZcH**1_D2u**1_PcB_cD**mY42A**1_PcB_cD**1oD2A******MS****Muy****1_P0jS*_**pG4*m**1_P0jS*_**1SD*m******Pv*****qy****1_P0DZci*3bJ4MK**1_P0DZci**1-DMK**1_PcB_c**YjB4RB**1_PcB_c***1oDRB******MS****MPy****1_Pc9*ct*1To4YC**1_Pc9*ct**1CDYC**1_P0jS*C1sPt4*J**1_P0jS*C**1CD*J******Pv*****yy****1_PaaX*C**E-4*n**1_Paa0*C**1-D*n******2_*****oy****1_PbTSXH*1J54.o*******1XH**1LD.o*o1_PaA7XH****k.o******Pv****Pdy****1_P0DZcc**iU4Mq**1_P0DZcc**1-DMq**1_PcB_c2**lm4M9**1_PcB_c2**1-DM9******MS****OHy****1_Pc9*ce**GH4YZ**1_Pc9*ce**1kDYZ**1_Pc9*ce**Iq4YZ**1_Pc9*ce**17DYZ**1_Pc9*cH**DU4Yn**1_Pc9*cH**1CDYn**1_Pc9*cc**3m4Yn**1_Pc9*cc**P3DYn**1_Pc9*cd**X0441**1_Pc9*cd**1AD41**1_Pc9*cm**3R44Z**1_Pc9*cZ**1-D4Z**1_Pc9*cZ**Pa44Z**1_Pc9*cZ**1oD4Z*******1cZ**1p44Z**1_Pc9*cZ**ReD4Z**1_Pc9*cZ**1m44Z**1_Pc9*cZ**1lD4Z**1_Pc9*cm**1X44Z**1_Pc9*cm**1eD4Z**1_Pc9*ck**1l44Z**1_Pc9*ck**1lD4Z**1_Pc9*ck**Px44Z**1_Pc9*ck****D4Z**1_Pc9*cL**9m4Y_**1_Pc9*cL**1kDY_*******1cL**1S4Y_**1_Pc9*cL**RkD41**1_Pc9*cJ**18441**1_Pc9*cJ**1iD41**1_Pc9*cJ**1m441**1_Pc9*cJ**1kD41**1_Pc9*ch*1Sx441**1_Pc9*ch**1aD41QQQNvJjJhSpefQQQMMceTs**aYcXDfPGXDsuXcYGMXuCaebCQQQsaCMDCXuDYQQQMDMYuQQQMQQQP*sPYDCMMusCuQQQMQPQM73a04a9cdb50e2faa2bf8d79252434e3&quot;,</span><br><span class="line">&quot;dfpToken&quot;:&quot;TFItvV179MauUij2SsWqz0b18&quot;,</span><br><span class="line">&quot;deviceNo&quot;:&quot;868334782216554&quot;,</span><br><span class="line">&quot;specDesc&quot;:[&#123;&quot;itemNo&quot;:&quot;620200000344251973&quot;,&quot;pictureLink&quot;:&quot;\/\/imgservice.suning.cn\/uimg1\/b2c\/image\/5lHDNQYOPSu5tQWQt9JdHA.jpg&quot;,&quot;specInfos&quot;:[&#123;&quot;specTypeName&quot;:&quot;颜色&quot;,&quot;specContent&quot;:&quot;秘境黑&quot;&#125;,&#123;&quot;specTypeName&quot;:&quot;规格&quot;,&quot;specContent&quot;:&quot;6GB+64GB&quot;&#125;]&#125;],</span><br><span class="line">&quot;splitFlag&quot;:01,</span><br><span class="line">&quot;publishDate&quot;: 20190508,</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">response_data = &#123;</span><br><span class="line">&quot;api&quot;:&quot;ccf.cart2.submitOrder&quot;,</span><br><span class="line">&quot;code&quot;:&quot;1&quot;,</span><br><span class="line">&quot;data&quot;:&#123;&quot;cardInfoss&quot;:[],&quot;cartHeadInfo&quot;:&#123;&quot;alipayWakeFlag&quot;:&quot;1&quot;,&quot;cart2No&quot;:&quot;&quot;,&quot;customerNo&quot;:&quot;&quot;,&quot;dfpTokenStatus&quot;:&quot;&quot;,&quot;isSuccess&quot;:&quot;N&quot;,&quot;miniCartRouteSwitch&quot;:&quot;&quot;,&quot;payStatus&quot;:&quot;&quot;,&quot;toastTime&quot;:&quot;5&quot;&#125;,</span><br><span class="line">&quot;errorInfos&quot;:[&#123;&quot;cmmdtyPrice&quot;:&quot;&quot;,&quot;dareType&quot;:&quot;&quot;,&quot;earlyPrice&quot;:&quot;&quot;,</span><br><span class="line">&quot;errorCode&quot;:&quot;CSC-71-0002&quot;,</span><br><span class="line">&quot;errorMessage&quot;:&quot;销售火爆，请稍后再试(E234)&quot;,</span><br><span class="line">&quot;itemNo&quot;:&quot;0&quot;,&quot;itemType&quot;:&quot;0&quot;,&quot;needImageCode&quot;:&quot;&quot;,&quot;ticket&quot;:&quot;&quot;&#125;],</span><br><span class="line">&quot;orderItems&quot;:[],&quot;voucherInfoss&quot;:[]&#125;,</span><br><span class="line">&quot;msg&quot;:&quot;&quot;,&quot;v&quot;:&quot;1.0&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>接下来博主就需要将框架最开始的基础信息进行变更，在excel表中中添加一列header数据，因为订单先关的接口需要传递header来验证登录状态</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/2019062415093278.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>就需要在data_conf.py文件中进行添加获取该列的索引值</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">global_var</span>:</span></span><br><span class="line">    id = <span class="string">'0'</span>  <span class="comment"># id</span></span><br><span class="line">    module = <span class="string">'1'</span>  <span class="comment"># 模块</span></span><br><span class="line">    url = <span class="string">'2'</span>  <span class="comment"># url</span></span><br><span class="line">    run = <span class="string">'3'</span>  <span class="comment"># 是否运行</span></span><br><span class="line">    request_type = <span class="string">'4'</span>  <span class="comment"># 请求类型</span></span><br><span class="line">    request_header = <span class="string">'5'</span>  <span class="comment"># 是否携带header</span></span><br><span class="line">    case_depend = <span class="string">'6'</span>  <span class="comment"># case依赖</span></span><br><span class="line">    response_data_depend = <span class="string">'7'</span>  <span class="comment"># 依赖的返回数据</span></span><br><span class="line">    data_depend = <span class="string">'8'</span>  <span class="comment">#  数据依赖</span></span><br><span class="line">    request_header_data = <span class="string">'9'</span>  <span class="comment"># header值</span></span><br><span class="line">    request_data = <span class="string">'10'</span>  <span class="comment"># 请求数据</span></span><br><span class="line">    expect_result = <span class="string">'11'</span>  <span class="comment"># 预期结果</span></span><br><span class="line">    reality_result = <span class="string">'12'</span>  <span class="comment"># 实际结果</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_request_header_data</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> global_var.request_header_data</span><br></pre></td></tr></table></figure>

<ul>
<li>在data_get.py数据获取模块中需要添加两个方法来分别获取excel表header列的数据以及操作获取json表中的键为header值的请求数据data和请求头数据header</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_request_header_data</span><span class="params">(self, x)</span>:</span></span><br><span class="line">    <span class="string">"""获取excel表中的header的数据"""</span></span><br><span class="line">    y = int(data_conf.get_request_header_data())</span><br><span class="line">    header_data = self.op_excel.get_cell_value(x, y)</span><br><span class="line">    <span class="comment"># print("header_data", header_data)</span></span><br><span class="line">    <span class="keyword">if</span> header_data == <span class="string">''</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    <span class="keyword">return</span> header_data</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_data_for_header</span><span class="params">(self, x)</span>:</span></span><br><span class="line">    <span class="string">"""通过在excel表中获取的关键字数据到json表中获取对应的数据"""</span></span><br><span class="line">    op_header = operationJson()</span><br><span class="line">    header_data = op_header.get_key_words(self.get_request_header_data(x))</span><br><span class="line">    <span class="comment"># print("header_data", header_data)</span></span><br><span class="line">    <span class="keyword">return</span> header_data</span><br></pre></td></tr></table></figure>

<ul>
<li>还需要修改启动文件中的header的获取调用方法</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> row_count <span class="keyword">in</span> range(<span class="number">1</span>, row_counts):</span><br><span class="line">    <span class="comment"># print(row_count) 1,2,3,4</span></span><br><span class="line">    url = self.data.get_request_url(row_count)  <span class="comment"># y行不变遍历获取x列的请求地址</span></span><br><span class="line">    method = self.data.get_request_method(row_count)  <span class="comment"># y行不变遍历获取x列的请求方式</span></span><br><span class="line">    is_run = self.data.get_is_run(row_count)  <span class="comment"># y行不变遍历获取x列的是否运行</span></span><br><span class="line">    data = self.data.get_data_for_json(row_count)  <span class="comment"># y行不变遍历获取x列的请求数据，这里面时三次调用，依次分别是get_data_for_json丶get_key_words丶get_request_data</span></span><br><span class="line">    <span class="comment"># header = self.data.get_is_header(row_count)  #行不变遍历获取x列获取header</span></span><br><span class="line">    header = self.data.get_data_for_header(row_count)</span><br><span class="line">    module = self.data.get_module_name(row_count)  <span class="comment">#行不变遍历获取x列获取模块名</span></span><br><span class="line">    expect = self.data.get_expect_data(row_count)  <span class="comment">#行不变遍历获取x列获取预期结果</span></span><br><span class="line">    print(<span class="string">"模块名:"</span>, module)</span><br><span class="line">    print(<span class="string">'请求地址:'</span>, url)</span><br><span class="line">    print(<span class="string">'请求方式:'</span>, method)</span><br><span class="line">    print(<span class="string">'是否运行:'</span>, is_run)</span><br><span class="line">    print(<span class="string">'请求数据:'</span>, data)</span><br><span class="line">    print(<span class="string">'请求头:'</span>, header)</span><br><span class="line">    print(<span class="string">'预期结果:'</span>, expect)</span><br></pre></td></tr></table></figure>

<ul>
<li>在json文档中增加excel表中的cart_data请求数据以及cart_header数据</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190624151837863.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>最后运行启动文件run_test查看获取excel文档以及json文档数据是否正确</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190624152050419.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>整体测试接口，首先在excel表中填写预期结果</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190624162129801.png" alt></fancybox></p>
<ul>
<li>因为该接口与之前接口不属于一个服务器，所以返回的响应数据不一样，所以需要修改common_util模块中修改判断</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line">__author__ = <span class="string">'cdtaogang'</span></span><br><span class="line">__date__ = <span class="string">'2019/6/21 18:43'</span></span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CommonUtil</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">is_contains</span><span class="params">(self, expect, reality)</span>:</span></span><br><span class="line">        flag = <span class="literal">None</span></span><br><span class="line">        reality = json.loads(reality)</span><br><span class="line">        expect = json.loads(expect)</span><br><span class="line">        <span class="keyword">if</span> expect[<span class="string">'isSuccess'</span>] == reality[<span class="string">'data'</span>][<span class="string">'result'</span>][<span class="string">'isSuccess'</span>]:</span><br><span class="line">            flag = <span class="literal">True</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            flag = <span class="literal">False</span></span><br><span class="line">        <span class="keyword">return</span> flag</span><br></pre></td></tr></table></figure>

<ul>
<li>运行启动测试文件，结果为测试成功，并将数据实际结果数据成功写入到excel实际结果列中</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190624162542719.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<p><strong>15.数据依赖问题方法封装之通过case_id获取case数据</strong></p>
<ul>
<li>在excel测试数据中case依赖丶依赖的返回数据丶数据依赖这三个字段是根据当前的接口的请求数据中是否需要从其他接口的响应中获取，根据上一步中的分析，进行如下填写</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190624170006981.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>服务器给下单接口返回的响应数据中的cartNo与支付接口请求数据中的cartNo一致，具体看图就明白了，首先查看服务器给下单接口返回的响应数据</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190624170453524.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>再查看支付接口向服务器发送的请求数据</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190624170528314.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>在op_excel.py中定义如下方法，根据传入的case_id值来获取excel表字段的行数据</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_x_values</span><span class="params">(self, case_id)</span>:</span></span><br><span class="line">    <span class="string">"""通过获取到的x坐标num值来获取到对应的内容"""</span></span><br><span class="line">    x_num = self.get_x_nums(case_id)</span><br><span class="line">    x_datas = self.get_x_data(x_num)</span><br><span class="line">    print(x_datas)</span><br><span class="line">    <span class="keyword">return</span> x_datas</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_x_nums</span><span class="params">(self, case_id)</span>:</span></span><br><span class="line">    <span class="string">"""根据传入的case_id的值来获取在表格x坐标的数值x=num"""</span></span><br><span class="line">    num = <span class="number">0</span></span><br><span class="line">    x_datas = self.get_y_data()</span><br><span class="line">    <span class="keyword">for</span> x_data <span class="keyword">in</span> x_datas:</span><br><span class="line">        <span class="keyword">if</span> case_id <span class="keyword">in</span> x_data:</span><br><span class="line">            <span class="keyword">return</span> num</span><br><span class="line">        num += <span class="number">1</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_x_data</span><span class="params">(self, x=None)</span>:</span></span><br><span class="line">    <span class="string">"""获取表格某一行所有数据"""</span></span><br><span class="line">    tables = self.data</span><br><span class="line">    <span class="keyword">if</span> x <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        x_data = tables.row_values(x)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        x_data = tables.row_values(<span class="number">1</span>)</span><br><span class="line">    <span class="comment"># print(x_data)</span></span><br><span class="line">    <span class="keyword">return</span> x_data</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_y_data</span><span class="params">(self, y=None)</span>:</span></span><br><span class="line">    <span class="string">"""获取表格某一列数据"""</span></span><br><span class="line">    <span class="keyword">if</span> y <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        y_data = self.data.col_values(y)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        y_data = self.data.col_values(<span class="number">0</span>)</span><br><span class="line">    <span class="comment"># print(y_data)</span></span><br><span class="line">    <span class="keyword">return</span> y_data</span><br></pre></td></tr></table></figure>

<ul>
<li>调用以上方法测试获取case_id为suning-02所在的行所有数据</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190624181520469.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<p><strong>16.数据依赖问题之根据规则提取响应数据</strong></p>
<ul>
<li>在data目录下新建一个handle_data_dependent.py文件用于处理数据依赖，说白了就是获取到传入的case_id所在的行的所有数据，再从该数据中将数据依赖字段cart2No的值提取出来即可，<font style="color:red">需要说明的一点是，之前博主测试使用的是看书吧app接口所以没有去调用base/run_method模块中的run_main方法向接口发送数据，而是直接在方法中使用requests模块进行数据的发送</font></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line">__author__ = <span class="string">'cdtaogang'</span></span><br><span class="line">__date__ = <span class="string">'2019/6/24 17:07'</span></span><br><span class="line"><span class="keyword">from</span> utils.op_excel <span class="keyword">import</span> operationExcel</span><br><span class="line"><span class="keyword">from</span> data.data_get <span class="keyword">import</span> getData</span><br><span class="line"><span class="keyword">import</span> requests, json</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HandleData</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, case_id)</span>:</span></span><br><span class="line">        self.case_id = case_id</span><br><span class="line">        self.op_excel = operationExcel()</span><br><span class="line">        self.data = getData()</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_case_line_data</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""获取case所在行数据"""</span></span><br><span class="line">        x_datas = self.op_excel.get_x_values(self.case_id)</span><br><span class="line">        <span class="comment"># ['suning-01', '下单', 'https://shopping.suning.com/app/addcart/private/quickBuy.do', 'yes', 'post', 'yes', '', '', '', 'cart_header', 'cart_data', '&#123;"isSuccess":"Y"&#125;', 'pass']</span></span><br><span class="line">        <span class="keyword">return</span> x_datas</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run_dependent_case</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""执行获取case所在的整行数据"""</span></span><br><span class="line">        <span class="comment"># run = RunMain()</span></span><br><span class="line">        x = self.op_excel.get_x_nums(self.case_id)</span><br><span class="line">        request_header = self.data.get_data_for_header(x)</span><br><span class="line">        request_data = self.data.get_data_for_json(x)</span><br><span class="line">        request_url = self.data.get_request_url(x)</span><br><span class="line">        request_method = self.data.get_request_method(x)</span><br><span class="line">        is_run = self.data.get_is_run(x)</span><br><span class="line">        module = self.data.get_module_name(x)</span><br><span class="line">        expect = self.data.get_expect_data(x)</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">if</span> is_run:</span><br><span class="line">            res = requests.post(url=request_url, data=request_data, headers=request_header, verify=<span class="literal">False</span>)</span><br><span class="line">            print(res.text)</span><br><span class="line">            print(json.loads(res.text)[<span class="string">'data'</span>][<span class="string">'result'</span>][<span class="string">'cart2No'</span>])</span><br><span class="line"> </span><br><span class="line">HandleData(<span class="string">"suning-01"</span>).run_dependent_case()</span><br></pre></td></tr></table></figure>

<ul>
<li>运行以上代码，手动传入case_id以及依赖数据的key，成功的提取出数据依赖字段数据</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190624191126269.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>对上一部中的返回的响应数据进行关键字数据的提取，将提取代码进行封装，首先是调用data_get模块中的get_dependent_key方法获取依赖的返回数据中的key，也就是excel表中的value值，然后再调用run_dependent_case方法获取返回的响应数据，通过依赖的返回数据中的key，来提取响应数据中的value值，这里需要安装jsonpath_rw，通过其parse方法来定义path规则，通过该规则找到返回的响应数据中的key的数据集，通过列表生成式将第0个元素进行返回</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_data_for_key</span><span class="params">(self, x)</span>:</span></span><br><span class="line">    <span class="string">"""获取依赖返回数据中的key"""</span></span><br><span class="line">    dependent_data = self.data.get_dependent_key(x)</span><br><span class="line">    response_data = self.run_dependent_case()</span><br><span class="line">    json_rule = parse(dependent_data)</span><br><span class="line">    madle = json_rule.find(response_data)</span><br><span class="line">    <span class="keyword">return</span>  [m.value <span class="keyword">for</span> m <span class="keyword">in</span> madle][<span class="number">0</span>]</span><br></pre></td></tr></table></figure>

<ul>
<li>在excel表中依赖返回数据中添加的返回响应的关键字必须是以这种格式进行层级关系的填写</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190625100337367.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<p><strong>17.数据依赖问题之依赖结构构建</strong></p>
<ul>
<li>在启动文件中run_test模块中，在run方法for循环中，首先需要获取excel表中的data_dependent数据依赖字段的值，然后再获取到case依赖的值，要获取case依赖的值，还需要到data_get模块中定义以下方法进行获取</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_case_dependent</span><span class="params">(self, x)</span>:</span></span><br><span class="line">    <span class="string">"""获取case依赖的值"""</span></span><br><span class="line">    y = int(data_conf.get_case_depend())</span><br><span class="line">    case_dependent = self.op_excel.get_cell_value(x, y)</span><br><span class="line">    <span class="keyword">if</span> case_dependent == <span class="string">''</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> case_dependent</span><br></pre></td></tr></table></figure>

<ul>
<li>回到run_test模块中的for循环中进行获取，判断当excel表中的数据依赖字段的值不为空是，则通过实例化HandleData，并调用类中的核心方法get_data_for_key，在该核心方法中又调用run_dependent_case向接口发送请求数据，并将服务器返回的数据返回回来，在get_data_for_key中使用jsonpath_rw中的parse方法进行建立path规则，最终提取到我们想要的返回数据中的cart2No键的值，进行打印测试</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></span><br><span class="line">    res = <span class="literal">None</span></span><br><span class="line">    row_counts = self.data.get_case_lines()  <span class="comment"># 获取excel表格行数</span></span><br><span class="line">    <span class="comment"># print(row_counts) 5</span></span><br><span class="line">    <span class="keyword">for</span> row_count <span class="keyword">in</span> range(<span class="number">1</span>, row_counts):</span><br><span class="line">        <span class="comment"># print(row_count) 1,2,3,4</span></span><br><span class="line">        url = self.data.get_request_url(row_count)  <span class="comment"># y行不变遍历获取x列的请求地址</span></span><br><span class="line">        method = self.data.get_request_method(row_count)  <span class="comment"># y行不变遍历获取x列的请求方式</span></span><br><span class="line">        is_run = self.data.get_is_run(row_count)  <span class="comment"># y行不变遍历获取x列的是否运行</span></span><br><span class="line">        data = self.data.get_data_for_json(row_count)  <span class="comment"># y行不变遍历获取x列的请求数据，这里面时三次调用，依次分别是get_data_for_json丶get_key_words丶get_request_data</span></span><br><span class="line">        <span class="comment"># header = self.data.get_is_header(row_count)  #行不变遍历获取x列获取header</span></span><br><span class="line">        header = self.data.get_data_for_header(row_count)</span><br><span class="line">        module = self.data.get_module_name(row_count)  <span class="comment">#行不变遍历获取x列获取模块名</span></span><br><span class="line">        expect = self.data.get_expect_data(row_count)  <span class="comment">#行不变遍历获取x列获取预期结果</span></span><br><span class="line">        data_dependent = self.data.get_data_dependent(row_count)  <span class="comment"># 数据依赖</span></span><br><span class="line">        case_dependent = self.data.get_case_dependent(row_count)  <span class="comment"># case依赖</span></span><br><span class="line">        <span class="keyword">if</span> data_dependent != <span class="literal">None</span>:</span><br><span class="line">            <span class="comment"># 当数据依赖不为空时，则实例化handle_data_dependent模块中的HandleData类，并调用类中的get_data_for_key方法将需要的cart2No数据获取到</span></span><br><span class="line">            self.hd = HandleData(case_dependent)</span><br><span class="line">            dependent_response_data = self.hd.get_data_for_key(row_count)</span><br><span class="line">            print(dependent_response_data)</span><br></pre></td></tr></table></figure>

<ul>
<li>将不需要的打印数据进行注释掉后，运行启动文件成功打印出dependent_response_data数据，即就是服务器响应数据中的cart2No键的值</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190625105858649.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>为了进一步的测试，需要在excel表中填写下单接口的请求数据json的key值，博主这里命令为cart_data2</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190625114450940.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>然后在json文件中，需要定义名为cart_data2的json数据，请留意请求数据中的cart2No得值，因为在接下来的测试代码中会自动的去跟新cart2No的值</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190625114802300.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>经过测试成功打印出接口数据依赖的key的值，说明在excel表中填写的依赖返回数据的格式是没问题的成功的被jsonpath_rw进行匹配并获取出，接下来则需要将获取到的cart2No的值赋给请求数据data中的cart2No键的值，而cart2No键就是通过get_data_dependent方法获取到excel表中数据依赖字段的值，最后通过requests模块post请求向目标接口发送请求数据</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190625114940648.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li><strong>重点：</strong><font style="color:red">大家看到这里应该也没啥不明白的吧，如果有请不要着急，博主把整个实现过程讲一下，代码写到这里其实分为两个部分，第一个部分就是获取case_id也就是存在依赖字段的case中的case依赖的值，根据该值来获取其在excel表中的x坐标列，因为y坐标是固定的，所以就可以获取依赖的case的所有行数据，紧接着就可以发送接口数据获的服务器返回的响应数据了，然后在对服务器返回的响应数据中通过jsonpath_rw模块中的方法提取我们想要的cart2No字段的值；第二部分就是在启动文件run_test模块中首先去获取依赖的数据以及case依赖数据，根据依赖数据不为空时去调用第一部分的核心代码来获取cart2No得值，然后将这个值赋值给请求数据data，也就是excel表中cart_data2键的值，可能有些人有点晕，为啥在run_test启动文件中只向存在依赖关系的case发送请求呢，那是因为做了判断了；</font>为了演示出两个部分发送的请求所需的参数以及对应在excel表中的字段数据，博主在handle_data_dependent模块中也进行了打印</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190625120220801.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>现在运行run_test启动文件，查看结果完全没问题，之前特意说明了json文件中的cart_data2的数据中的cart2No的值，现在运行代码后，将下单接口返回的响应数据中的cart2No的值赋给请求数据data，所以这里打印出来的请求数据的值的cart2No键的值与下单接口的响应数据中的值一致，需要说明的是支付的接口是测试失败，返回的响应数据中的错误信息为”errorMessage”:”销售火爆，请稍后再试(E234)”</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190625132542788.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>因为在APP购买中也是提示此错误，这是其接口关闭或者不能在app苏宁易购中购买</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190625120627126.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<p><strong>18.数据依赖问题之流程实施</strong></p>
<ul>
<li>上一步中已经成功的提取cart2No得值以及向支付接口发送数据，现在则需要判断返回的响应数据中的isSuccess字段的值是否为Y，并将最终的测试结果写入到excel表实际结果字段中去，那么首先需要在excel表中填写预测结果</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190625130047145.png" alt></fancybox></p>
<ul>
<li>从下单和支付两个接口返回的响应数据中看出isSuccess字段存在不一样的层级，所以在common_util模块中需要添加支付接口返回响应数据的字典层级判断来获取正确为的isSuccess字段的值，因为苏宁易购app这边cookie需要经常更换，所以博主添加了异常处理</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line">__author__ = <span class="string">'cdtaogang'</span></span><br><span class="line">__date__ = <span class="string">'2019/6/21 18:43'</span></span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CommonUtil</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">is_contains</span><span class="params">(self, expect, reality)</span>:</span></span><br><span class="line">        flag = <span class="literal">None</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            reality = json.loads(reality)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            print(<span class="string">"Cookie已过期，请及时更新!!!"</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        expect = json.loads(expect)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">'result'</span> <span class="keyword">in</span> reality[<span class="string">'data'</span>]:</span><br><span class="line">            <span class="keyword">if</span> expect[<span class="string">'isSuccess'</span>] == reality[<span class="string">'data'</span>][<span class="string">'result'</span>][<span class="string">'isSuccess'</span>]:</span><br><span class="line">                flag = <span class="literal">True</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                flag = <span class="literal">False</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">if</span> expect[<span class="string">'isSuccess'</span>] == reality[<span class="string">'data'</span>][<span class="string">'cartHeadInfo'</span>][<span class="string">'isSuccess'</span>]:</span><br><span class="line">                flag = <span class="literal">True</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                flag = <span class="literal">False</span></span><br><span class="line">        <span class="keyword">return</span> flag</span><br></pre></td></tr></table></figure>

<ul>
<li><p>因为博主这里想要两个接口的测试结果并将数据写入到excel实际结果中去，所以需要分别在handle_data_dependent模块以及run_test模块中进行调用common_util模块中的is_contains，并根据返回的结果将数据写入到excel实际结果字段中去</p>
</li>
<li><p>run_test模块中</p>
</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190625130712723.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>handle_data_dependent模块中</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190625130837483.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>测试前首先需要关闭excel表，然后运行代码成功将正确的测试数据结果写入到excel对应字段中</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190625133026474.gif" alt></fancybox></p>
<p><strong>19.case运行结果统计</strong></p>
<ul>
<li>博主在handle_data_dependent模块中定义一个方法print_test_data用于打印出我们想要的测试数据，代码很简单就不说了</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HandleData</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, case_id)</span>:</span></span><br><span class="line">        self.case_id = case_id</span><br><span class="line">        self.op_excel = operationExcel()</span><br><span class="line">        self.data = getData()</span><br><span class="line">        self.com_util = CommonUtil()</span><br><span class="line">        self.pass_count = []</span><br><span class="line">        self.fail_count = []</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">print_test_data</span><span class="params">(self,url,method,module,is_run,data,header,expect,res,x)</span>:</span></span><br><span class="line">        <span class="string">"""打印测试数据"""</span></span><br><span class="line">        print(<span class="string">"模块名:"</span>, module)</span><br><span class="line">        print(<span class="string">'请求地址:'</span>, url)</span><br><span class="line">        print(<span class="string">'请求方式:'</span>, method)</span><br><span class="line">        print(<span class="string">'是否运行:'</span>, is_run)</span><br><span class="line">        print(<span class="string">'请求数据:'</span>, data)</span><br><span class="line">        print(<span class="string">'请求头:'</span>, header)</span><br><span class="line">        print(<span class="string">'预期结果:'</span>, expect)</span><br><span class="line">        print(res.text)</span><br><span class="line">        <span class="keyword">if</span> self.com_util.is_contains(expect, res.text):</span><br><span class="line">            print(<span class="string">"测试通过"</span>)</span><br><span class="line">            print(<span class="string">"*"</span> * <span class="number">60</span> + <span class="string">"分割线"</span> + <span class="string">"*"</span> * <span class="number">60</span>)</span><br><span class="line">            self.data.write_reality_data(x, <span class="string">'pass'</span>)</span><br><span class="line">            self.pass_count.append(x)</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">"测试失败"</span>)</span><br><span class="line">            print(<span class="string">"*"</span> * <span class="number">60</span> + <span class="string">"分割线"</span> + <span class="string">"*"</span> * <span class="number">60</span>)</span><br><span class="line">            self.data.write_reality_data(x, <span class="string">'fail'</span>)</span><br><span class="line">            self.fail_count.append(x)</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">return</span> self.pass_count, self.fail_count</span><br></pre></td></tr></table></figure>

<ul>
<li>然后在run_dependent_case方法中去调用以上定义的打印测试数据的方法</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190625173335783.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>以及在run_test模块中调用print_test_data方法，并接收返回值，最后打印出统计的case测试结果数据</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190625173836200.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>运行启动文件run_test，成功打印出case成功失败以及测试case总量数</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190625173945106.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<p><strong>20.构建发送邮件服务</strong></p>
<p><strong>说明：</strong>博主这里使用163邮箱POP3/SMTP服务向qq邮箱发送邮件</p>
<ul>
<li>首先需要进入163个人邮箱中，开启POP3/SMTP服务</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190625201641775.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>然后开启客户端授权密码并进行设置，改授权密码需要记住，用于第三方也就是我们代码中需要填写的password</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190625201802993.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>紧接着在项目utils工具包下创建send_email.py文件，在该文件中编写代码登录连接163邮箱的POP3/SMTP服务向目标邮箱发送指定主题以及内容的邮件</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line">__author__ = <span class="string">'cdtaogang'</span></span><br><span class="line">__date__ = <span class="string">'2019/6/25 18:05'</span></span><br><span class="line"><span class="keyword">import</span> smtplib</span><br><span class="line"><span class="keyword">from</span> email.mime.text <span class="keyword">import</span> MIMEText</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SendEmail</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="keyword">global</span> send_user</span><br><span class="line">    <span class="keyword">global</span> pwd</span><br><span class="line">    <span class="keyword">global</span> email_host</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">send_mail</span><span class="params">(self,user_list,content,sub)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        :param user_list: 收件人列表</span></span><br><span class="line"><span class="string">        :param content: 邮件内容</span></span><br><span class="line"><span class="string">        :param sub: 主题</span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        send_user = <span class="string">"cdtaogang@163.com"</span></span><br><span class="line">        password = <span class="string">"设置的授权码"</span></span><br><span class="line">        email_host = <span class="string">"smtp.163.com"</span></span><br><span class="line">        sender_msg = <span class="string">"cdtaogang"</span>+<span class="string">"&lt;"</span>+send_user+<span class="string">"&gt;"</span></span><br><span class="line">        message = MIMEText(content, _subtype=<span class="string">'plain'</span>, _charset=<span class="string">'utf-8'</span>)</span><br><span class="line">        message[<span class="string">'Subject'</span>] = sub</span><br><span class="line">        message[<span class="string">'From'</span>] = sender_msg</span><br><span class="line">        message[<span class="string">'To'</span>] = <span class="string">";"</span>.join(user_list)</span><br><span class="line">        server = smtplib.SMTP()</span><br><span class="line">        server.connect(email_host)</span><br><span class="line">        server.login(send_user,password)</span><br><span class="line">        server.sendmail(sender_msg,user_list,message.as_string())</span><br><span class="line">        server.close()</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    user_list = [<span class="string">'2384005622@qq.com'</span>]</span><br><span class="line">    sub = <span class="string">"测试邮件"</span></span><br><span class="line">    content = <span class="string">"这是用来测试的邮件!!!"</span></span><br><span class="line">    SendEmail().send_mail(user_list,content,sub)</span><br></pre></td></tr></table></figure>

<ul>
<li>然后运行以上代码，登录<a href="mailto:2384005622@qq.com" target="_blank" rel="noopener">2384005622@qq.com</a>邮箱，查看是否收到邮件，并核实邮件内容和主题是否与设置的一致</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190625202319928.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<p><strong>21.结果统计+报告通知</strong></p>
<ul>
<li>首先在send_email模块中定义send_main方法，该方法用于自动化测试结果的统计</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">send_main</span><span class="params">(self, pass_num, fail_num)</span>:</span></span><br><span class="line">    pass_num = float(pass_num)</span><br><span class="line">    fail_num = float(fail_num)</span><br><span class="line">    count_nums = pass_num + fail_num</span><br><span class="line">    <span class="comment"># 计算通过率</span></span><br><span class="line">    pass_result = <span class="string">"%.2f%%"</span> %(pass_num/count_nums*<span class="number">100</span>)</span><br><span class="line">    fail_result = <span class="string">"%.2f%%"</span> %(fail_num/count_nums*<span class="number">100</span>)</span><br><span class="line">    user_list = [<span class="string">'2384005622@qq.com'</span>]</span><br><span class="line">    sub = <span class="string">"接口自动化测试报告"</span></span><br><span class="line">    content = <span class="string">"本次自动化测试一共运行的接口数为:%d个, 通过个数为:%d个, 失败个数为:%d个, 通过率为:%s, 失败率为:%s"</span> %(count_nums,pass_num,fail_num,pass_result,fail_result)</span><br><span class="line">    print(content)</span><br></pre></td></tr></table></figure>

<ul>
<li>调用send_main方法，测试打印的content内容数据是否正确</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190625205213678.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>然后在send_main中调用send_mail方法，将自动化测试报告发送到目标邮箱中</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190625205535342.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>查看邮箱邮件，成功将自动化测试报告发送至邮箱中</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/2019062520570972.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>最后只需要在启动文件run_test中，实例化SendEmail对象，调用其send_main方法，将pass_count和fail_count传递即可，这样就可以完成自动化邮件测试报告的发送</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190625210725930.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>测试运行run_test启动文件，将测试结果报告发送至邮箱</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190625211235768.gif" alt></fancybox></p>
<h1 id="八丶持续集成"><a href="#八丶持续集成" class="headerlink" title="八丶持续集成"></a>八丶持续集成</h1><p><strong>1.持续集成环境搭建</strong></p>
<ul>
<li>除了在编辑器中直接run运行run_test.py启动文件以外，还可以在windows cmd终端以及Pycharm Terminal终端使用python解释器直接运行，如下图所示</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190625214038711.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>如上图提示找到不到base模块，明明在Pycharm中都能运行成功为啥在终端却提示找不到导入的模块呢，原因是在PyCharm中根据其的path查找路径进行查找，而在编辑器外使用终端进行运行模块时，则是从系统路径中进行查找，解决方法在run_test模块中导入sys模块，将文件所在的目录添加到sys的path路径中去，记得添加你的run_test文件所在的路径</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">sys.path.append(<span class="string">"D:/PycharmProjects/testItems"</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li>再次在终端执行则提示成功</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190625215712800.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>查看邮箱已收到自动化测试报告邮件</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190625215840124.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>下载安装<a href="https://jenkins.io/zh/" target="_blank" rel="noopener">Jenkins</a>，进入其官网下载页面，如下图所示，各种版本的下载，博主这里就不下载windows版本的Jenkins，因为安装太简单，只需要一直下一步，博主下载Generic Java package (.war)版本</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190625220853622.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>没有java环境的朋友就下载windows版本的，下载完成后，在java安装目录下新建Jenkins目录将jenkins.war文件拷贝进入，然后在cmd终端中执行java -jar jenkins.war，如下图所示</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190625225716979.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>然后在浏览器中访问<a href="http://127.0.0.1:8080" target="_blank" rel="noopener">http://127.0.0.1:8080</a>，进入以下页面</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190625230941270.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>在如上页面中路径打开initialAdminPassword文件或者是在cmd运行窗口日志中查看管理员密码</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190625231242282.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>在页面输入管理员密码后，进入如下页面，选择安装推荐的插件</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190625231436956.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>安装插件需要等待</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190625231549824.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>插件安装完成后，即进入如下页面，创建管理员用户</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190625234214609.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>进入到Jenkins的管理页面，点击创建一个item，如下图所示</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190626001503767.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>输入任务名字，选择一个主题风格，然后点击确定，如下图</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190626001736139.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>然后对创建的任务进行配置，首先配置这个任务所在的工作区间位置也就是我们的项目启动文件的目录</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190626003227992.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>构建任务的触发器，设定下一此执行任务的时间</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/2019062600341445.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>构建运行项目的windows命令，点击保存</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190626003402879.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>保存完后，到如下页面，点击Build Now立即创建，则在Build History构建历史中，生成记录，如下图所示</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/2019062600535695.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>紧接着点击构建的#5进入控制台输出，查看输出结果成功的执行了python run_test.py 命令，成功的执行了自动化测试启动文件</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190626010125318.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>查看目标邮箱成功收到邮件，说明使用Jenkins工具进行持续化集成项目成功</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190626005812657.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<h1 id="九丶获取cookie及请求处理"><a href="#九丶获取cookie及请求处理" class="headerlink" title="九丶获取cookie及请求处理"></a>九丶获取cookie及请求处理</h1><p><strong>1.获取cookie思路分析</strong></p>
<ul>
<li>如苏宁易购的提交订单接口，是需要用户登录后才能进行的操作，之前获取下单的接口都是在app中进行获取的，博主在这里登录网页版的苏宁官网，抓取下单的接口</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190628094132699.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>然后退出登录，在浏览器中输入以上fiddler抓取的下单接口，服务器就会重定向到登录的接口</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190628094535185.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>在登录页面，输入选择手机号验证码登录，输入手机号以及验证码，点击登录</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190628095017853.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>点击登录成功后，查看fiddler抓取的接口，第一个接口未检查用户的登录状态，服务返回的json数据中的result值为True时，表示用户是已经登录成功的，那么即就会去跳转到之前下单的接口，当然访问检查登录接口时同时也会将下单targetUrl地址携带到请求参数中</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190628095358467.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li><font style="color:red"><strong>重点：</strong></font>从fiddler抓取的接口看来，首先苏宁这边用户下单接口必须是在用户登录成功的状态才能进行的，当博主退出登录后，然后在浏览器中直接访问下单的<a href="https://reg.suning.com/smsLogin/checkLoginAccount.do?" target="_blank" rel="noopener">https://reg.suning.com/smsLogin/checkLoginAccount.do?</a>接口，此时就会触发苏宁的服务器去调用检查登录的令牌来检验用户是否已经登录，如不存在此令牌则会跳转到苏宁的登录接口进行用户登录，点击登录后则会去访问<a href="https://passport.suning.com/ids/login?" target="_blank" rel="noopener">https://passport.suning.com/ids/login?</a>接口，当登录成功后，服务器会返回一个名为 secureToken的cookie回来，并且会跳转到登录请求参数中的referenceURL地址中也就是<a href="https://passport.suning.com/ids/login?service=https://shopping.suning.com/auth?targetUrl=https%3A%2F%2Fshopping.suning.com%2Forder.do%3Fcart2No%3D620200000212045085" target="_blank" rel="noopener">https://passport.suning.com/ids/login?service=https://shopping.suning.com/auth?targetUrl=https%3A%2F%2Fshopping.suning.com%2Forder.do%3Fcart2No%3D620200000212045085</a>这个地址，要想进入此下单页面则需要在请求的cookie中携带secureToken的值，不然无法进入下单页面，则会跳转到登录页面</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190628103720257.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190628104011706.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<p><strong>2.模拟登录获取cookie请求订单接口</strong></p>
<ul>
<li><font style="color:red"><strong>第一步：</strong></font>首先在电脑端退出苏宁易购的登录，然后在浏览器中输入<a href="https://shopping.suning.com/order.do?cart2No=620200000212045085" target="_blank" rel="noopener">https://shopping.suning.com/order.do?cart2No=620200000212045085</a>，去访问下单接口，此时会跳转到登录页面，然后在登录页面输入用户名密码后，点击登录，最后回到fiddler上查看抓取的苏宁易购登录接口<a href="https://passport.suning.com/ids/login" target="_blank" rel="noopener">https://passport.suning.com/ids/login</a>，通过查看该接口获取请求header中携带的cookie值，将其拷贝</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190628115803371.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li><font style="color:red"><strong>第二步：</strong></font>在fiddler上获取登录接口请求中的data数据，因为是POST请求嘛所以在WebForms可以查看得到，同样的将其拷贝</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190628115942664.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li><font style="color:red"><strong>第三步：</strong></font>模拟登录，在项目utils工具目录下，创建analog_login.py文件，在文件中使用requests模块向登录接口发送请求获取响应内容，实现模拟登录，该请求需要携带cookie并传递data数据，才能成功的实现苏宁网站的登录</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190628122207562.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li><font style="color:red"><strong>第四步：</strong></font>运行程序，查看苏宁服务器返回的数据，对比与博主在官网登录成功后fiddler工具抓取的登录成功服务器返回的响应数据一致，表示模拟登录成功</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190628120734475.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190628120928438.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li><font style="color:red"><strong>第五步：</strong></font>也就是直接打印出返回的响应数据res中的cookie即可，但是苏宁这边的登录安全防护这边做的很好，毕竟是大企业嘛，所以过了一段时间运行代码服务器就会返回验证码的错误代码数据，就好比一个网站你在很短的时间内不停的登录，就会出现安全验证比如验证码就是那种极其恶心拖动验证</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190628123229794.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li><font style="color:red"><strong>第六步：</strong></font>再次重复第一步到第四步的步骤，博主在网页上进行拖动验证通过后，通过抓包工具fiddler可以明显看出，这次登录请求的data数据中明显多了些参数，这些参数就是验证码这块的</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190628123609876.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li><font style="color:red"><strong>第七步：</strong></font>通过很多次的登录尝试，发现请求data中的数据中的iarVerifyCode的值的过期时间很短，所以需要不停的在网页上来进行登录通过fiddler抓取登录接口请求数据中的iarVerifyCode值，这个值的过期时间只有1分钟，所以需要更换代码中的iarVerifyCode值，这样才能进行模拟登录，打印服务返回的数据中的cookie数据</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190628132747731.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li><font style="color:red"><strong>第八步：</strong></font>然后将从<a href="https://passport.suning.com/ids/login" target="_blank" rel="noopener">https://passport.suning.com/ids/login</a>接口中获取到的响应数据中的cookie数据作为下单接口<a href="https://shopping.suning.com/order.do?cart2No=620200000212045085" target="_blank" rel="noopener">https://shopping.suning.com/order.do?cart2No=620200000212045085</a>的请求数据中的cookie，来访问下单页面，这样就完成了模拟登录获取cookie请求订单接口</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190628145912690.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<ul>
<li>最后一步运行程序，成功的利用登录成功服务器返回的cookie数据，成功的访问下单接口，获取下单页面数据</li>
</ul>
<p><fancybox><img src="https://img-blog.csdnimg.cn/20190628134443206.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzgyNDI1,size_16,color_FFFFFF,t_70" alt></fancybox></p>
<br>

<p>————————————————<br>版权声明：本文为CSDN博主「cdtaogang」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。<br>原文链接：<a href="https://blog.csdn.net/qq_41782425/article/details/93235627" target="_blank" rel="noopener">https://blog.csdn.net/qq_41782425/article/details/93235627</a></p>

      </div>
      
        <br>
        


  <section class='meta' id="footer-meta">
    <div class='new-meta-box'>
      
        
          <div class="new-meta-item date" itemprop="dateUpdated" datetime="2019-11-18T14:55:49+08:00">
  <a class='notlink'>
    <i class="fas fa-clock" aria-hidden="true"></i>
    <p>更新于 2019年11月18日</p>
  </a>
</div>

        
      
        
          
  
  <div class="new-meta-item meta-tags"><a class="tag" href="/tags/Fiddler/" rel="nofollow"><i class="fas fa-tag" aria-hidden="true"></i><p>Fiddler</p></a></div> <div class="new-meta-item meta-tags"><a class="tag" href="/tags/Unittest/" rel="nofollow"><i class="fas fa-tag" aria-hidden="true"></i><p>Unittest</p></a></div> <div class="new-meta-item meta-tags"><a class="tag" href="/tags/HTMLTestRunner/" rel="nofollow"><i class="fas fa-tag" aria-hidden="true"></i><p>HTMLTestRunner</p></a></div> <div class="new-meta-item meta-tags"><a class="tag" href="/tags/接口自动化测试/" rel="nofollow"><i class="fas fa-tag" aria-hidden="true"></i><p>接口自动化测试</p></a></div>


        
      
        
          
  <div class="new-meta-item share -mob-share-list">
  <div class="-mob-share-list share-body">
    
      
        <a class="-mob-share-qq" title="QQ好友" rel="external nofollow noopener noreferrer"
          
          href="http://connect.qq.com/widget/shareqq/index.html?url=https://hellotaogang.github.io/2019/11/16/Python接口自动化测试框架实战开发（二）/&title=Python接口自动化测试框架实战开发（二） | TG'S BLOG&summary=该篇文章是博主一字一码编写的，实属不易，请尊重原创，谢谢大家！温馨提示：需要项目源码的朋友，请添加博主微信进行获取！
&nbsp;&nbsp;本文目录
七丶接口自动化框架设计到开发
八丶持续集成
九丶获取cookie及请求处理"
          
          >
          
            <img src="https://cdn.jsdelivr.net/gh/xaoxuu/assets@19.1.9/logo/128/qq.png">
          
        </a>
      
    
      
        <a class="-mob-share-qzone" title="QQ空间" rel="external nofollow noopener noreferrer"
          
          href="https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=https://hellotaogang.github.io/2019/11/16/Python接口自动化测试框架实战开发（二）/&title=Python接口自动化测试框架实战开发（二） | TG'S BLOG&summary=该篇文章是博主一字一码编写的，实属不易，请尊重原创，谢谢大家！温馨提示：需要项目源码的朋友，请添加博主微信进行获取！
&nbsp;&nbsp;本文目录
七丶接口自动化框架设计到开发
八丶持续集成
九丶获取cookie及请求处理"
          
          >
          
            <img src="https://cdn.jsdelivr.net/gh/xaoxuu/assets@19.1.9/logo/128/qzone.png">
          
        </a>
      
    
      
        <a class='qrcode' rel="external nofollow noopener noreferrer" href='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQ4AAAEOCAAAAABd2qZ5AAAD5UlEQVR42u3aS47bQAwFQN//0s42gDPSe2QrcYDSamBopO7qBcXP6xVf79+u9v7Pq33+5++f9//0y+uJCwcOHDhwrJee/JIsPb8/IZut9uZ4cODAgQPHIY7r8JbfMwt+bVC8Rly9FwcOHDhw/HWONuDNAnObyCVAOHDgwIHjmzmSkJaUBZ8rWeLAgQMHjn/LkRQH8/9qKWclv1lx81itFAcOHDhwLOJdvr3v/PuR+Q4cOHDgwHGZAs0C5z6tyouGbZuq3h0OHDhw4DgTKIaPng0WnC3/JZuvn48DBw4cONYcs6GB/GWztLBdyakPBRw4cODAseHIQ2Yb2OrEqRyPSA6v/lzAgQMHDhxHOWYL2iRdyXvzMJm/8ccd4cCBAweONUcShJJFzJpJs6G6TcmyOFocOHDgwLHgaFOvFjFPqzaH1B7Mj8eMAwcOHDgWHLOXtaMD79HVJpZJ8+xY2oYDBw4cOMrkrU3n8gGCWXKYo8+KmDfhFgcOHDhwxByzUt1suqwN0kkbaRa867IgDhw4cOAYNZzaoDvbfP0VUA4rbI4KBw4cOHDsOZKF5klaHpjbcJ43qFYjfThw4MCB4wGOfCAgGSDIn5+Mvs3CdnG0OHDgwIHjEMemJNe+fpaAHRhTaGcGceDAgQPHiKMdU2iLem1g3iRgs/XjwIEDB44nONoRt7YUWPfBRglh/vYbehw4cODA8TDHqUZR/vxTHwSPBFocOHDgwLHgmG1y1gpKSn5Ps+LAgQMHjlNtp80YQV5A3Jf2Zusskk8cOHDgwLHmaJeYB8V2k9fB+GyCFz0fBw4cOHCMODZhKVl00ewZNY2SUYlhLosDBw4cOEYcm2CWbH5WRsw3eb3hFhEHDhw4cOw53uU1KwjmSVoegGclwhsUHDhw4MCx5siTsXZjmzrlrIGUp6A39Dhw4MCBY83R/vOpxlIbXNtS4KwFhQMHDhw4NhxtY2k2QpekdnkVc3MYRXEQBw4cOHAc5ciTqH0yljOdffIfnoADBw4cOI5ytMW42Z2zAYh9shfx4cCBAweOQxxtMJslVPl4XHtP/vybA8OBAwcOHGuOTSEvKQvmAbJ974bm5r9w4MCBA8eCY5Y4zVKvqDw3Cpb5wdzQ4MCBAweONcfm9XkkbwP5NWXONytl4sCBAweOPUfdnrkssc2G1fJkLD/bYSDHgQMHDhyHONoi3aYYt0/VTjWfcODAgQPH93BcB9okKO7bWnmhMBplwIEDBw4c/wlH3hzK21r7EH7Ti8OBAwcOHGuO5MXtPfsAuX9m/jsOHDhw4DjF0Yai2WjCrOSXfArk4xR5AokDBw4cOEYcvwDsddi7IuV83QAAAABJRU5ErkJggg=='>
        
          <img src="https://cdn.jsdelivr.net/gh/xaoxuu/assets@19.1.9/logo/128/wechat.png">
        
        </a>
      
    
      
        <a class="-mob-share-weibo" title="微博" rel="external nofollow noopener noreferrer"
          
          href="http://service.weibo.com/share/share.php?url=https://hellotaogang.github.io/2019/11/16/Python接口自动化测试框架实战开发（二）/&title=Python接口自动化测试框架实战开发（二） | TG'S BLOG&summary=该篇文章是博主一字一码编写的，实属不易，请尊重原创，谢谢大家！温馨提示：需要项目源码的朋友，请添加博主微信进行获取！
&nbsp;&nbsp;本文目录
七丶接口自动化框架设计到开发
八丶持续集成
九丶获取cookie及请求处理"
          
          >
          
            <img src="https://cdn.jsdelivr.net/gh/xaoxuu/assets@19.1.9/logo/128/weibo.png">
          
        </a>
      
    
  </div>
</div>



        
      
    </div>
  </section>


      
      
          <div class="prev-next">
              
                  <section class="prev">
                      <span class="art-item-left">
                          <h6><i class="fas fa-chevron-left" aria-hidden="true"></i>&nbsp;上一页</h6>
                          <h4>
                              <a href="/2019/11/18/Selenium3与Python3实战开发Web自动化测试框架（一）/" rel="prev" title="Selenium3与Python3实战开发Web自动化测试框架（一）">
                                
                                    Selenium3与Python3实战开发Web自动化测试框架（一）
                                
                              </a>
                          </h4>
                          
                              
                              <h6 class="tags">
                                  <a class="tag" href="/tags/Unittest/"><i class="fas fa-tag fa-fw" aria-hidden="true"></i> Unittest</a> <a class="tag" href="/tags/Selenium/"><i class="fas fa-tag fa-fw" aria-hidden="true"></i> Selenium</a> <a class="tag" href="/tags/Web自动化/"><i class="fas fa-tag fa-fw" aria-hidden="true"></i> Web自动化</a> <a class="tag" href="/tags/自动化测试框架/"><i class="fas fa-tag fa-fw" aria-hidden="true"></i> 自动化测试框架</a>
                              </h6>
                          
                      </span>
                  </section>
              
              
                  <section class="next">
                      <span class="art-item-right" aria-hidden="true">
                          <h6>下一页&nbsp;<i class="fas fa-chevron-right" aria-hidden="true"></i></h6>
                          <h4>
                              <a href="/2019/11/16/Python接口自动化测试框架实战开发（一）/" rel="prev" title="Python接口自动化测试框架实战开发（一）">
                                  
                                      Python接口自动化测试框架实战开发（一）
                                  
                              </a>
                          </h4>
                          
                              
                              <h6 class="tags">
                                  <a class="tag" href="/tags/Fiddler/"><i class="fas fa-tag fa-fw" aria-hidden="true"></i> Fiddler</a> <a class="tag" href="/tags/Unittest/"><i class="fas fa-tag fa-fw" aria-hidden="true"></i> Unittest</a> <a class="tag" href="/tags/HTMLTestRunner/"><i class="fas fa-tag fa-fw" aria-hidden="true"></i> HTMLTestRunner</a> <a class="tag" href="/tags/接口自动化测试/"><i class="fas fa-tag fa-fw" aria-hidden="true"></i> 接口自动化测试</a>
                              </h6>
                          
                      </span>
                  </section>
              
          </div>
      
    </section>
  </article>



  <!-- 显示推荐文章和评论 -->



  <article class="post white-box comments">
    <section class="article typo">
      <h4><i class="fas fa-comments fa-fw" aria-hidden="true"></i>&nbsp;评论</h4>
      
      
      
        <section id="comments">
          <div id="gitalk-container"></div>
        </section>
      
      
    </section>
  </article>






<!-- 根据页面mathjax变量决定是否加载MathJax数学公式js -->



  <script>
    window.subData = {
      title: 'Python接口自动化测试框架实战开发（二）',
      tools: true
    }
  </script>


</div>
<aside class='l_side'>
  
    
    
      
        
          
          
        
          
          
            
              
  <section class='widget toc-wrapper'>
    
<header class='pure'>
  <div><i class="fas fa-list fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;本文目录</div>
  
    <!-- <div class='wrapper'><a class="s-toc rightBtn" rel="external nofollow noopener noreferrer" href="javascript:void(0)"><i class="fas fa-thumbtack fa-fw"></i></a></div> -->
  
</header>

    <div class='content pure'>
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#七丶接口自动化框架设计到开发"><span class="toc-text">七丶接口自动化框架设计到开发</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#八丶持续集成"><span class="toc-text">八丶持续集成</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#九丶获取cookie及请求处理"><span class="toc-text">九丶获取cookie及请求处理</span></a></li></ol>
    </div>
  </section>


            
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
      
    

  
</aside>

<footer id="footer" class="clearfix">
  
  
    <div class="social-wrapper">
      
        
          <a href="http://wpa.qq.com/msgrd?v=3&amp;uin=1126331350&amp;site=qq&amp;menu=yes"
            class="social fab fa-qq flat-btn flat-btn"
            target="_blank"
            rel="external nofollow noopener noreferrer">
          </a>
        
      
        
          <a href="https://cdn.jsdelivr.net/gh/Hellotaogang/cdn@4.4/about/wxhy.png"
            class="social fab fa-weixin flat-btn flat-btn"
            target="_blank"
            rel="external nofollow noopener noreferrer">
          </a>
        
      
        
          <a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=cdtaogang@163.com"
            class="social fas fa-envelope flat-btn"
            target="_blank"
            rel="external nofollow noopener noreferrer">
          </a>
        
      
        
          <a href="https://github.com/Hellotaogang"
            class="social fab fa-github flat-btn"
            target="_blank"
            rel="external nofollow noopener noreferrer">
          </a>
        
      
        
          <a href="https://blog.csdn.net/qq_41782425"
            class="social fab fa-cuttlefish flat-btn flat-btn"
            target="_blank"
            rel="external nofollow noopener noreferrer">
          </a>
        
      
    </div>
  
  <br>
  <div><p>Copyright <i class='far fa-copyright'></i> 2019-2020 <a style='color: #333333' href='https://www.cdtaogang.top/' target='_blank'>TG’BLOG</a>&nbsp;&nbsp;|&nbsp;&nbsp;<span id='timeDate'>载入天数…</span><span id='times'>载入时分秒…</span></p>
</div>
  <br>
  <div>
    <div class='github-badge'> <a style='color: #fff' href='https://hexo.io/'><span class='badge-subject'>框架</span><span class='badge-value bg-blue'>Hexo</span></a> </div> <div class='github-badge'> <a style='color: #fff' href='https://github.com/'><span class='badge-subject'>托管</span><span class='badge-value bg-brightgreen'>GitHub</span></a> </div> <div class='github-badge'> <a style='color: #fff' href='https://www.aliyun.com/'><span class='badge-subject'>域名</span><span class='badge-value bg-firebrick'>Aliyun</span></a> </div> <div class='github-badge'> <a style='color: #fff' href='https://www.jsdelivr.com/'><span class='badge-subject'>内容分发网络</span><span class='badge-value bg-orange'>jsDelivr</span></a> </div> <div class='github-badge'> <a style='color: #fff' href='https://996.icu/#/zh_CN'><span class='badge-subject'>链接</span><span class='badge-value bg-red'>996.ICU</span></a> </div> <div class='github-badge'> <a style='color: #fff' href='https://xaoxuu.com/wiki/material-x/'><span class='badge-subject'>主题</span><span class='badge-value bg-blue'>Material X</span></a> </div> <div class='github-badge'> <a style='color: #fff' href='https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh'><span class='badge-subject'>协议</span><span class='badge-value bg-pink'>BY-NC-SA 4.0</span></a> </div>
  </div>
<script>
    var now = new Date(); 
    function createtime() { 
        var grt= new Date("10/11/2019 21:38:00");//在此处修改你的建站时间
        now.setTime(now.getTime()+250); 
        days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days); 
        hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours); 
        if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum); 
        mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;} 
        seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum); 
        snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;} 
        document.getElementById("timeDate").innerHTML = "本站已安全运行 "+dnum+" 天 "; 
        document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒"; 
    } 
setInterval("createtime()",250);
</script>
</footer>
<script>setLoadingBarProgress(80);</script>



      <script>setLoadingBarProgress(60);</script>
    </div>
    <a class="s-top fas fa-arrow-up fa-fw" href='javascript:void(0)'></a>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>

  <script>
    var GOOGLE_CUSTOM_SEARCH_API_KEY = "";
    var GOOGLE_CUSTOM_SEARCH_ENGINE_ID = "";
    var ALGOLIA_API_KEY = "";
    var ALGOLIA_APP_ID = "";
    var ALGOLIA_INDEX_NAME = "";
    var AZURE_SERVICE_NAME = "";
    var AZURE_INDEX_NAME = "";
    var AZURE_QUERY_KEY = "";
    var BAIDU_API_ID = "";
    var SEARCH_SERVICE = "hexo" || "hexo";
    var ROOT = "/"||"/";
    if(!ROOT.endsWith('/'))ROOT += '/';
  </script>

<script src="//instant.page/1.2.2" type="module" integrity="sha384-2xV8M5griQmzyiY3CDqh1dn4z3llDVqZDqzjzcY+jCBCk/a5fXJmuZ/40JJAPeoU"></script>


  <script async src="https://cdn.jsdelivr.net/npm/scrollreveal@4.0.5/dist/scrollreveal.min.js"></script>
  <script type="text/javascript">
    $(function() {
      const $reveal = $('.reveal');
      if ($reveal.length === 0) return;
      const sr = ScrollReveal({ distance: 0 });
      sr.reveal('.reveal');
    });
  </script>


  <script src="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.js"></script>
  <script type="text/javascript">
    $(function() {
      Waves.attach('.flat-btn', ['waves-button']);
      Waves.attach('.float-btn', ['waves-button', 'waves-float']);
      Waves.attach('.float-btn-light', ['waves-button', 'waves-float', 'waves-light']);
      Waves.attach('.flat-box', ['waves-block']);
      Waves.attach('.float-box', ['waves-block', 'waves-float']);
      Waves.attach('.waves-image');
      Waves.init();
    });
  </script>


  <script async src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-busuanzi@2.3/js/busuanzi.pure.mini.js"></script>




  
  
  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-backstretch/2.0.4/jquery.backstretch.min.js"></script>
    <script type="text/javascript">
      $(function(){
        if ('.cover') {
          $('.cover').backstretch(
          ["https://cdn.jsdelivr.net/gh/Hellotaogang/cdn@4.5.7/images/background_4.jpg", "https://cdn.jsdelivr.net/gh/Hellotaogang/cdn@4.5.7/images/background_5.jpg", "https://cdn.jsdelivr.net/gh/Hellotaogang/cdn@4.5.7/images/background_6.jpg"],
          {
            duration: "6000",
            fade: "2500"
          });
        } else {
          $.backstretch(
          ["https://cdn.jsdelivr.net/gh/Hellotaogang/cdn@4.5.7/images/background_4.jpg", "https://cdn.jsdelivr.net/gh/Hellotaogang/cdn@4.5.7/images/background_5.jpg", "https://cdn.jsdelivr.net/gh/Hellotaogang/cdn@4.5.7/images/background_6.jpg"],
          {
            duration: "6000",
            fade: "2500"
          });
        }
      });
    </script>
  







  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
  <script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
  <script src="https://cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.min.js"></script>
  <script type="text/javascript">
    var gitalk = new Gitalk({
      clientID: "71020b6958cd6bbf65b7",
      clientSecret: "3cfeccd9125b8bac76f2bd8a7f6e30a601ae3a81",
      repo: "Hellotaogang.github.io",
      owner: "Hellotaogang",
      admin: "Hellotaogang",
      
        id: md5(location.pathname),      // Ensure uniqueness and length less than 50
      
      distractionFreeMode: false  // Facebook-like distraction free mode
    });
    gitalk.render('gitalk-container');
  </script>





  <script src="/js/app.js"></script>


  <script src="/js/search.js"></script>




<!-- 复制 -->
<script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script>
  let COPY_SUCCESS = "复制成功";
  let COPY_FAILURE = "复制失败";
  /*页面载入完成后，创建复制按钮*/
  !function (e, t, a) {
    /* code */
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '  <i class="fa fa-copy"></i><span>复制</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });

      clipboard.on('success', function(e) {
        //您可以加入成功提示
        console.info('Action:', e.action);
        console.info('Text:', e.text);
        console.info('Trigger:', e.trigger);
        success_prompt(COPY_SUCCESS);
        e.clearSelection();
      });
      clipboard.on('error', function(e) {
        //您可以加入失败提示
        console.error('Action:', e.action);
        console.error('Trigger:', e.trigger);
        fail_prompt(COPY_FAILURE);
      });
    }
    initCopyCode();

  }(window, document);

  /**
   * 弹出式提示框，默认1.5秒自动消失
   * @param message 提示信息
   * @param style 提示样式，有alert-success、alert-danger、alert-warning、alert-info
   * @param time 消失时间
   */
  var prompt = function (message, style, time)
  {
      style = (style === undefined) ? 'alert-success' : style;
      time = (time === undefined) ? 1500 : time*1000;
      $('<div>')
          .appendTo('body')
          .addClass('alert ' + style)
          .html(message)
          .show()
          .delay(time)
          .fadeOut();
  };

  // 成功提示
  var success_prompt = function(message, time)
  {
      prompt(message, 'alert-success', time);
  };

  // 失败提示
  var fail_prompt = function(message, time)
  {
      prompt(message, 'alert-danger', time);
  };

  // 提醒
  var warning_prompt = function(message, time)
  {
      prompt(message, 'alert-warning', time);
  };

  // 信息提示
  var info_prompt = function(message, time)
  {
      prompt(message, 'alert-info', time);
  };

</script>


<!-- fancybox -->
<script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>
<script>
  let LAZY_LOAD_IMAGE = "";
  $(".article-entry").find("fancybox").find("img").each(function () {
      var element = document.createElement("a");
      $(element).attr("data-fancybox", "gallery");
      $(element).attr("href", $(this).attr("src"));
      /* 图片采用懒加载处理时,
       * 一般图片标签内会有个属性名来存放图片的真实地址，比如 data-original,
       * 那么此处将原本的属性名src替换为对应属性名data-original,
       * 修改如下
       */
       if (LAZY_LOAD_IMAGE) {
         $(element).attr("href", $(this).attr("data-original"));
       }
      $(this).wrap(element);
  });
</script>





  <script>setLoadingBarProgress(100);</script>
  <!-- 页面点击小红心 -->
  <!-- <script type="text/javascript" src="/js/love.js"></script> -->
  <!--单击显示文字-->
  <!-- <script type="text/javascript" src="/js/click_show_text.js"></script> -->
  <!-- 鼠标点击烟花 -->
  <!-- <canvas class="fireworks" style="position: fixed;left: 0;top: 0;z-index: 1; pointer-events: none;" ></canvas> 
  <script type="text/javascript" src="//cdn.bootcss.com/animejs/2.2.0/anime.min.js"></script> 
  <script type="text/javascript" src="/js/fireworks.js"></script> -->
  <!--浏览器搞笑标题-->
  <script type="text/javascript" src="\js\FunnyTitle.js"></script>
  <!--动态线条背景-->
  <script type="text/javascript"
color="0,0,0" opacity='0.7' zIndex="-2" count="200" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js">
  </script>
  <!-- 样式一（鼠标点击更换样式） -->
<!-- <script src="https://g.joyinshare.com/hc/ribbon.min.js" type="text/javascript"></script> -->
<!-- 样式二（飘动的彩带） -->
<!-- <script src="https://g.joyinshare.com/hc/piao.js" type="text/javascript"></script> -->
  <!-- 数字雨 -->
  <!-- <canvas id="canvas" width="1440" height="900" ></canvas>
  <script type="text/javascript" src="/js/DigitalRain.js"></script> -->
</body>
</html>
